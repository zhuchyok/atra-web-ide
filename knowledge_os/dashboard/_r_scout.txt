def _render_scout():
        st.markdown("""
        <div style="background: linear-gradient(145deg, #1e1e2e, #11111b); border: 2px solid #f38ba8; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
            <h3 style="color: #f38ba8; margin-top: 0;">üåü Enhanced –†–∞–∑–≤–µ–¥–∫–∞ (–ú–∞–∫—Å–∏–º—É–º)</h3>
            <p style="color: #c9d1d9;">
                <strong>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:</strong><br>
                ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ <strong>–≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</strong><br>
                ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç <strong>–º–∏—Ä–æ–≤—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</strong> competitive intelligence<br>
                ‚úÖ –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ <strong>–ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏</strong> (SWOT, Porter's Five Forces, PEST)<br>
                ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å <strong>—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</strong><br>
                ‚úÖ –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤, —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –æ—Ç–∑—ã–≤–æ–≤, —Ç—Ä–µ–Ω–¥–æ–≤
            </p>
        </div>
        """, unsafe_allow_html=True)
    
        with st.form("enhanced_scout_form"):
            col1, col2 = st.columns(2)
            with col1:
                target_biz = st.text_input("–í–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è", value="–°—Ç–æ–ª–∏—á–Ω—ã–µ –æ–∫–Ω–∞")
            with col2:
                location = st.text_input("–õ–æ–∫–∞—Ü–∏—è", value="–ß–µ–±–æ–∫—Å–∞—Ä—ã –∏ –ù–æ–≤–æ—á–µ–±–æ–∫—Å–∞—Ä—Å–∫")
        
            extra_competitors = st.text_input(
                "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)", 
                value="",
                help="–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞"
            )
        
            use_enhanced = st.checkbox(
                "üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Enhanced —Ä–∞–∑–≤–µ–¥–∫—É (–º–∞–∫—Å–∏–º—É–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ + –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑)", 
                value=True,
                help="–í–∫–ª—é—á–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã"
            )
            project_scout = st.selectbox("–ü—Ä–æ–µ–∫—Ç", ["‚Äî –ù–µ —É–∫–∞–∑–∞–Ω / –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è ‚Äî"] + _get_project_slugs(), key="scout_project")
            run_scout = st.form_submit_button("üïµÔ∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ä–∞–∑–≤–µ–¥–∫—É", use_container_width=True)
        
            if run_scout:
                project_ctx_scout = None if project_scout == "‚Äî –ù–µ —É–∫–∞–∑–∞–Ω / –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è ‚Äî" else project_scout
                st.info(f"üïµÔ∏è –ì–ª–µ–± Enhanced –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ –≤ {location}...")
                # –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É –≤ –ë–î - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è Docker –æ–∫—Ä—É–∂–µ–Ω–∏—è
                # Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ scout_task_processor
                try:
                    conn = get_db_connection()
                    with conn.cursor() as cur:
                        task_desc = f"–ü—Ä–æ–≤–µ—Å—Ç–∏ {'Enhanced ' if use_enhanced else ''}—Ä–∞–∑–≤–µ–¥–∫—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –¥–ª—è '{target_biz}' –≤ {location}"
                        if extra_competitors and extra_competitors.strip():
                            task_desc += f". –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã: {extra_competitors.strip()}"
                    
                        task_title = f"üïµÔ∏è {'Enhanced ' if use_enhanced else ''}–†–∞–∑–≤–µ–¥–∫–∞: {target_biz}"
                        task_metadata = json.dumps({
                            "source": "dashboard_scout", 
                            "business": target_biz, 
                            "location": location,
                            "enhanced": use_enhanced,
                            "extra_competitors": extra_competitors.strip() if extra_competitors and extra_competitors.strip() else None
                        })
                    
                        cur.execute("""
                            INSERT INTO tasks (title, description, status, assignee_expert_id, creator_expert_id, metadata, project_context)
                            SELECT 
                                %s, %s, 'pending', 
                                (SELECT id FROM experts WHERE name = '–ì–ª–µ–±' LIMIT 1),
                                (SELECT id FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è' LIMIT 1),
                                %s, %s
                            WHERE EXISTS (SELECT 1 FROM experts WHERE name = '–ì–ª–µ–±')
                            RETURNING id
                        """, (task_title, task_desc, task_metadata, project_ctx_scout))
                        task_row = cur.fetchone()
                        conn.commit()
                    
                        if task_row:
                            mode = "Enhanced (–º–∞–∫—Å–∏–º—É–º)" if use_enhanced else "–±–∞–∑–æ–≤–∞—è"
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                            task_id = task_row[0] if isinstance(task_row, (tuple, list)) else (task_row.get('id') if isinstance(task_row, dict) else None)
                            st.success(f"‚úÖ {mode} —Ä–∞–∑–≤–µ–¥–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞! –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞. Worker –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –µ—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –û—Ç—á–µ—Ç –ø–æ—è–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 5-10 –º–∏–Ω—É—Ç.")
                            if use_enhanced:
                                st.info("""
                                üìä Enhanced —Ä–∞–∑–≤–µ–¥–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç:
                                - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã, —Ü–µ–Ω—ã, –æ—Ç–∑—ã–≤—ã, —É—Å–ª—É–≥–∏, —Ç—Ä–µ–Ω–¥—ã)
                                - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
                                - –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ (SWOT, Porter, PEST)
                                - –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
                                """)
                        else:
                            st.warning("‚ö†Ô∏è –ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —ç–∫—Å–ø–µ—Ä—Ç –ì–ª–µ–± —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–µ.")
                except Exception as e:
                    st.error(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏: {e}")
                    st.code(traceback.format_exc())

        st.markdown("---")
        st.subheader("üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç—á–µ—Ç—ã —Ä–∞–∑–≤–µ–¥–∫–∏")
        st.caption("üí° –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ –æ—Ç—á–µ—Ç—ã, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ä—è–¥–æ–º —Å –∫–∞–∂–¥—ã–º –æ—Ç—á–µ—Ç–æ–º")
    
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–±–∞–∑–æ–≤—ã–µ + enhanced)
        scout_stats = fetch_data("""
            SELECT 
                COUNT(*) FILTER (WHERE metadata->>'source' = 'scout_research') as basic_reports,
                COUNT(*) FILTER (WHERE metadata->>'source' IN ('enhanced_scout_research', 'enhanced_scout_report')) as enhanced_reports,
                COUNT(*) as total_reports,
                MAX(created_at) as last_report
            FROM knowledge_nodes 
            WHERE metadata->>'source' IN ('scout_research', 'enhanced_scout_research', 'enhanced_scout_report')
        """)
    
        if scout_stats and scout_stats[0]:
            stats = scout_stats[0]
            col1, col2, col3, col4 = st.columns(4)
            with col1:
                st.metric("–í—Å–µ–≥–æ –æ—Ç—á–µ—Ç–æ–≤", stats.get('total_reports', 0))
            with col2:
                st.metric("–ë–∞–∑–æ–≤—ã–µ", stats.get('basic_reports', 0))
            with col3:
                st.metric("Enhanced", stats.get('enhanced_reports', 0), 
                         delta=f"{stats.get('enhanced_reports', 0)} –¥–µ—Ç–∞–ª—å–Ω—ã—Ö")
            with col4:
                if stats.get('last_report'):
                    last_date = stats['last_report']
                    if isinstance(last_date, datetime):
                        last_date_str = last_date.strftime('%d.%m.%Y %H:%M')
                    else:
                        last_date_str = str(last_date)
                    st.metric("–ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á–µ—Ç", last_date_str)
    
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç—á–µ—Ç—ã (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç Enhanced) - –≤–∫–ª—é—á–∞–µ–º ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
        scout_reports = fetch_data("""
            SELECT id, LEFT(content, 500) as content, created_at, metadata 
            FROM knowledge_nodes 
            WHERE metadata->>'source' IN ('scout_research', 'enhanced_scout_research', 'enhanced_scout_report')
            ORDER BY 
                CASE 
                    WHEN metadata->>'source' = 'enhanced_scout_report' THEN 1
                    WHEN metadata->>'source' = 'enhanced_scout_research' THEN 2
                    ELSE 3
                END,
                created_at DESC 
            LIMIT 20
        """)
    
        if scout_reports:
            # –§–∏–ª—å—Ç—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –∏–∑ session_state
            scout_reports = [r for r in scout_reports if str(r.get('id', '')) not in st.session_state.deleted_reports]
        
            # –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ Enhanced –∏ –±–∞–∑–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã (metadata –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π JSON –∏–∑ –ë–î)
            enhanced_reports = [
                r for r in scout_reports
                if _normalize_metadata(r.get('metadata')).get('source') in ('enhanced_scout_report', 'enhanced_scout_research')
            ]
            basic_reports = [
                r for r in scout_reports
                if _normalize_metadata(r.get('metadata')).get('source') == 'scout_research'
            ]
        
            # –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞
            def delete_scout_report(report_id):
                """–£–¥–∞–ª—è–µ—Ç –æ—Ç—á–µ—Ç —Ä–∞–∑–≤–µ–¥–∫–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
                try:
                    if report_id is None:
                        return False
                
                    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º ID –≤ —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ —ç—Ç–æ UUID
                    report_id_str = str(report_id) if report_id else None
                    if not report_id_str:
                        return False
                
                    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç UUID
                    report_id_str = report_id_str.strip()
                
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª –ª–∏ –æ—Ç—á–µ—Ç —É–∂–µ —É–¥–∞–ª–µ–Ω –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏
                    if report_id_str in st.session_state.deleted_reports:
                        return False  # –£–∂–µ —É–¥–∞–ª–µ–Ω, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                
                    conn = get_db_connection()
                    with conn.cursor() as cur:
                        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                        # ID –º–æ–∂–µ—Ç –±—ã—Ç—å UUID (—Å—Ç—Ä–æ–∫–∞) –∏–ª–∏ int
                        # –ü—Ä–æ–±—É–µ–º —É–¥–∞–ª–∏—Ç—å –ø–æ UUID
                        cur.execute("DELETE FROM knowledge_nodes WHERE id::text = %s", (report_id_str,))
                        rows_deleted = cur.rowcount
                        conn.commit()
                
                    if rows_deleted > 0:
                        # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥–ª—è —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏
                        st.session_state.deleted_reports.add(report_id_str)
                        return True
                    else:
                        # –û—Ç—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω - –≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —É–¥–∞–ª–µ–Ω
                        st.session_state.deleted_reports.add(report_id_str)  # –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —É–¥–∞–ª–µ–Ω–Ω—ã–π
                        return False
                except Exception as e:
                    st.error(f"‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞: {e}")
                    st.code(traceback.format_exc())
                    return False
        
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º Enhanced –æ—Ç—á–µ—Ç—ã –æ—Ç–¥–µ–ª—å–Ω–æ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
            if enhanced_reports:
                st.markdown("### üöÄ Enhanced –û—Ç—á–µ—Ç—ã (–î–µ—Ç–∞–ª—å–Ω—ã–µ)")
                for rep in enhanced_reports[:5]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-5 Enhanced
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å—Ç—Ä–æ–∫—É (–º–æ–∂–µ—Ç –±—ã—Ç—å UUID –æ–±—ä–µ–∫—Ç)
                    rep_id_raw = rep.get('id')
                    rep_id = str(rep_id_raw) if rep_id_raw is not None else None
                    rep_date = rep.get('created_at', datetime.now())
                    if isinstance(rep_date, datetime):
                        date_str = rep_date.strftime('%d.%m.%Y %H:%M')
                    else:
                        date_str = str(rep_date)[:16]
                
                    metadata = _normalize_metadata(rep.get('metadata'))
                    business = metadata.get('business_target', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
                    location = metadata.get('location', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
                    competitors_count = metadata.get('competitors_count', 0)
                    sources_count = metadata.get('sources_count', 0)
                    model_used = metadata.get('model_used', 'N/A')
                    is_full_report = metadata.get('source') == 'enhanced_scout_report'
                
                    report_type = "üìä –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç" if is_full_report else "üîç –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö"
                
                    # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
                    delete_key = f"delete_enhanced_{rep_id}"
                
                    with st.expander(f"{report_type} | {date_str} | üè¢ {business} | üìç {location} | üë• {competitors_count} –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ | üìö {sources_count} –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"):
                        col1, col2 = st.columns([4, 1])
                        with col1:
                            st.markdown(f"""
                            **–ú–æ–¥–µ–ª—å –∞–Ω–∞–ª–∏–∑–∞:** {model_used}  
                            **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –Ω–∞–π–¥–µ–Ω–æ:** {competitors_count}  
                            **–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–æ–±—Ä–∞–Ω–æ:** {sources_count}
                            """)
                        with col2:
                            if st.button("üóëÔ∏è –£–¥–∞–ª–∏—Ç—å", key=delete_key, type="secondary", use_container_width=True):
                                if delete_scout_report(rep_id):
                                    st.success("‚úÖ –û—Ç—á–µ—Ç —É–¥–∞–ª–µ–Ω")
                                    # –û—á–∏—â–∞–µ–º –∫—ç—à –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
                                    st.cache_data.clear()
                                    st.rerun()
                                else:
                                    # –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –æ—Ç—á–µ—Ç —É–∂–µ –±—ã–ª —É–¥–∞–ª–µ–Ω
                                    st.cache_data.clear()
                                    st.rerun()
                    
                        rep_content = rep.get('content', '–ù–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ')
                        st.markdown(rep_content)
        
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã
            if basic_reports:
                st.markdown("### üìã –ë–∞–∑–æ–≤—ã–µ –û—Ç—á–µ—Ç—ã")
                # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ
                reports_by_date = {}
                for rep in basic_reports:
                    rep_date = rep.get('created_at', datetime.now())
                    if isinstance(rep_date, datetime):
                        date_key = rep_date.strftime('%d.%m.%Y')
                    else:
                        date_key = str(rep_date)[:10]
                
                    if date_key not in reports_by_date:
                        reports_by_date[date_key] = []
                    reports_by_date[date_key].append(rep)
            
                for date_key in sorted(reports_by_date.keys(), reverse=True)[:3]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
                    with st.expander(f"üìÖ {date_key} ({len(reports_by_date[date_key])} –æ—Ç—á–µ—Ç–æ–≤)"):
                        for rep in reports_by_date[date_key][:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –Ω–∞ –¥–∞—Ç—É
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å—Ç—Ä–æ–∫—É (–º–æ–∂–µ—Ç –±—ã—Ç—å UUID –æ–±—ä–µ–∫—Ç)
                            rep_id_raw = rep.get('id')
                            rep_id = str(rep_id_raw) if rep_id_raw is not None else None
                            rep_date = rep.get('created_at', datetime.now())
                            if isinstance(rep_date, datetime):
                                rep_time = rep_date.strftime('%H:%M')
                            else:
                                rep_time = str(rep_date)[11:16]
                        
                            metadata = _normalize_metadata(rep.get('metadata'))
                            business = metadata.get('business_target', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
                            location = metadata.get('location', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
                            # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
                            delete_key = f"delete_basic_{rep_id}"
                        
                            col1, col2 = st.columns([4, 1])
                            with col1:
                                st.markdown(f"**üïê {rep_time} | üè¢ {business} | üìç {location}**")
                            with col2:
                                if st.button("üóëÔ∏è –£–¥–∞–ª–∏—Ç—å", key=delete_key, type="secondary", use_container_width=True):
                                    if delete_scout_report(rep_id):
                                        st.success("‚úÖ –û—Ç—á–µ—Ç —É–¥–∞–ª–µ–Ω")
                                        # –û—á–∏—â–∞–µ–º –∫—ç—à –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
                                        st.cache_data.clear()
                                        st.rerun()
                                    else:
                                        # –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –æ—Ç—á–µ—Ç —É–∂–µ –±—ã–ª —É–¥–∞–ª–µ–Ω
                                        st.cache_data.clear()
                                        st.rerun()
                        
                            rep_content = rep.get('content', '–ù–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ')
                            if len(rep_content) > 500:
                                st.markdown(rep_content[:500] + "...")
                                with st.expander("–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é"):
                                    st.markdown(rep_content)
                            else:
                                st.markdown(rep_content)
                            st.markdown("---")
        else:
            st.info("üì≠ –ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç—á–µ—Ç–æ–≤ —Ä–∞–∑–≤–µ–¥–∫–∏. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ–¥–∫—É –≤—ã—à–µ.")

        # üíé –õ–ò–ö–í–ò–î–ù–û–°–¢–¨ (ROI) - —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è

