def _render_simulator():
        with st.form("simulation_form"):
            idea = st.text_area("–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –∏–¥–µ—é –∏–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:", placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ SaaS –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —é—Ä–∏—Å—Ç–æ–≤ –Ω–∞ –±–∞–∑–µ –Ω–∞—à–µ–π Knowledge OS")
            project_sim = st.selectbox("–ü—Ä–æ–µ–∫—Ç", ["‚Äî –ù–µ —É–∫–∞–∑–∞–Ω / –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è ‚Äî"] + _get_project_slugs(), key="sim_project")
            submit = st.form_submit_button("–ó–∞–ø—É—Å—Ç–∏—Ç—å –°–∏–º—É–ª—è—Ü–∏—é –°–æ–≤–µ—Ç–∞ –î–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤")
            if submit and idea:
                project_ctx_sim = None if project_sim == "‚Äî –ù–µ —É–∫–∞–∑–∞–Ω / –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è ‚Äî" else project_sim
                # –í—Å—Ç–∞–≤–ª—è–µ–º –∏–¥–µ—é –∏ –ø–æ–ª—É—á–∞–µ–º ID
                sim_id = None
                with get_db_connection() as conn:
                    with conn.cursor() as cur:
                        cur.execute("INSERT INTO simulations (idea) VALUES (%s) RETURNING id", (idea,))
                        row = cur.fetchone()
                        if row:
                            sim_id = row['id']
                        conn.commit()
            
                if sim_id is None:
                    st.error("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å —Å–∏–º—É–ª—è—Ü–∏–∏ –≤ –ë–î.")
                else:
                    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç —Å–∏–º—É–ª—è—Ü–∏–∏ –≤ —Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ docker exec (–ø—É—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ knowledge_os_worker)
                    try:
                        result = subprocess.run(
                            ["docker", "exec", "-d", "knowledge_os_worker",
                             "python3", "/app/knowledge_os/app/simulator.py", str(sim_id)],
                            capture_output=True,
                            text=True,
                            timeout=5
                        )
                        if result.returncode == 0:
                            st.success(f"‚úÖ –°–∏–º—É–ª—è—Ü–∏—è #{sim_id} –∑–∞–ø—É—â–µ–Ω–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –Ω–∏–∂–µ —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã.")
                        else:
                            st.warning(f"‚ö†Ô∏è –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏: {result.stderr or '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}")
                            try:
                                conn = get_db_connection()
                                with conn.cursor() as cur:
                                    cur.execute("""
                                        INSERT INTO tasks (title, description, status, assignee_expert_id, creator_expert_id, metadata, project_context)
                                        SELECT %s, %s, 'pending',
                                            (SELECT id FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è' LIMIT 1),
                                            (SELECT id FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è' LIMIT 1),
                                            %s, %s
                                        WHERE EXISTS (SELECT 1 FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è')
                                    """, (f"üöÄ –°–∏–º—É–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏ #{sim_id}", f"–ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–∏–º—É–ª—è—Ü–∏—é –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏: {idea}", json.dumps({"source": "dashboard_simulator", "simulation_id": sim_id, "idea": idea}), project_ctx_sim))
                                    conn.commit()
                                st.info("üìã –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ. –í–∏–∫—Ç–æ—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –µ—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.")
                            except Exception as e:
                                st.error(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏: {e}")
                    except FileNotFoundError:
                        try:
                            conn = get_db_connection()
                            with conn.cursor() as cur:
                                cur.execute("""
                                    INSERT INTO tasks (title, description, status, assignee_expert_id, creator_expert_id, metadata, project_context)
                                    SELECT %s, %s, 'pending',
                                        (SELECT id FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è' LIMIT 1),
                                        (SELECT id FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è' LIMIT 1),
                                        %s, %s
                                    WHERE EXISTS (SELECT 1 FROM experts WHERE name = '–í–∏–∫—Ç–æ—Ä–∏—è')
                                """, (f"üöÄ –°–∏–º—É–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏ #{sim_id}", f"–ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–∏–º—É–ª—è—Ü–∏—é –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏: {idea}", json.dumps({"source": "dashboard_simulator", "simulation_id": sim_id, "idea": idea}), project_ctx_sim))
                                conn.commit()
                            st.success("‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ. –í–∏–∫—Ç–æ—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –µ—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ worker.")
                        except Exception as e:
                            st.error(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏: {e}")
                    except Exception as e:
                        st.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏: {e}")

        st.markdown("---")
        st.subheader("–ò—Å—Ç–æ—Ä–∏—è –°–∏–º—É–ª—è—Ü–∏–π")
        st.caption("üí° –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–∏–º—É–ª—è—Ü–∏–∏, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É üóëÔ∏è –£–¥–∞–ª–∏—Ç—å")
    
        # –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Å–∏–º—É–ª—è—Ü–∏–∏
        def delete_simulation(sim_id: int):
            """–£–¥–∞–ª—è–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
            try:
                conn = get_db_connection()
                with conn.cursor() as cur:
                    cur.execute("DELETE FROM simulations WHERE id = %s", (sim_id,))
                    conn.commit()
                return True
            except Exception as e:
                st.error(f"‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–∏–º—É–ª—è—Ü–∏–∏: {e}")
                return False
    
        history = fetch_data("SELECT id, idea, result, created_at FROM simulations ORDER BY created_at DESC LIMIT 10")
        if history:
            for sim in history:
                sim_id = sim.get('id', 'N/A')
                sim_date = sim.get('created_at', datetime.now())
                if isinstance(sim_date, datetime):
                    sim_date_str = sim_date.strftime('%d.%m %H:%M')
                else:
                    sim_date_str = str(sim_date)
                sim_idea = sim.get('idea', '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è')
                sim_result = sim.get('result')
                # –ï—Å–ª–∏ –≤ —Å–∏–º—É–ª—è—Ü–∏–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É (task –º–æ–≥ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è, –∞ simulations.result –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è)
                if not sim_result and sim_id != 'N/A':
                    task_for_sim = fetch_data(
                        "SELECT result FROM tasks WHERE status = 'completed' AND metadata->>'simulation_id' = %s ORDER BY updated_at DESC LIMIT 1",
                        (str(sim_id),)
                    )
                    if task_for_sim and task_for_sim[0].get('result'):
                        sim_result = task_for_sim[0]['result']
                        # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤ simulations, —á—Ç–æ–±—ã –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã–ª —É–∂–µ –≤ –ë–î
                        try:
                            conn = get_db_connection()
                            with conn.cursor() as cur:
                                cur.execute("UPDATE simulations SET result = %s WHERE id = %s AND (result IS NULL OR result = '')", (sim_result, sim_id))
                                conn.commit()
                        except Exception:
                            pass
                if not sim_result:
                    sim_result = None
            
                # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
                delete_key = f"delete_sim_{sim_id}"
            
                with st.expander(f"üìå #{sim_id} | {sim_date_str} | {sim_idea[:50]}..."):
                    col1, col2 = st.columns([4, 1])
                    with col1:
                        st.markdown(f"**–ò–¥–µ—è:** {sim_idea}")
                        if sim_result:
                            st.markdown(f"**–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n{sim_result}")
                        else:
                            st.info("‚åõ –°–∏–º—É–ª—è—Ü–∏—è –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É ¬´–ó–∞–¥–∞—á–∏¬ª ‚Äî –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏.")
                    with col2:
                        if st.button("üóëÔ∏è –£–¥–∞–ª–∏—Ç—å", key=delete_key, type="secondary", use_container_width=True):
                            if delete_simulation(sim_id):
                                st.success("‚úÖ –°–∏–º—É–ª—è—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞")
                                st.rerun()
                            else:
                                st.error("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é")
        else:
            st.info("–ü–æ–∫–∞ –Ω–µ—Ç —Å–∏–º—É–ª—è—Ü–∏–π")

        # üìà –§–ò–ù–ê–ù–°–´ –ò–ò (—É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        with tabs[1]:
        st.subheader("üìà –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –£—á–µ—Ç –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (Knowledge P&L)")
    
        # –ú–µ—Ç—Ä–∏–∫–∏ –≤–≤–µ—Ä—Ö—É (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
        finance_metrics = fetch_data("""
            SELECT 
                COUNT(*) as total_experts,
                COUNT(*) FILTER (WHERE virtual_budget IS NOT NULL) as experts_with_budget,
                SUM(virtual_budget) as total_budget,
                AVG(performance_score) as avg_performance
            FROM experts
        """)
    
        if finance_metrics and finance_metrics[0]:
            fm = finance_metrics[0]
            metrics_col1, metrics_col2, metrics_col3, metrics_col4 = st.columns(4)
            with metrics_col1:
                st.metric("üë• –í—Å–µ–≥–æ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤", f"{fm['total_experts']}")
            with metrics_col2:
                st.metric("üí∞ –° –±—é–¥–∂–µ—Ç–æ–º", f"{fm['experts_with_budget']}")
            with metrics_col3:
                st.metric("üíµ –û–±—â–∏–π –±—é–¥–∂–µ—Ç", f"${fm['total_budget']:.2f}" if fm['total_budget'] else "$0.00")
            with metrics_col4:
                st.metric("‚≠ê –°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å", f"{fm['avg_performance']:.2f}" if fm['avg_performance'] else "N/A")
    
        st.markdown("---")
    
        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        exp_finance = fetch_data("SELECT name, department, virtual_budget, performance_score FROM experts WHERE virtual_budget IS NOT NULL ORDER BY virtual_budget DESC")
        if exp_finance:
            col1, col2 = st.columns([1, 2])
            with col1:
                st.markdown("### üí∞ –ë—é–¥–∂–µ—Ç—ã –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤")
                dept_budgets = pd.DataFrame(exp_finance).groupby('department')['virtual_budget'].sum().reset_index()
                dept_budgets = dept_budgets.sort_values('virtual_budget', ascending=False)
                fig_dept = px.bar(
                    dept_budgets, x='department', y='virtual_budget', 
                    color='virtual_budget',
                    template="plotly_dark",
                    labels={'department': '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', 'virtual_budget': '–ë—é–¥–∂–µ—Ç ($)'},
                    color_continuous_scale='Viridis'
                )
                fig_dept.update_layout(xaxis_tickangle=-45, height=400)
                st.plotly_chart(fig_dept, use_container_width=True)
        
            with col2:
                st.markdown("### üèÜ –¢–æ–ø –ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö –≠–∫—Å–ø–µ—Ä—Ç–æ–≤")
                df_finance = pd.DataFrame(exp_finance)
                df_finance['ROI'] = (df_finance['virtual_budget'] * df_finance['performance_score']).round(2)
                df_finance = df_finance.sort_values('ROI', ascending=False).head(20)
            
                # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
                st.dataframe(
                    df_finance[['name', 'department', 'virtual_budget', 'performance_score', 'ROI']].rename(columns={
                        'name': '–≠–∫—Å–ø–µ—Ä—Ç',
                        'department': '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç',
                        'virtual_budget': '–ë—é–¥–∂–µ—Ç',
                        'performance_score': '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
                        'ROI': 'ROI'
                    }),
                    hide_index=True,
                    use_container_width=True
                )
            
                # –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                fig_perf = px.scatter(
                    df_finance.head(15), x='virtual_budget', y='performance_score',
                    size='ROI', hover_data=['name', 'department'],
                    title="üìä –ë—é–¥–∂–µ—Ç vs –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
                    template="plotly_dark",
                    labels={'virtual_budget': '–ë—é–¥–∂–µ—Ç ($)', 'performance_score': '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å'}
                )
                st.plotly_chart(fig_perf, use_container_width=True)

        # üì° –†–ê–î–ê–† (Hypothesis 4)
        with tabs[2]:
        st.subheader("üì° –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –†–∞–¥–∞—Ä –ê–Ω–æ–º–∞–ª–∏–π")
        anomalies = fetch_data("SELECT description, severity, status, created_at FROM anomalies ORDER BY created_at DESC LIMIT 20")
        if anomalies:
            for anom in anomalies:
                color = "#f38ba8" if anom.get('severity') == 'high' else "#fab387"
                created_at = anom.get('created_at')
                anom_created_str = created_at.strftime('%d.%m %H:%M') if hasattr(created_at, 'strftime') else (str(created_at)[:16] if created_at else 'N/A')
                st.markdown(f"""
                    <div style="background: #161b22; border-left: 5px solid {color}; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <span style="float: right; color: #8b949e; font-size: 12px;">{anom_created_str}</span>
                        <div style="color: {color}; font-weight: 800; font-size: 14px; text-transform: uppercase;">–ö–†–ò–¢–ò–ß–ù–û–°–¢–¨: {anom.get('severity', 'N/A')}</div>
                        <div style="color: #c9d1d9; margin-top: 5px;">{anom.get('description') or ''}</div>
                    </div>
                """, unsafe_allow_html=True)
        else:
            st.success("‚úÖ –ê–Ω–æ–º–∞–ª–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –†–∞–¥–∞—Ä —á–∏—Å—Ç.")

        # üïµÔ∏è –†–ï–ö–†–£–¢–ò–ù–ì (Singularity 3.0)
        with tabs[3]:
        st.subheader("üïµÔ∏è –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –†–µ–∫—Ä—É—Ç–∏–Ω–≥ –≠–∫—Å–ø–µ—Ä—Ç–æ–≤")
        col1, col2 = st.columns([1, 4])
        with col1:
            if st.button("üîÑ –û–±–Ω–æ–≤–∏—Ç—å", key="refresh_autonomous_recruiting"):
                st.cache_data.clear()
                st.rerun()
        hired_experts = fetch_data("""
            SELECT name, role, department, metadata->>'hired_at' as hired_at 
            FROM experts 
            WHERE metadata->>'is_autonomous' = 'true'
            ORDER BY created_at DESC
        """)
        if hired_experts:
            for exp in hired_experts:
                st.markdown(f"""
                    <div class="premium-card">
                        <span class="domain-badge">{exp['department']}</span>
                        <div class="expert-header">üë§ {exp['name']}</div>
                        <div class="expert-role">{exp['role']}</div>
                        <div style="font-size: 11px; color: #8b949e;">–ù–∞–Ω—è—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ: {exp['hired_at']}</div>
                    </div>
                """, unsafe_allow_html=True)
        else:
            st.info("–ü–æ–∫–∞ –Ω–µ –±—ã–ª–æ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö –Ω–∞–π–º–æ–≤.")

        # üõ°Ô∏è –ò–ú–ú–£–ù–ò–¢–ï–¢ (Singularity 3.0)
        with tabs[4]:
        st.subheader("üõ°Ô∏è –ò–º–º—É–Ω–∏—Ç–µ—Ç: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –°—Ç—Ä–µ—Å—Å-–¢–µ—Å—Ç–æ–≤")
        attacks = fetch_data("""
            SELECT LEFT(content, 300) as content, expert_consensus->>'adversarial_attack' as attack, 
                   metadata->>'survived' as survived, confidence_score
            FROM knowledge_nodes 
            WHERE metadata->>'adversarial_tested' = 'true'
            ORDER BY created_at DESC LIMIT 15
        """)
        for at in attacks:
            survived = at.get('survived') == 'true'
            status = "‚úÖ –í–´–î–ï–†–ñ–ê–õ–û" if survived else "üíÄ –£–ù–ò–ß–¢–û–ñ–ï–ù–û"
            color = "#a6e3a1" if survived else "#f38ba8"
            content_preview = (at.get('content') or '')[:150]
            st.markdown(f"""
                <div style="background: #0d1117; border-left: 5px solid {color}; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                    <div style="color: {color}; font-weight: 800;">{status} (Score: {at.get('confidence_score', 'N/A')})</div>
                    <div style="color: #c9d1d9; font-size: 14px; margin-top: 5px;"><b>–ó–Ω–∞–Ω–∏–µ:</b> {content_preview}{'...' if len(at.get('content') or '') > 150 else ''}</div>
                    <div style="color: #8b949e; font-size: 13px; margin-top: 5px; font-style: italic;"><b>–ê—Ç–∞–∫–∞:</b> {at.get('attack') or 'N/A'}</div>
                </div>
            """, unsafe_allow_html=True)

        # üé≠ –ê–£–î–ò–¢ –ö–û–î–ê (Singularity 3.0)
        with tabs[5]:
        st.subheader("üé≠ –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–µ –ó–µ—Ä–∫–∞–ª–æ: –ê—É–¥–∏—Ç –°–∏—Å—Ç–µ–º—ã")
        show_completed = st.checkbox("–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ", value=False, key="audit_show_completed")
        status_filter = "" if show_completed else "AND status NOT IN ('completed', 'cancelled')"
        audit_tasks = fetch_data(f"""
            SELECT title, description, metadata->>'severity' as severity, status
            FROM tasks 
            WHERE metadata->>'source' = 'code_auditor' {status_filter}
            ORDER BY created_at DESC LIMIT 10
        """)
        for task in audit_tasks:
            color = "#f38ba8" if task['severity'] == 'high' else "#fab387" if task['severity'] == 'medium' else "#94e2d5"
            st.markdown(f"""
                <div style="background: #11111b; border: 1px solid {color}; padding: 15px; border-radius: 10px; margin-bottom: 10px;">
                    <span style="color: {color}; font-weight: 800; float: right;">{task['severity'].upper()}</span>
                    <div style="font-weight: 700; color: #cdd6f4;">{task['title']}</div>
                    <div style="font-size: 14px; color: #c9d1d9; margin-top: 8px;">{task['description']}</div>
                    <div style="font-size: 12px; color: #8b949e; margin-top: 5px;">–°—Ç–∞—Ç—É—Å: {task['status']}</div>
                </div>
            """, unsafe_allow_html=True)

        # üì¢ –ú–ê–†–ö–ï–¢–ò–ù–ì (–ù–æ–≤—ã–π –æ—Ç–¥–µ–ª)

