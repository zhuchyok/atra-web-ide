# üîÑ –û–¢–ß–ï–¢: –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –°–ò–°–¢–ï–ú–´ –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô

## üìã –û–ë–ó–û–†

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –∑–∞–º–µ–Ω—ã –æ–±—â–∏—Ö `except Exception` –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö ATRA.

**–î–∞—Ç–∞:** 2025-01-XX  
**–°—Ç–∞—Ç—É—Å:** üü¢ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### 1. –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (`src/core/exceptions.py`)

**–ò–µ—Ä–∞—Ä—Ö–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π:**
```
ATRAException (–±–∞–∑–æ–≤–æ–µ)
‚îú‚îÄ‚îÄ ValidationError
‚îú‚îÄ‚îÄ DatabaseError
‚îÇ   ‚îú‚îÄ‚îÄ DatabaseConnectionError
‚îÇ   ‚îú‚îÄ‚îÄ DatabaseQueryError
‚îÇ   ‚îî‚îÄ‚îÄ DatabaseTransactionError
‚îú‚îÄ‚îÄ APIError
‚îÇ   ‚îú‚îÄ‚îÄ ExchangeAPIError
‚îÇ   ‚îú‚îÄ‚îÄ TelegramAPIError
‚îÇ   ‚îú‚îÄ‚îÄ NetworkError
‚îÇ   ‚îú‚îÄ‚îÄ RateLimitError
‚îÇ   ‚îî‚îÄ‚îÄ AuthenticationError
‚îú‚îÄ‚îÄ FinancialError
‚îÇ   ‚îú‚îÄ‚îÄ InsufficientFundsError
‚îÇ   ‚îú‚îÄ‚îÄ InvalidPriceError
‚îÇ   ‚îî‚îÄ‚îÄ InvalidQuantityError
‚îú‚îÄ‚îÄ RiskManagementError
‚îú‚îÄ‚îÄ PositionError
‚îú‚îÄ‚îÄ OrderError
‚îÇ   ‚îú‚îÄ‚îÄ OrderNotFoundError
‚îÇ   ‚îú‚îÄ‚îÄ OrderExecutionError
‚îÇ   ‚îî‚îÄ‚îÄ OrderCancellationError
‚îú‚îÄ‚îÄ SignalError
‚îî‚îÄ‚îÄ ConfigurationError
    ‚îú‚îÄ‚îÄ MissingConfigError
    ‚îî‚îÄ‚îÄ InvalidConfigError
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –í—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç (`context` dict)
- –ù–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `ATRAException`
- –ò–º–µ—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/execution/exchange_adapter.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –æ–±—â–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ `_call_client()`:
  - `NetworkError` –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
  - `RateLimitError` –¥–ª—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤
  - `AuthenticationError` –¥–ª—è –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - `ExchangeAPIError` –¥–ª—è –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫ –±–∏—Ä–∂–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `create_limit_order()` –∏ `create_market_order()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `OrderExecutionError` –¥–ª—è –æ—à–∏–±–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤

**–ü–æ–¥—Ö–æ–¥:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—é –æ—à–∏–±–∫–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ ccxt)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (method, latency_ms, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ä–¥–µ—Ä–∞)

---

## üîÑ –í –ü–†–û–¶–ï–°–°–ï

### –ó–∞–º–µ–Ω–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö:

1. **src/database/db.py** - –∑–∞–º–µ–Ω–∞ `except Exception` –Ω–∞:
   - `DatabaseConnectionError`
   - `DatabaseQueryError`
   - `DatabaseTransactionError`

2. **src/execution/auto_execution.py** - –∑–∞–º–µ–Ω–∞ –Ω–∞:
   - `OrderExecutionError`
   - `ExchangeAPIError`
   - `NetworkError`
   - `PositionError`

3. **src/signals/** - –∑–∞–º–µ–Ω–∞ –Ω–∞:
   - `SignalError`
   - `ValidationError`
   - `FinancialError`

---

## üìä –ú–ï–¢–†–ò–ö–ò

**–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
- 2073 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è `except Exception` –∏–ª–∏ `except:`
- –ù–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –°–ª–æ–∂–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫

**–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∏–∑ 25+ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `exchange_adapter.py` –∑–∞–≤–µ—Ä—à–µ–Ω
- üü° –û—Å—Ç–∞–ª–æ—Å—å ~2060 –º–µ—Å—Ç –¥–ª—è –∑–∞–º–µ–Ω—ã (–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏)

---

## üéØ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏ (–¢–ï–ö–£–©–ê–Ø)
- [x] –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- [x] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `exchange_adapter.py`
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `auto_execution.py`
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `db.py` (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã)
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `position_manager.py`

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ –º–æ–¥—É–ª–∏
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `signals/core.py`
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `signals/risk.py`
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `execution/order_manager.py`

### –§–∞–∑–∞ 3: –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üí° –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

1. **–õ—É—á—à–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —É–ø—Ä–æ—â–∞—é—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
2. **–¶–µ–ª–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –ú–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ –ø–æ-—Ä–∞–∑–Ω–æ–º—É
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ö–∞–∂–¥–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** –ü–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º –Ω–∞—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö

---

## üìù –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
```python
try:
    order = await adapter.create_limit_order(symbol, side, amount, price)
except Exception as e:
    logger.error(f"–û—à–∏–±–∫–∞: {e}")  # –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –æ—à–∏–±–∫–∞
    return None
```

### –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
```python
try:
    order = await adapter.create_limit_order(symbol, side, amount, price)
except NetworkError as e:
    logger.error(f"–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é: {e}")
    # –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ
    return None
except RateLimitError as e:
    logger.warning(f"–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç: {e}")
    # –ü–æ–¥–æ–∂–¥–∞—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å
    await asyncio.sleep(60)
    return None
except AuthenticationError as e:
    logger.critical(f"–ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–ª—é—á–∞–º–∏: {e}")
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é
    raise
except OrderExecutionError as e:
    logger.error(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–∞: {e}")
    return None
```

---

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø–æ —Ç–∏–ø–∞–º –∏—Å–∫–ª—é—á–µ–Ω–∏–π
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
3. –°–æ–∑–¥–∞—Ç—å dashboard –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

---

**–ê–≤—Ç–æ—Ä:** –ö–æ–º–∞–Ω–¥–∞ ATRA  
**–í–µ—Ä—Å–∏—è:** 1.0

