# ‚úÖ Self-Evolving System (L4) - –∑–∞–≤–µ—Ä—à–µ–Ω–æ

**–î–∞—Ç–∞:** 2025-11-13  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û**

---

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. EvolutionEngine - –¥–≤–∏–∂–æ–∫ —ç–≤–æ–ª—é—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤

**–§–∞–π–ª:** `observability/evolution_engine.py`

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- ‚úÖ `analyze_agent_performance()` - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞
- ‚úÖ `generate_prompt_improvements()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π
- ‚úÖ `create_prompt_variant()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–æ–º–ø—Ç–æ–≤
- ‚úÖ `evaluate_variant()` - –æ—Ü–µ–Ω–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- ‚úÖ `apply_evolution()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç–≤–æ–ª—é—Ü–∏–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ lessons learned
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π –ø—Ä–æ–º–ø—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
- –û—Ü–µ–Ω–∫–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### 2. –°–∫—Ä–∏–ø—Ç —ç–≤–æ–ª—é—Ü–∏–∏

**–§–∞–π–ª:** `scripts/evolve_prompts.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –≠–≤–æ–ª—é—Ü–∏—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
python3 scripts/evolve_prompts.py

# –≠–≤–æ–ª—é—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
python3 scripts/evolve_prompts.py --agent signal_live

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç–≤–æ–ª—é—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
python3 scripts/evolve_prompts.py --apply

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç
python3 scripts/evolve_prompts.py --min-gain 0.10
```

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Ü–µ—Å—Å —ç–≤–æ–ª—é—Ü–∏–∏:

1. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
   ```python
   performance = engine.analyze_agent_performance("signal_live")
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: {
   #   "has_lessons": True,
   #   "total_issues": 15,
   #   "critical_issues": 3,
   #   "performance_score": 0.85,
   #   "lessons": [...]
   # }
   ```

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π:**
   ```python
   improvements = engine.generate_prompt_improvements(
       agent="signal_live",
       current_prompt=current_prompt,
       lessons=lessons,
   )
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: [
   #   "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è: rsi_overbought_long",
   #   "–£—Å–∏–ª–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è: low_volume",
   #   ...
   # ]
   ```

3. **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞:**
   ```python
   variant = engine.create_prompt_variant(
       agent="signal_live",
       improvements=improvements,
       lessons=lessons,
   )
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: PromptVariant —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π –ø—Ä–æ–º–ø—Ç–∞
   ```

4. **–û—Ü–µ–Ω–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:**
   ```python
   variant_performance = engine.evaluate_variant(variant, performance)
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: 0.92 (—É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 7%)
   ```

5. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç–≤–æ–ª—é—Ü–∏–∏:**
   ```python
   if engine.should_apply_variant(current_performance, variant_performance):
       engine.apply_evolution(result)
   ```

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Guidance System

EvolutionEngine –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Guidance System:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `get_guidance()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è lessons learned
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏

- **–ú–∏–Ω–∏–º—É–º —É—Ä–æ–∫–æ–≤ –¥–ª—è —ç–≤–æ–ª—é—Ü–∏–∏:** 3
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** 5% (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** 0.0 - 1.0
  - –ë–∞–∑–æ–≤—ã–π score –∏–∑ –º–µ—Ç—Ä–∏–∫
  - –ë–æ–Ω—É—Å –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ª—É—á—à–µ–Ω–∏–π
  - –£—á–µ—Ç success rate –∏–∑ —Ç–µ—Å—Ç–æ–≤

---

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–û–±—É—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —É—á–∏—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ lessons learned
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
4. **–ì–∏–±–∫–æ—Å—Ç—å:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. **LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LLM –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–ª—É—á—à–µ–Ω–∏–π
3. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ cron/scheduler

---

**–°–º. —Ç–∞–∫–∂–µ:**
- [AGENT_DEVELOPMENT_ROADMAP.md](./AGENT_DEVELOPMENT_ROADMAP.md) - –ø–æ–ª–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è
- [AGENT_OPS_COMPLETE.md](./AGENT_OPS_COMPLETE.md) - Agent Ops

