# –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π - –†–µ–∑—é–º–µ

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. **AdvancedNotificationLimiter** (`state.py`)
- ‚úÖ **Per-user backoff**: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–ë–∞—Ç—á–∏**: —Ä–∞–∑–±–∏–≤–∫–∞ –º–∞—Å—Å–æ–≤—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **Jitter**: —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ ¬±0.2 —Å–µ–∫ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –¥–µ—Ç–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è retry –ª–æ–≥–∏–∫–∞** (`telegram_bot.py`)
- ‚úÖ **–ï–¥–∏–Ω—ã–π —Ü–∏–∫–ª retry**: –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ü–∏–∫–ª –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö RetryAfter**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ 429 –æ—à–∏–±–∫–∏
- ‚úÖ **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff**: —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É —Å –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–æ–π

### 3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏**
- ‚úÖ **–ë–∞—Ç—á–∏ —Å jitter**: —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
- ‚úÖ **–í–Ω—É—Ç—Ä–∏–±–∞—Ç—á–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏**: 100ms –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ –±–∞—Ç—á–µ
- ‚úÖ **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

### 4. **–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
- ‚úÖ `/notification_status` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ `/reset_notification_stats` - —Å–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ `/clear_all_backoffs` - –æ—á–∏—Å—Ç–∫–∞ backoff'–æ–≤
- ‚úÖ `/set_batch_size` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞
- ‚úÖ `/set_batch_delay` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
‚úÖ –õ–∏–º–∏—Ç 1 —Å–æ–æ–±—â–µ–Ω–∏–µ/—Å–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –û–∂–∏–¥–∞–Ω–∏–µ 1 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
```

### –¢–µ—Å—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
```
‚úÖ –õ–∏–º–∏—Ç 30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏
```

### –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –±–∞—Ç—á–µ–π
```
‚úÖ –†–∞–∑–±–∏–≤–∫–∞ 25 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ 3 –±–∞—Ç—á–∞ (10, 10, 5)
‚úÖ Jitter –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (0.53—Å, 0.59—Å)
```

### –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã backoff
```
‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ backoff –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
```

### –¢–µ—Å—Ç –º–∞—Å—Å–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
```
‚úÖ 15 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞ 2.81 —Å–µ–∫—É–Ω–¥—ã
‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 0.187 —Å–µ–∫—É–Ω–¥
‚úÖ 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏
```

## ‚ö° –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Telegram API**:
   - ‚â§1 —Å–æ–æ–±—â–µ–Ω–∏–µ/—Å–µ–∫ –≤ –æ–¥–Ω–æ–º —á–∞—Ç–µ
   - ‚â§30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ –≥–ª–æ–±–∞–ª—å–Ω–æ

2. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏**:
   - –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –±–∞—Ç—á–∏ –ø–æ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ (jitter) ¬±0.2 —Å–µ–∫
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏

3. **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º**:
   - Per-user backoff –ø—Ä–∏ RetryAfter
   - –ï–¥–∏–Ω—ã–π —Ü–∏–∫–ª retry –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
   - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ú–∞—Å—Å–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞**: 15 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ 2.81 —Å–µ–∫—É–Ω–¥—ã
- **–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å**: ~5.3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Å–µ–∫—É–Ω–¥–∞
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–∏–º–∏—Ç–æ–≤ Telegram API
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤ —Ç–µ—Å—Ç–∞—Ö

## üéØ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–ª—é–¥–∞–µ—Ç –≤—Å–µ –ª–∏–º–∏—Ç—ã Telegram API, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—è –Ω–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –≤ `telegram_bot.py`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É
