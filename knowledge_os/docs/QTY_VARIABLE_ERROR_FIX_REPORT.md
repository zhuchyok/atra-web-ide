# –û—Ç—á–µ—Ç –æ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—à–∏–±–∫–æ–π qty variable

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞**: `local variable 'qty' referenced before assignment`

**–ú–µ—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è**: Telegram –±–æ—Ç –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥

**–°–∏–º–ø—Ç–æ–º—ã**:
- –û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö: `[TelegramBot] Exception while handling an update: local variable 'qty' referenced before assignment`
- –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### üìä **–ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏:**

#### 1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π qty**
```python
# –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î (–±—ã–ª–æ):
if qty and qty > 0:
    pos_str += f"   üìä –û–±—ä—ë–º: <code>{qty}</code>"
else:
    pos_str += f"   üìä –û–±—ä—ë–º: <code>–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</code>"
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ `qty` —Ä–∞–≤–Ω–æ `None` –∏–ª–∏ `0`, —Ç–æ —É—Å–ª–æ–≤–∏–µ `if qty and qty > 0:` –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É `UnboundLocalError`, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `qty` –Ω–µ –±—ã–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏.

#### 2. **–õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≤–µ—Ä–∫–µ**
- `qty` –º–æ–∂–µ—Ç –±—ã—Ç—å `None` (–µ—Å–ª–∏ `pos.get('qty')` –Ω–µ –Ω–∞–π–¥–µ–Ω)
- `qty` –º–æ–∂–µ—Ç –±—ã—Ç—å `0` (–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- –£—Å–ª–æ–≤–∏–µ `if qty and qty > 0:` –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ `qty = 0`

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π qty**

```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:
if qty is not None and qty > 0:
    pos_str += f"   üìä –û–±—ä—ë–º: <code>{qty}</code>"
else:
    pos_str += f"   üìä –û–±—ä—ë–º: <code>–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</code>"
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –Ø–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `None` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞—è `qty = 0`
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ `UnboundLocalError`

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

#### **–§—É–Ω–∫—Ü–∏—è `myreport_cmd` (—Å—Ç—Ä–æ–∫–∏ 561 –∏ 610):**
```python
# –ë—ã–ª–æ:
if qty and qty > 0:

# –°—Ç–∞–ª–æ:
if qty is not None and qty > 0:
```

**–ú–µ—Å—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –°—Ç—Ä–æ–∫–∞ 561: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–º–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–ª–æ–∫–µ
- –°—Ç—Ä–æ–∫–∞ 610: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –≤ –±–ª–æ–∫–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –û—à–∏–±–∫–∞ `local variable 'qty' referenced before assignment`
- ‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –ø—Ä–∏ `qty = 0`
- ‚ùå –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å–±–æ–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `myreport_cmd`

### ‚úÖ **–£–ª—É—á—à–µ–Ω–∏—è:**
- üõ°Ô∏è –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- üìä –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö
- üîÑ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ Telegram –±–æ—Ç–∞

## üöÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ—à–∏–±–∫–æ–π qty variable –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**

### üîß **–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π qty** –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `myreport_cmd`
2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —è–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ None** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. **–£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏** —Å–ª—É—á–∞—è `qty = 0`

### üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Telegram –±–æ—Ç –±–æ–ª—å—à–µ –Ω–µ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É `qty variable referenced before assignment`
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏!** üéâ
