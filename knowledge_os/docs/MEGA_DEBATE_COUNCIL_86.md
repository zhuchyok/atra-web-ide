# Мега-дебаты: совет всех 86 экспертов

**Тема:** Принцип «всё через экспертов»: ответы и доработки только силами экспертов с знаниями, скиллами и интернетом. Плюс семь доработок из PRINCIPLE_EXPERTS_FIRST (веб-поиск по задаче, скиллы в контексте, сохранение удачных ответов в знания, метрика «ответил эксперт», консенсус по важным вопросам, единый fallback веб-поиска, найм → живой эксперт без ручного шага).

**Участников:** 86 (совет по отделам)  
**Дата:** 2025-01-28

---

## По отделам: ЗА и ПРОТИВ

### Management

- **Виктория** (Team Lead):
  - ЗА: Единая точка координации и назначения экспертов снижает хаос; все ответы проходят через компетенции, а не через «общую» модель.
  - ПРОТИВ: При перегрузке или недоступности части экспертов задержки ответов растут; нужны жёсткие SLA и fallback.

- **Виктор** (Team Lead):
  - ЗА: Архитектурно правильно: один слой принятия решений (лид), исполнение — эксперты с контекстом.
  - ПРОТИВ: Риск узкого горлышка на координаторе; нужно масштабировать не только число экспертов, но и логику делегирования.

### Backend / Engineering

- **Игорь** (Backend Developer):
  - ЗА: Задачи на код получают релевантные знания и скиллы в промпт — меньше выдуманного кода, больше следования правилам.
  - ПРОТИВ: Если знания устарели или домен не тот, эксперт может дать формально «экспертный», но неверный ответ; нужна верификация критичных изменений.

- **Роман** (Database Engineer):
  - ЗА: Единый источник истины (БД экспертов и знаний) упрощает поддержку и аудит.
  - ПРОТИВ: Зависимость от качества данных в knowledge_nodes; плохие инсайты размножаются в контексте.

- **Ольга** (Performance Engineer):
  - ЗА: Подстановка только релевантных знаний по домену уменьшает размер промпта и латентность.
  - ПРОТИВ: При 86 экспертах и частых запросах нагрузка на LLM и БД растёт; нужны лимиты и кэши.

### QA / Testing

- **Анна** (QA Engineer):
  - ЗА: Ответы и доработки через экспертов означают предсказуемые роли и чеклисты; проще тестировать сценарии «эксперт X ответил».
  - ПРОТИВ: Если эксперт даёт неполный или некорректный ответ, автоматические тесты могут пропустить баг; нужна метрика «ответил эксперт» и ревью пограничных кейсов.

### Risk / Compliance

- **Мария** (Risk Manager):
  - ЗА: Все решения проходят через зафиксированные компетенции и знания — проще аудит и соответствие правилам.
  - ПРОТИВ: Жёсткое «только эксперты» может замедлить реакцию в инциденте, когда нужен быстрый обходной путь; нужен явный emergency-режим.

### Trading / Finance

- **Павел** (Trading Strategy Developer):
  - ЗА: Торговые и аналитические ответы должны идти от экспертов с доступом к актуальным данным и веб-поиску — меньше галлюцинаций по цифрам.
  - ПРОТИВ: Задержка из-за очереди к экспертам недопустима в реальном времени; для стриминга и алертов нужны быстрые fallback-каналы.

- **Екатерина** (Financial Analyst):
  - ЗА: Консенсус по важным вопросам (2–3 эксперта из разных отделов) повышает качество стратегических решений.
  - ПРОТИВ: Консенсус увеличивает стоимость одного ответа (несколько вызовов LLM); применять только к помеченным «критично» запросам.

### DevOps / SRE

- **Сергей** (DevOps Engineer):
  - ЗА: Единый fallback веб-поиска и «всё через экспертов» упрощают эксплуатацию: один класс ошибок (эксперты/поиск), а не смесь внешних API и ручных скриптов.
  - ПРОТИВ: Зависимость от доступности DuckDuckGo/Ollama web_search; при блокировках весь поток «с интернетом» падает без явного degradation.

### ML / Data

- **Дмитрий** (ML Engineer):
  - ЗА: Сохранение удачных ответов в знания замыкает петлю обучения; следующий эксперт уже опирается на прошлый успех.
  - ПРОТИВ: Автоматическое сохранение без фильтра может засорить базу шумом; нужен порог по feedback_score и дедупликация.

- **Максим** (Data Analyst):
  - ЗА: Метрика «ответил эксперт» vs fallback даёт измеримую цель — увеличивать долю ответов через экспертов и снижать долю «общей» модели.
  - ПРОТИВ: Метрику нужно считать по всем каналам (чат, воркер, дашборд), иначе картина искажена.

### Product / Strategy

- **Татьяна** (Technical Writer):
  - ЗА: Документация и ответы пользователям от экспертов гарантируют единый тон и соответствие продукту.
  - ПРОТИВ: Эксперты не всегда умеют писать коротко и ясно; нужны скиллы по стилю и шаблонам ответов.

- **Глеб** (Competitive Intelligence):
  - ЗА: Веб-поиск по задаче (актуальные данные, best practices) в руках экспертов даёт конкурентные преимущества без размывания ролей.
  - ПРОТИВ: Поиск должен быть управляемым (лимит запросов, таймауты), иначе затраты и риски утечек растут.

### Legal / HR

- **Артём** (Legal Counsel):
  - ЗА: Ответы только через экспертов упрощают атрибуцию и ответственность: можно указать, кто (какой эксперт/отдел) дал рекомендацию.
  - ПРОТИВ: Для юридических формулировок нужна явная пометка «не является юридической консультацией» и при необходимости человеческое ревью.

- **HR-директор** (найм):
  - ЗА: Найм → живой эксперт без ручного шага ускоряет закрытие «интеллектуальных пустынь» и уменьшает трение.
  - ПРОТИВ: Полностью автоматический приём в experts без ревью может привести к дублям или некорректным промптам; оптимально — один клик «Принять» в дашборде после просмотра кандидата.

### Остальные отделы (кратко)

- **Security, UX, Marketing, Support** и др. в совокупности дают аргументы:
  - ЗА: Единообразие (все через экспертов), рост базы знаний, использование скиллов и мировых практик, интернет по необходимости.
  - ПРОТИВ: Необходимость следить за качеством знаний, производительностью, fallback-сценариями и границами автоматизации (HITL для критичных решений).

---

## Сводка: все аргументы ЗА

- Единая точка координации и назначения экспертов снижает хаос.
- Все ответы проходят через компетенции, а не через «общую» модель.
- Архитектурно правильно: лид координирует, эксперты исполняют с контекстом.
- Задачи на код получают релевантные знания и скиллы — меньше выдуманного кода.
- Единый источник истины (БД экспертов и знаний) упрощает поддержку и аудит.
- Подстановка только релевантных знаний по домену уменьшает размер промпта и латентность.
- Предсказуемые роли и чеклисты — проще тестировать сценарии.
- Все решения проходят через зафиксированные компетенции — проще аудит и соответствие.
- Торговые/аналитические ответы от экспертов с веб-поиском — меньше галлюцинаций по цифрам.
- Консенсус по важным вопросам повышает качество стратегических решений.
- Единый fallback веб-поиска упрощает эксплуатацию.
- Сохранение удачных ответов в знания замыкает петлю обучения.
- Метрика «ответил эксперт» даёт измеримую цель для улучшения.
- Документация и ответы от экспертов — единый тон и соответствие продукту.
- Веб-поиск в руках экспертов даёт преимущества без размывания ролей.
- Ответы через экспертов упрощают атрибуцию и ответственность.
- Найм → живой эксперт без ручного шага ускоряет закрытие «пустынь».

---

## Сводка: все аргументы ПРОТИВ

- При перегрузке или недоступности экспертов задержки растут; нужны SLA и fallback.
- Риск узкого горлышка на координаторе; нужно масштабировать делегирование.
- Устаревшие или неверные знания могут дать формально «экспертный», но неверный ответ; нужна верификация критичных изменений.
- Зависимость от качества knowledge_nodes; плохие инсайты размножаются.
- При 86 экспертах нагрузка на LLM и БД растёт; нужны лимиты и кэши.
- Неполный ответ эксперта может пройти автоматические тесты; нужна метрика и ревью пограничных кейсов.
- Жёсткое «только эксперты» может замедлить реакцию в инциденте; нужен emergency-режим.
- Задержка из-за очереди к экспертам недопустима в реальном времени; нужны быстрые fallback-каналы.
- Консенсус увеличивает стоимость ответа; применять только к «критично».
- Зависимость от доступности веб-поиска; при блокировках нужен явный degradation.
- Автосохранение ответов без фильтра может засорить базу; нужен порог и дедупликация.
- Метрику «ответил эксперт» нужно считать по всем каналам.
- Эксперты не всегда пишут коротко и ясно; нужны скиллы по стилю.
- Веб-поиск должен быть управляемым (лимиты, таймауты).
- Для юридических формулировок нужна пометка и при необходимости человеческое ревью.
- Полностью автоматический приём в experts без ревью — риск дублей и некорректных промптов; оптимально — один клик «Принять» после просмотра.

---

## Вердикт совета

**Баланс:** Аргументы ЗА перевешивают при условии, что реализуются меры из ПРОТИВ: SLA и fallback при перегрузке, верификация критичных изменений, качество и дедупликация знаний, метрика «ответил эксперт» по всем каналам, emergency-режим для инцидентов, управляемый веб-поиск, консенсус только для помеченных «критично» запросов, один клик «Принять» для автонайма вместо полного автоприёма.

**Рекомендация:** Принять принцип «всё через экспертов» как основной и внедрять семь доработок из PRINCIPLE_EXPERTS_FIRST поэтапно, начиная с веб-поиска по задаче, скиллов в контексте воркера и метрики «ответил эксперт», с обязательным мониторингом задержек и доли fallback.

---

*Полный автоматический прогон мега-дебатов со всеми 86 экспертами из БД: `python knowledge_os/scripts/mega_debate.py` (тема по умолчанию — этот принцип). Результат: `knowledge_os/docs/MEGA_DEBATE_<date>.md` и `.json`.*
