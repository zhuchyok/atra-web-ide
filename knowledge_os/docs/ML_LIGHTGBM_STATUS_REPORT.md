# üìä –û–¢–ß–ï–¢ –û –ì–û–¢–û–í–ù–û–°–¢–ò –î–ê–ù–ù–´–• –î–õ–Ø LIGHTGBM

## ‚úÖ –û–¢–í–ï–¢–´ –ù–ê –í–û–ü–†–û–°–´

### 1. **–ï—Å—Ç—å –ª–∏ —É –Ω–∞—à–∏—Ö 50K –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–∞–Ω–Ω—ã–µ –æ–± –∏—Å—Ö–æ–¥–µ —Å–∏–≥–Ω–∞–ª–∞ (—É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á–∞)?**

**‚úÖ –î–ê!** 

–î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:

#### A. –í `trading_patterns.json`:
```json
{
  "result": "WIN" | "LOSS" | "NEUTRAL",
  "profit_pct": 2.3  // –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª–∏
}
```

#### B. –í —Ç–∞–±–ª–∏—Ü–µ `signals_log` (–ë–î):
```sql
result TEXT,  -- WIN/LOSS
net_profit REAL,  -- –ø—Ä–∏–±—ã–ª—å –≤ USD
entry_time TEXT,
exit_time TEXT
```

**–í—ã–≤–æ–¥**: ‚úÖ –î–∞–Ω–Ω—ã–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö **–ü–û–õ–ù–û–°–¢–¨–Æ –î–û–°–¢–£–ü–ù–´**

---

### 2. **–ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–∑–º–µ—Ä–µ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö?**

**‚úÖ –î–ê!**

- –í –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö: `profit_pct` (float)
- –í –ë–î: `net_profit` (USD) –∏ –º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç `entry_amount_usd`

**–í—ã–≤–æ–¥**: ‚úÖ –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª–∏ **–ü–û–õ–ù–û–°–¢–¨–Æ –î–û–°–¢–£–ü–ù–´**

---

### 3. **–ï—Å—Ç—å –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä—ã–Ω–∫–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–∏–≥–Ω–∞–ª–∞?**

**‚úÖ –î–ê!**

–í —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –µ—Å—Ç—å:

```python
{
  'indicators': {
    'rsi': float,
    'ema_fast': float,
    'ema_slow': float,
    'macd': float,
    'bb_upper': float,
    'bb_lower': float,
    # ... –∏ –¥—Ä—É–≥–∏–µ
  },
  'market_conditions': {
    'btc_trend': bool,
    'volume_ratio': float,
    'volatility': float,
    'market_cap': float,
    'liquidity': float
  }
}
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤ –ë–î `signals_log`:**
- `quality_score` - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞
- `mtf_score` - –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞
- `volatility_pct` - –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤ %
- `volume_usd` - –æ–±—ä–µ–º –≤ USD
- `spread_pct` - —Å–ø—Ä–µ–¥
- `depth_usd` - –≥–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞
- `sector` - —Å–µ–∫—Ç–æ—Ä –∞–∫—Ç–∏–≤–∞

**–í—ã–≤–æ–¥**: ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä—ã–Ω–∫–∞ **–ü–û–õ–ù–û–°–¢–¨–Æ –î–û–°–¢–£–ü–ù–´** (30+ features)

---

## üéØ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### ‚úÖ 1. –°–æ–∑–¥–∞–Ω –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
- –§–∞–π–ª: `docs/ML_LIGHTGBM_IMPLEMENTATION_PLAN.md`
- –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å —ç—Ç–∞–ø–∞–º–∏, –∑–∞–¥–∞—á–∞–º–∏ –∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

### ‚úÖ 2. –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å LightGBM
- –§–∞–π–ª: `lightgbm_predictor.py`
- –ö–ª–∞—Å—Å `LightGBMPredictor` —Å:
  - **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º** (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ 0-100%)
  - **–†–µ–≥—Ä–µ—Å—Å–æ—Ä–æ–º** (—Ä–∞–∑–º–µ—Ä –ø—Ä–∏–±—ã–ª–∏ –≤ %)
  - **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π** (success_prob * expected_profit)
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π 30+ features
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º/–∑–∞–≥—Ä—É–∑–∫–æ–π –º–æ–¥–µ–ª–µ–π

### ‚úÖ 3. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
- –§–∞–π–ª: `train_lightgbm_models.py`
- –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

---

## üöÄ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

### **–≠—Ç–∞–ø 1: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π (–°–ï–ô–ß–ê–°)**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install lightgbm scikit-learn

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
python train_lightgbm_models.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ú–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –æ–±—É—á–µ–Ω—ã –Ω–∞ –≤–∞—à–∏—Ö 50K –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª—å
- –ú–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `ai_learning_data/lightgbm_models/`

---

### **–≠—Ç–∞–ø 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ signal_live.py**

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ:

1. **–î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç:**
```python
from lightgbm_predictor import get_lightgbm_predictor
```

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å:**
```python
lightgbm_predictor = get_lightgbm_predictor()
lightgbm_predictor.load_models()  # –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:**
```python
# –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–∏–≥–Ω–∞–ª–∞
ml_prediction = lightgbm_predictor.predict(
    market_conditions=market_conditions,
    indicators=indicators,
    signal_params={
        'entry_price': entry_price,
        'tp1': tp1,
        'tp2': tp2,
        'risk_pct': risk_pct,
        'leverage': leverage,
        'quality_score': quality_score,
        'mtf_score': mtf_score
    }
)

# –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ combined_score
if ml_prediction['combined_score'] < 0.5:  # –ü–æ—Ä–æ–≥ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
    logger.debug("üö´ –°–∏–≥–Ω–∞–ª –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω ML: score=%.2f", ml_prediction['combined_score'])
    return None, None
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π:

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä:**
- ROC-AUC: > 0.70 (—á–µ–º –≤—ã—à–µ, —Ç–µ–º –ª—É—á—à–µ)
- Accuracy: > 60%
- F1-Score: > 0.60

**–†–µ–≥—Ä–µ—Å—Å–æ—Ä:**
- MAE: < 2% (—Å—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏)
- R¬≤: > 0.30 (–æ–±—ä—è—Å–Ω–µ–Ω–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è)
- Correlation: > 0.50 (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é)

**–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- –£–ª—É—á—à–µ–Ω–∏–µ win rate –Ω–∞ 5-10%
- –°–Ω–∏–∂–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ 20%
- –£–ª—É—á—à–µ–Ω–∏–µ Sharpe Ratio –Ω–∞ 10-15%

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### 1. **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `trading_patterns.json` –µ—Å—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (WIN/LOSS)
- –ú–∏–Ω–∏–º—É–º 100 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 10K+

### 2. **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ**
- –ú–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (early stopping)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –Ω–∞ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 3. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
- –°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. ‚úÖ **–°–ï–ô–ß–ê–°**: –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
2. ‚è≠Ô∏è **–î–ê–õ–¨–®–ï**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ signal_live.py
3. ‚è≠Ô∏è **–ü–û–°–õ–ï**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –æ–±—É—á–µ–Ω–∏—é!
**–î–∞—Ç–∞**: 2025-01-XX

