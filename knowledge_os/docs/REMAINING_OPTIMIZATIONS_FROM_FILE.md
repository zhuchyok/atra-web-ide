# –û—Å—Ç–∞–≤—à–∏–µ—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑ performance_optimization.mdc

## –î–∞—Ç–∞: 2025-01-09

## –°—Ç–∞—Ç—É—Å: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω, –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–∏–∑ —Ñ–∞–π–ª–∞):

1. ‚úÖ **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** (–ø—É–Ω–∫—Ç 54) - `src/database/redis_cache.py`
2. ‚úÖ **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ** (–ø—É–Ω–∫—Ç 46) - `executemany_optimized()`
3. ‚úÖ **VACUUM –∏ ANALYZE –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** (–ø—É–Ω–∫—Ç 56) - `vacuum_if_needed()`, `analyze_if_needed()`
4. ‚úÖ **Numba JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—è** (–ø—É–Ω–∫—Ç 70) - `src/data/technical.py`
5. ‚úÖ **–ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤** (–ø—É–Ω–∫—Ç 75) - `src/database/batch_queries.py`
6. ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** (–ø—É–Ω–∫—Ç 34) - `src/optimization/parallel_processing.py`
7. ‚úÖ **Fetchmany –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** (–ø—É–Ω–∫—Ç 48) - `src/database/fetch_optimizer.py`
8. ‚úÖ **uvloop** (–ø—É–Ω–∫—Ç 33) - `main.py`
9. ‚úÖ **Async generators** (–ø—É–Ω–∫—Ç 35) - `src/database/async_loaders.py`
10. ‚úÖ **Prepared statements** (–ø—É–Ω–∫—Ç 9) - `src/database/db.py`
11. ‚úÖ **Query caching** (–ø—É–Ω–∫—Ç 37) - `src/database/query_cache.py`
12. ‚úÖ **PGO –¥–ª—è Rust** (–ø—É–Ω–∫—Ç 22) - `scripts/build_rust_pgo.sh`
13. ‚úÖ **LTO –¥–ª—è Rust** (–ø—É–Ω–∫—Ç 23) - `rust-atra/Cargo.toml`
14. ‚úÖ **target-cpu=native** (–ø—É–Ω–∫—Ç 25) - `Makefile`

---

## üéØ –ß—Ç–æ –µ—â–µ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

#### 1. CHECK constraints –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î (–ø—É–Ω–∫—Ç 6)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–∞–ª–∏–¥–∞—Ü–∏—è OHLC –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 5-10%  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```sql
-- –î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É quotes/candles
ALTER TABLE quotes ADD CONSTRAINT chk_ohlc_valid CHECK (
    high >= low AND
    open >= low AND open <= high AND
    close >= low AND close <= high AND
    open > 0 AND high > 0 AND low > 0 AND close > 0 AND
    volume >= 0
);
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/database/db.py` - –¥–æ–±–∞–≤–∏—Ç—å CHECK constraints –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü

---

#### 2. –°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (–ø—É–Ω–∫—Ç 2)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å INTEGER –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –≤–º–µ—Å—Ç–æ DATETIME –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 20-40%, —ç–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ –Ω–∞ 30-60%  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```sql
-- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É time_surrogate INTEGER
ALTER TABLE signals ADD COLUMN time_surrogate INTEGER;
-- –ó–∞–ø–æ–ª–Ω–∏—Ç—å: time_surrogate = CAST(strftime('%s', ts) AS INTEGER)
-- –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ time_surrogate
CREATE INDEX idx_signals_time_surrogate ON signals(time_surrogate);
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/database/db.py` - –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É –∏ —Ç—Ä–∏–≥–≥–µ—Ä
- –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è time_surrogate

---

#### 3. –ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (–ø—É–Ω–∫—Ç 5)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤/—Å–∏–º–≤–æ–ª–æ–≤  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ ‚Üí –±—ã—Å—Ç—Ä–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```sql
-- –ò–Ω–¥–µ–∫—Å —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
CREATE INDEX idx_signals_active_symbols ON signals(symbol, ts) 
WHERE symbol IN ('BTCUSDT', 'ETHUSDT', ...);
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/database/db.py` - –¥–æ–±–∞–≤–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
- `scripts/analyze_and_create_indexes.py` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ

---

#### 4. –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø—É–Ω–∫—Ç 53)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—à–µ 2 –ª–µ—Ç –≤ –∞—Ä—Ö–∏–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ë–î –Ω–∞ 30-80%  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç `scripts/archive_old_data.py`
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `system_tasks.py`
- –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `_archive`

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `scripts/archive_old_data.py` - —Å–∫—Ä–∏–ø—Ç –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
- `src/database/archive_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏

---

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

#### 5. Query profiling —É–ª—É—á—à–µ–Ω–∏—è (–ø—É–Ω–∫—Ç 16)
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `query_profiler.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ `EXPLAIN QUERY PLAN`
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `Database.execute_with_retry()` –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã > 1 —Å–µ–∫—É–Ω–¥—ã

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/database/query_profiler.py` - —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- `src/database/db.py` - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª–∏–Ω–≥

---

#### 6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è chunking —Ä–∞–∑–º–µ—Ä–æ–≤ (–ø—É–Ω–∫—Ç 48)
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ chunk  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£–ª—É—á—à–µ–Ω–∏–µ cache locality, —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è SQLite:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ chunk
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π chunking –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/database/async_loaders.py` - –¥–æ–±–∞–≤–∏—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π chunking
- `src/database/fetch_optimizer.py` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞

---

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏):

#### 7. SIMD –≤ Rust (–ø—É–Ω–∫—Ç 28)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SIMD –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—è–¥–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** ‚úÖ –î–∞, –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å SIMD –≤ `rust-atra` –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `packed_simd` –∏–ª–∏ `rayon/simd`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `rust-atra/Cargo.toml` - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `rust-atra/src/indicators.rs` - –¥–æ–±–∞–≤–∏—Ç—å SIMD –≤–µ—Ä—Å–∏–∏

---

#### 8. jemalloc –¥–ª—è Rust (–ø—É–Ω–∫—Ç 30)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ jemalloc –≤–º–µ—Å—Ç–æ system allocator  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 5-15% –¥–ª—è —á–∞—Å—Ç—ã—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** ‚úÖ –î–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```toml
# rust-atra/Cargo.toml
[dependencies]
jemallocator = "0.5"
```

```rust
// rust-atra/src/lib.rs
#[global_allocator]
static ALLOC: jemallocator::Jemalloc = jemallocator::Jemalloc;
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `rust-atra/Cargo.toml` - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
- `rust-atra/src/lib.rs` - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å global allocator

---

#### 9. Memory alignment (–ø—É–Ω–∫—Ç 27)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫—ç—à-–ª–∏–Ω–∏–∏ (64 –±–∞–π—Ç–∞)  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 10-30% –∑–∞ —Å—á–µ—Ç –ª—É—á—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** ‚úÖ –î–∞, –¥–ª—è hot paths –≤ Rust

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```rust
#[repr(align(64))]  // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –∫—ç—à-–ª–∏–Ω–∏–∏
struct HotData {
    // –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
}
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `rust-atra/src/indicators.rs` - –¥–æ–±–∞–≤–∏—Ç—å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–ª—è hot paths

---

#### 10. Cython –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ (–ø—É–Ω–∫—Ç 69)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–∏–ª—è—Ü–∏—è Python –≤ C –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 10-100x –¥–ª—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** ‚úÖ –î–∞, –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –í—ã–¥–µ–ª–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `src/data/technical.py`
- –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–∞ Cython
- –ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –≤ .so –º–æ–¥—É–ª–∏

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `src/data/technical_cython.pyx` - Cython –≤–µ—Ä—Å–∏—è
- `setup.py` - —Å–∫—Ä–∏–ø—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

---

#### 11. –ú–æ–¥—É–ª—å array –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤–æ–≤ (–ø—É–Ω–∫—Ç 71)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `array.array` –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–æ–≤ –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 12-15x –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** ‚úÖ –î–∞, –Ω–æ NumPy —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** NumPy —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É —ç—Ñ—Ñ–µ–∫—Ç –±—É–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):
1. **CHECK constraints** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏** - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):
4. **–ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
5. **Query profiling —É–ª—É—á—à–µ–Ω–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
6. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è chunking** - —É–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –í –±—É–¥—É—â–µ–º (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):
7. **SIMD –≤ Rust** - –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
8. **jemalloc** - –Ω–µ–±–æ–ª—å—à–æ–π —ç—Ñ—Ñ–µ–∫—Ç
9. **Memory alignment** - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
10. **Cython** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### –≠—Ç–∞–ø 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î (1-2 –¥–Ω—è)
- ‚úÖ CHECK constraints –¥–ª—è OHLC –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
- ‚úÖ –ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

### –≠—Ç–∞–ø 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (2-3 –¥–Ω—è)
- ‚úÖ –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Query profiling —É–ª—É—á—à–µ–Ω–∏—è
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è chunking —Ä–∞–∑–º–µ—Ä–æ–≤

### –≠—Ç–∞–ø 3: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ SIMD –≤ Rust
- ‚úÖ jemalloc
- ‚úÖ Memory alignment
- ‚úÖ Cython

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- **CHECK constraints:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 5-10%
- **–°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 20-40%, —ç–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ –Ω–∞ 30-60%
- **–ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ 30-50%

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- **–ê—Ä—Ö–∏–≤–∞—Ü–∏—è:** –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ë–î –Ω–∞ 30-80%
- **Query profiling:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ —É–∑–∫–∏—Ö –º–µ—Å—Ç
- **Chunking:** –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 20-30%

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- **SIMD:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—è–¥–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤
- **jemalloc:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 5-15%
- **Memory alignment:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 10-30%
- **Cython:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 10-100x –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

**–í—Å–µ–≥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –≤ —Ñ–∞–π–ª–µ:** 81  
**–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** ~14  
**–ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:** ~11  
**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:** 6 (–≤—ã—Å–æ–∫–∏–π + —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–û–∂–∏–¥–∞–µ–º—ã–π –æ–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:**
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤: 20-50%
- –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ë–î: 30-80%
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫: 100% (CHECK constraints)
- –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª–∏–Ω–≥

