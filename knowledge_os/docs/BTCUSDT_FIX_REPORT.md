# –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –û–®–ò–ë–ö–ò BTCUSDT

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞:** `local variable 'source' referenced before assignment`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `signal_live.py`, —Ñ—É–Ω–∫—Ü–∏—è `check_and_send_signals()`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `source` –Ω–µ –±—ã–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤ –±–ª–æ–∫–µ `except`.

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
if USE_BTC_TREND_FILTER:
    print("[LiveSignal] –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ BTCUSDT –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ —Ç—Ä–µ–Ω–¥–∞...")
    try:
        btc_ohlc = await get_ohlc_with_fallback("BTCUSDT", interval=tf, limit=300)
        if not btc_ohlc or len(btc_ohlc) < 200:
            try:
                btc_ohlc = await get_ohlc_bybit_sync_async("BTCUSDT", interval=tf, limit=300)
                if btc_ohlc and len(btc_ohlc) >= 200:
                    source = "Bybit"  # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å
                    # ...
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
if USE_BTC_TREND_FILTER:
    print("[LiveSignal] –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ BTCUSDT –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ —Ç—Ä–µ–Ω–¥–∞...")
    btc_ohlc = None
    source = "Unknown"  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –Ω–∞—á–∞–ª–µ

    try:
        # –ü—Ä–æ–±—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
        btc_ohlc = await get_ohlc_with_fallback("BTCUSDT", interval=tf, limit=300)
        if btc_ohlc and len(btc_ohlc) >= 200:
            source = "Primary"
            print(f"[DEBUG] BTCUSDT: –ø–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (len={len(btc_ohlc)})")

        # –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É–µ–º Bybit
        if not btc_ohlc or len(btc_ohlc) < 200:
            try:
                btc_ohlc = await get_ohlc_bybit_sync_async("BTCUSDT", interval=tf, limit=300)
                if btc_ohlc and len(btc_ohlc) >= 200:
                    source = "Bybit"
                    # ...
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ:**
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `check_and_send_signals()` —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –î–∞–Ω–Ω—ã–µ BTCUSDT —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç (ETHUSDT, BTCUSDT, SOLUSDT, –∏ –¥—Ä.)
- ‚úÖ –ù–æ–≤–æ—Å—Ç–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `source` –±–æ–ª—å—à–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫

## üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-----------|--------|------------|
| BTCUSDT –¥–∞–Ω–Ω—ã–µ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ |
| –§–∏–ª—å—Ç—Ä —Ç—Ä–µ–Ω–¥–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| –ù–æ–≤–æ—Å—Ç–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ |
| –°–∏—Å—Ç–µ–º–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ì–æ—Ç–æ–≤–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ |

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û—à–∏–±–∫–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `source` —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

‚úÖ **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ**
‚úÖ **–î–∞–Ω–Ω—ã–µ BTCUSDT –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
‚úÖ **–§–∏–ª—å—Ç—Ä —Ç—Ä–µ–Ω–¥–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç**
‚úÖ **–°–∏–≥–Ω–∞–ª—ã –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫**

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ!** üöÄ
