# üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ MTF CONFIRMATION –î–õ–Ø SHORT –°–ò–ì–ù–ê–õ–û–í

**–î–∞—Ç–∞:** 2025-12-01  
**–ü—Ä–æ–±–ª–µ–º–∞:** MTF confirmation –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è SHORT CLASSIC –∏–∑-–∑–∞ `confidence=0.00`

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú–´

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:

1. **H4 confidence = 0.00 –¥–ª—è SHORT —Å–∏–≥–Ω–∞–ª–æ–≤:**
   - –í –ª–æ–≥–∞—Ö: "üéØ –ì–∏–±—Ä–∏–¥–Ω—ã–π MTF LUNAUSDT SELL: H4=0.00, H1=0.00, market=0.30, final=0.50"
   - Fallback —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–∞–µ—Ç `final=0.50`
   - MTF –ø—Ä–æ—Ö–æ–¥–∏—Ç: "‚úÖ [MTF PASS] LUNAUSDT SHORT CLASSIC: MTF confirmation –ø—Ä–æ–π–¥–µ–Ω"

2. **–ü–æ—á–µ–º—É H4 = 0.00:**
   - –î–ª—è SHORT –Ω–∞ H4 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –º–µ–¥–≤–µ–∂–∏–π —Ç—Ä–µ–Ω–¥: `current_price < ema_fast and ema_fast < ema_slow`
   - –ï—Å–ª–∏ —Ç—Ä–µ–Ω–¥ –Ω–µ –º–µ–¥–≤–µ–∂–∏–π, —Ç–æ `confidence = 0.3` (—Å—Ç—Ä–æ–∫–∞ 235)
   - –ó–∞—Ç–µ–º MACD –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å confidence: `confidence = max(0.0, confidence - 0.05)` (—Å—Ç—Ä–æ–∫–∞ 245)
   - –ï—Å–ª–∏ MACD bullish, confidence –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å 0.0 –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫
   - –ï—Å–ª–∏ `confidence < min_confidence` (0.4 –¥–ª—è SHORT), —Ç–æ `confirmed = False` (—Å—Ç—Ä–æ–∫–∞ 254)

3. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º:**
   - –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–∞–µ—Ç `final=0.50` –ø—Ä–∏ `H4=0.00, H1=0.00, market=0.30`
   - –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ—Ä–æ–≥ `min_h4_confidence_short=0.4`
   - –°–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ö–æ–¥—è—Ç MTF confirmation

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê: H4 –í–û–ó–í–†–ê–©–ê–ï–¢ 0.00

### –ü—Ä–∏—á–∏–Ω—ã:

1. **–°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è SHORT –Ω–∞ H4:**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–ª—å–Ω—ã–π –º–µ–¥–≤–µ–∂–∏–π —Ç—Ä–µ–Ω–¥: `price < ema_fast < ema_slow`
   - –ï—Å–ª–∏ —Ç—Ä–µ–Ω–¥ —Å–ª–∞–±—ã–π –∏–ª–∏ –±–æ–∫–æ–≤–æ–π, confidence = 0.3
   - MACD bullish —Å–Ω–∏–∂–∞–µ—Ç confidence –¥–æ 0.0

2. **MACD –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è:**
   - –ü—Ä–∏ MACD bullish: `confidence = max(0.0, confidence - 0.05)`
   - –ï—Å–ª–∏ confidence = 0.3, –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ = 0.25
   - –ù–æ –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫, –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å 0.0

3. **H1 —Ç—Ä–µ–Ω–¥ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:**
   - H1 —Ç–∞–∫–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0.00 –¥–ª—è SHORT —Å–∏–≥–Ω–∞–ª–æ–≤
   - –ù–µ –¥–∞–µ—Ç –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é –¥–ª—è H4

---

## üí° –ü–û–î–•–û–î–´ –ö –†–ï–®–ï–ù–ò–Æ

### **–ü–û–î–•–û–î 1: –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É H4 –¥–ª—è SHORT**

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –º–µ–¥–≤–µ–∂—å–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ confidence –¥–ª—è —Å–ª–∞–±–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞
2. –ù–µ —Å–Ω–∏–∂–∞—Ç—å confidence –¥–æ 0.0 –ø—Ä–∏ MACD bullish
3. –£—á–∏—Ç—ã–≤–∞—Ç—å –±–æ–∫–æ–≤–æ–π —Ç—Ä–µ–Ω–¥ –∫–∞–∫ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π (confidence = 0.4-0.5)

**–ö–æ–¥:**
```python
# –í–º–µ—Å—Ç–æ:
else:
    confidence = 0.3
    confirmed = False
    reason = "4h not bearish (weak trend)"

# –°–¥–µ–ª–∞—Ç—å:
else:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–æ–∫–æ–≤–æ–π —Ç—Ä–µ–Ω–¥
    if abs(ema_fast - ema_slow) / ema_slow < 0.01:  # –ë–æ–∫–æ–≤–æ–π —Ç—Ä–µ–Ω–¥ (<1%)
        confidence = 0.45  # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
        confirmed = False
        reason = "4h sideways trend"
    else:
        confidence = 0.35  # –°–ª–∞–±—ã–π —Ç—Ä–µ–Ω–¥
        confirmed = False
        reason = "4h weak trend"
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–∏ —Å–ª–∞–±–æ–º —Ç—Ä–µ–Ω–¥–µ

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã

---

### **–ü–û–î–•–û–î 2: –£–ª—É—á—à–∏—Ç—å fallback –º–µ—Ö–∞–Ω–∏–∑–º**

**–ü—Ä–æ–±–ª–µ–º–∞:** Fallback –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `H4 <= 0.01`

**–†–µ—à–µ–Ω–∏–µ:**
1. –†–∞—Å—à–∏—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è –¥–ª—è fallback
2. –£—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ H4, –Ω–æ –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã
3. –°–¥–µ–ª–∞—Ç—å fallback –±–æ–ª–µ–µ —É–º–Ω—ã–º

**–ö–æ–¥:**
```python
# –í–º–µ—Å—Ç–æ:
if is_short and h4_confidence <= 0.01:
    if (h1_trend_strength >= 0.3 or market_momentum >= 0.3):
        fallback_boost = 0.5

# –°–¥–µ–ª–∞—Ç—å:
if is_short and h4_confidence < 0.4:  # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
    # –£–º–Ω—ã–π fallback —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
    fallback_score = 0.0
    if h1_trend_strength >= 0.3:
        fallback_score += 0.2
    if market_momentum >= 0.3:
        fallback_score += 0.2
    if h4_confidence >= 0.2:  # –î–∞–∂–µ —Å–ª–∞–±—ã–π H4 –ª—É—á—à–µ —á–µ–º 0.0
        fallback_score += 0.1
    
    if fallback_score >= 0.3:  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥
        fallback_boost = 0.5
        boosted_confidence = max(boosted_confidence, fallback_boost)
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–æ–ª–µ–µ –≥–∏–±–∫–∏–π fallback
- ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã

---

### **–ü–û–î–•–û–î 3: –°–Ω–∏–∑–∏—Ç—å min_confidence_short**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Ä–æ–≥ 0.4 –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–Ω–∏–∑–∏—Ç—å `min_h4_confidence_short` —Å 0.4 –¥–æ 0.35 –∏–ª–∏ 0.3
2. –°–¥–µ–ª–∞—Ç—å –ø–æ—Ä–æ–≥ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç market_momentum

**–ö–æ–¥:**
```python
# –í config.py:
'min_h4_confidence_short': 0.35,  # –°–Ω–∏–∂–µ–Ω–æ —Å 0.4

# –ò–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π:
if is_short:
    base_min = 0.35
    # –°–Ω–∏–∂–∞–µ–º –ø–æ—Ä–æ–≥ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º market momentum
    if market_momentum >= 0.5:
        min_confidence_for_final = base_min - 0.05  # 0.30
    else:
        min_confidence_for_final = base_min
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- ‚ö†Ô∏è –ù–µ —Ä–µ—à–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É

---

### **–ü–û–î–•–û–î 4: –£–ª—É—á—à–∏—Ç—å –∞–Ω–∞–ª–∏–∑ H1 —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è SHORT**

**–ü—Ä–æ–±–ª–µ–º–∞:** H1 —Ç–∞–∫–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0.00 –¥–ª—è SHORT —Å–∏–≥–Ω–∞–ª–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É –∞–Ω–∞–ª–∏–∑–∞ H1 —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è SHORT
2. –£—á–∏—Ç—ã–≤–∞—Ç—å –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –º–µ–¥–≤–µ–∂—å–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞
3. –î–∞–≤–∞—Ç—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏ —Å–ª–∞–±–æ–º —Ç—Ä–µ–Ω–¥–µ

**–ö–æ–¥:**
```python
# –í _analyze_h1_trend_strength:
# –î–ª—è SHORT —Å–∏–≥–Ω–∞–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è
if signal_type.upper() == "SHORT":
    # –ë–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –º–µ–¥–≤–µ–∂—å–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞
    if current_price < ema_fast * 1.01:  # –î–æ–ø—É—Å–∫ 1%
        trend_strength = 0.4  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
    # ...
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —É—Ä–æ–≤–Ω–µ H1
- ‚úÖ –î–∞–µ—Ç –±–æ–ª—å—à–µ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –¥–ª—è H4

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö

---

### **–ü–û–î–•–û–î 5: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)**

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤ 1, 2 –∏ 4

1. **–£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É H4 –¥–ª—è SHORT:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ confidence
   - –ù–µ —Å–Ω–∏–∂–∞—Ç—å confidence –¥–æ 0.0

2. **–£–ª—É—á—à–∏—Ç—å fallback:**
   - –†–∞—Å—à–∏—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
   - –£–º–Ω—ã–π fallback —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤

3. **–£–ª—É—á—à–∏—Ç—å –∞–Ω–∞–ª–∏–∑ H1:**
   - –ë–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è SHORT
   - –î–∞–≤–∞—Ç—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏ —Å–ª–∞–±–æ–º —Ç—Ä–µ–Ω–¥–µ

**–ü–ª—é—Å—ã:**
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- ‚úÖ –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚ö†Ô∏è –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ü–û–î–•–û–î 5 (–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):**

1. **–£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É H4 –¥–ª—è SHORT** - –Ω–µ —Å–Ω–∏–∂–∞—Ç—å confidence –¥–æ 0.0
2. **–£–ª—É—á—à–∏—Ç—å fallback** - —Ä–∞—Å—à–∏—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è –∏ —Å–¥–µ–ª–∞—Ç—å —É–º–Ω–µ–µ
3. **–£–ª—É—á—à–∏—Ç—å –∞–Ω–∞–ª–∏–∑ H1** - –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è SHORT

–≠—Ç–æ –¥–∞—Å—Ç:
- ‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –æ—Ü–µ–Ω–∫—É —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –ú–µ–Ω—å—à–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—É—é —Ä–∞–±–æ—Ç—É MTF

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –≤ `hybrid_mtf.py`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ –∏ –ø–æ—Å–ª–µ
4. –í—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

