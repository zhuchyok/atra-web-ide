# üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø –û –ö–û–†–£–¢–ò–ù–ï

## üìã **–ü—Ä–æ–±–ª–µ–º–∞**

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã –≤–æ–∑–Ω–∏–∫–∞–ª–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
```
RuntimeWarning: coroutine 'get_filtered_top_usdt_pairs_fast' was never awaited
```

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω—ã**

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ñ–∞–π–ª–µ `config.py` –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 54-55:
```python
if AUTO_FETCH_COINS:
    COINS = get_filtered_top_usdt_pairs_fast(top_n=150, final_limit=50)
```

–§—É–Ω–∫—Ü–∏—è `get_filtered_top_usdt_pairs_fast` —è–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π (async), –Ω–æ –≤—ã–∑—ã–≤–∞–ª–∞—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è `config.py`, –∫–æ–≥–¥–∞ event loop –µ—â–µ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω.

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ config.py**
- –ó–∞–º–µ–Ω–∏–ª –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ª–µ–Ω–∏–≤—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
- –°–æ–∑–¥–∞–ª —Ñ—É–Ω–∫—Ü–∏—é `initialize_coins_sync()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π event loops
- –î–æ–±–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π event loop
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª ThreadPoolExecutor –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ main.py**
- –î–æ–±–∞–≤–∏–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–ø–∏—Å–∫–∞ –º–æ–Ω–µ—Ç –≤ `main()` –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ event loop
- –û–±–Ω–æ–≤–∏–ª –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `config.COINS` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### 3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤**
- `test_coins_initialization.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–µ—Ç
- –û–±–Ω–æ–≤–ª–µ–Ω `test_fixed_imports.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

## üß™ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
RuntimeWarning: coroutine 'get_filtered_top_usdt_pairs_fast' was never awaited
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞: 50 –º–æ–Ω–µ—Ç
‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –∫–æ—Ä—É—Ç–∏–Ω–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ
```

## üìä **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**

### **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**
```python
def initialize_coins_sync():
    """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –º–æ–Ω–µ—Ç"""
    if AUTO_FETCH_COINS:
        try:
            from exchange_api import get_filtered_top_usdt_pairs_fast
            import asyncio
            try:
                loop = asyncio.get_running_loop()
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º ThreadPoolExecutor –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
                import concurrent.futures
                
                def run_in_new_loop():
                    new_loop = asyncio.new_event_loop()
                    asyncio.set_event_loop(new_loop)
                    try:
                        return new_loop.run_until_complete(
                            get_filtered_top_usdt_pairs_fast(top_n=150, final_limit=50)
                        )
                    finally:
                        new_loop.close()
                
                with concurrent.futures.ThreadPoolExecutor() as executor:
                    future = executor.submit(run_in_new_loop)
                    return future.result(timeout=30)
                    
            except RuntimeError:
                # –ù–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ loop, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
                loop = asyncio.new_event_loop()
                asyncio.set_event_loop(loop)
                try:
                    return loop.run_until_complete(
                        get_filtered_top_usdt_pairs_fast(top_n=150, final_limit=50)
                    )
                finally:
                    loop.close()
        except Exception:
            pass
    return None
```

### **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ main.py:**
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –º–æ–Ω–µ—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω AUTO_FETCH_COINS)
try:
    from config import initialize_coins_sync, COINS
    if COINS == []:  # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
        logger.info("ü™ô –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –º–æ–Ω–µ—Ç...")
        initialized_coins = initialize_coins_sync()
        if initialized_coins:
            # –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é COINS
            import config
            config.COINS = initialized_coins
            logger.info("‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ %d –º–æ–Ω–µ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞", len(initialized_coins))
except Exception as e:
    logger.warning("‚ö†Ô∏è –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ –º–æ–Ω–µ—Ç: %s", e)
```

## üéâ **–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

### ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–æ:**
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –∫–æ—Ä—É—Ç–∏–Ω–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å event loop –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª–µ–π
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –º–æ–Ω–µ—Ç
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ event loops
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–µ—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–Ω–µ—Ç

### ‚úÖ **–£–ª—É—á—à–µ–Ω–æ:**
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- –ß–∏—Å—Ç–æ—Ç–∞ –ª–æ–≥–æ–≤ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∑–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –º–æ–Ω–µ—Ç)

## üöÄ **–°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û**

–í—Å–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–∏—Å—Ç–æ, –±–µ–∑ RuntimeWarning —Å–æ–æ–±—â–µ–Ω–∏–π.

---
**–î–∞—Ç–∞:** 2025-10-04  
**–í–µ—Ä—Å–∏—è:** 2.2 (–§–∏–Ω–∞–ª—å–Ω–∞—è)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
