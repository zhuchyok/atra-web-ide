# üë• –ê–ù–ê–õ–ò–ó –ö–û–ú–ê–ù–î–´: –õ–æ–≥–∏–∫–∞ —Ç–æ—á–µ–∫ –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞

## üìä –¢–ï–ö–£–©–ê–Ø –õ–û–ì–ò–ö–ê

### 1. **–¢–û–ß–ö–ê –í–•–û–î–ê (Entry Point)**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# signal_live.py, —Å—Ç—Ä–æ–∫–∞ 2209
signal_price = current_price  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è close —Ü–µ–Ω–∞ —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `close` —Ü–µ–Ω–∞ —Å–≤–µ—á–∏, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –∑–∞–∫—Ä—ã–ª–∞—Å—å
- ‚ùå –ù–µ—Ç —É—á–µ—Ç–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è (slippage)
- ‚ùå –ù–µ—Ç —É—á–µ—Ç–∞ —Å–ø—Ä–µ–¥–∞ (spread)
- ‚ùå –ù–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ö–æ–¥–∞ (–ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ vs —Ä—ã–Ω–æ—á–Ω—ã–µ)
- ‚ùå –ù–µ—Ç —É—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—Ö–æ–¥–∞ (–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- `_generate_signal_impl()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- –í—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (classic_ema, alternative_1, alternative_2, etc.)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `df['close'].iloc[-1]` –∫–∞–∫ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

### 2. **–¢–û–ß–ö–ê –í–´–•–û–î–ê (Exit Point)**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### **Take Profit (TP):**
```python
# src/signals/risk.py, get_dynamic_tp_levels()
# –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: TP1 = 2%, TP2 = 4%
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR:
tp1 = atr_pct * 1.5  # –î–ª—è LONG
tp2 = atr_pct * 3.0  # –î–ª—è LONG
```

#### **Stop Loss (SL):**
```python
# src/signals/risk.py, get_dynamic_sl_level()
# –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 2%
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR:
sl = atr_pct * 2.0  # –î–ª—è LONG –∏ SHORT
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 1-8%
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå TP/SL —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR, –Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç:
  - –£—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
  - –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏ (–∫—Ä—É–≥–ª—ã–µ —á–∏—Å–ª–∞)
  - –û–±—ä–µ–º–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
  - –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞ (—Ç—Ä–µ–Ω–¥/—Ñ–ª—ç—Ç)
- ‚ùå –ù–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
- ‚ùå –ù–µ—Ç —É—á–µ—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ TP
- ‚ùå TP1 trailing SL —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω

## üîç –ì–ò–ü–û–¢–ï–ó–´ –î–õ–Ø –£–õ–£–ß–®–ï–ù–ò–Ø

### **–ì–ò–ü–û–¢–ï–ó–ê 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `close` —Ü–µ–Ω—ã –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º

**–ì–∏–ø–æ—Ç–µ–∑—ã:**
1. **H1.1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ high/low –¥–ª—è –≤—Ö–æ–¥–∞**
   - –î–ª—è LONG: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `low` —Å–≤–µ—á–∏ (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞)
   - –î–ª—è SHORT: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `high` —Å–≤–µ—á–∏ (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ –Ω–∞ 0.1-0.3%

2. **H1.2: –£—á–µ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è**
   - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ (0.05-0.15% –¥–ª—è –ª–∏–∫–≤–∏–¥–Ω—ã—Ö –º–æ–Ω–µ—Ç)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `close * (1 + slippage)` –¥–ª—è LONG
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `close * (1 - slippage)` –¥–ª—è SHORT
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–∫—Ç–µ—Å—Ç–∞

3. **H1.3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—Ö–æ–¥–∞**
   - –ê–Ω–∞–ª–∏–∑ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ —á–∞—Å–∞–º
   - –í—Ö–æ–¥ –≤ –ø–µ—Ä–∏–æ–¥—ã –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (–º–µ–Ω—å—à–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è –Ω–∞ 20-30%

4. **H1.4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤**
   - –í–º–µ—Å—Ç–æ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä
   - –î–ª—è LONG: –ª–∏–º–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ `low` —Å–≤–µ—á–∏ –∏–ª–∏ –Ω–∏–∂–µ
   - –î–ª—è SHORT: –ª–∏–º–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ `high` —Å–≤–µ—á–∏ –∏–ª–∏ –≤—ã—à–µ
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ –Ω–∞ 0.2-0.5%

### **–ì–ò–ü–û–¢–ï–ó–ê 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ—á–∫–∏ –≤—ã—Ö–æ–¥–∞ (TP)**

**–ü—Ä–æ–±–ª–µ–º–∞:** TP —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR, –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞

**–ì–∏–ø–æ—Ç–µ–∑—ã:**
1. **H2.1: –£—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è**
   - –ê–Ω–∞–ª–∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∞–∫—Å–∏–º—É–º–æ–≤/–º–∏–Ω–∏–º—É–º–æ–≤
   - TP1 –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è (–¥–ª—è LONG)
   - TP2 –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–≤–µ–ª–∏—á–µ–Ω–∏–µ Win Rate –Ω–∞ 3-5%

2. **H2.2: –£—á–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π**
   - –ö—Ä—É–≥–ª—ã–µ —á–∏—Å–ª–∞ (100, 150, 200)
   - –£—Ä–æ–≤–Ω–∏ –§–∏–±–æ–Ω–∞—á—á–∏
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ TP –Ω–∞ 2-3%

3. **H2.3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏**
   - –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí –±–æ–ª—å—à–∏–µ TP
   - –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí –º–µ–Ω—å—à–∏–µ TP
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ Profit Factor –Ω–∞ 0.1-0.3

4. **H2.4: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞**
   - –¢—Ä–µ–Ω–¥ ‚Üí –±–æ–ª—å—à–∏–µ TP (TP1=3%, TP2=6%)
   - –§–ª—ç—Ç ‚Üí –º–µ–Ω—å—à–∏–µ TP (TP1=1.5%, TP2=3%)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ PnL –Ω–∞ 5-10%

### **–ì–ò–ü–û–¢–ï–ó–ê 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ—á–∫–∏ –≤—ã—Ö–æ–¥–∞ (SL)**

**–ü—Ä–æ–±–ª–µ–º–∞:** SL —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR, –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —É—Å–ª–æ–≤–∏—è–º

**–ì–∏–ø–æ—Ç–µ–∑—ã:**
1. **H3.1: –£—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –¥–ª—è SL**
   - SL –Ω–∏–∂–µ –±–ª–∏–∂–∞–π—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–¥–ª—è LONG)
   - SL –≤—ã—à–µ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è (–¥–ª—è SHORT)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π SL –Ω–∞ 10-15%

2. **H3.2: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π SL –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏**
   - –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí –±–æ–ª—å—à–∏–π SL (3-4%)
   - –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí –º–µ–Ω—å—à–∏–π SL (1-1.5%)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ Win Rate –Ω–∞ 2-4%

3. **H3.3: –£—á–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞ –¥–ª—è SL**
   - –¢—Ä–µ–Ω–¥ ‚Üí –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π SL (2.5-3%)
   - –§–ª—ç—Ç ‚Üí –±–æ–ª–µ–µ —É–∑–∫–∏–π SL (1.5-2%)
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π

### **–ì–ò–ü–û–¢–ï–ó–ê 4: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**

**–ì–∏–ø–æ—Ç–µ–∑—ã:**
1. **H4.1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–∞ + –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP**
   - –ö–æ–º–±–∏–Ω–∞—Ü–∏—è H1.1 + H2.4
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ PnL –Ω–∞ 10-15%

2. **H4.2: –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥)**
   - –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π
   - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ PnL –Ω–∞ 15-25%, Win Rate +3-5%

## üìã –ü–õ–ê–ù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### **–≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∞–∑–æ–≤—ã–π –±–µ–∫—Ç–µ—Å—Ç**

**–ó–∞–¥–∞—á–∏:**
1. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ–¥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/backtest_data/`
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –±–µ–∫—Ç–µ—Å—Ç —Å —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–æ–π
3. ‚úÖ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (Win Rate, Profit Factor, PnL, Sharpe)

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
- Win Rate (%)
- Profit Factor
- Total PnL (%)
- Sharpe Ratio
- Sortino Ratio
- Max Drawdown (%)
- –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É
- –°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫ –Ω–∞ —Å–¥–µ–ª–∫—É

### **–≠–¢–ê–ü 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑ –ø–æ –≤—Ö–æ–¥—É**

**–¢–µ—Å—Ç H1.1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ high/low –¥–ª—è –≤—Ö–æ–¥–∞**
```python
# –í–∞—Ä–∏–∞–Ω—Ç A: –¢–µ–∫—É—â–∏–π (close)
entry_price = df['close'].iloc[i]

# –í–∞—Ä–∏–∞–Ω—Ç B: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (low –¥–ª—è LONG, high –¥–ª—è SHORT)
if side == 'LONG':
    entry_price = df['low'].iloc[i]  # –õ—É—á—à–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
else:
    entry_price = df['high'].iloc[i]  # –õ—É—á—à–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
```

**–¢–µ—Å—Ç H1.2: –£—á–µ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è**
```python
slippage = 0.001  # 0.1% –¥–ª—è –ª–∏–∫–≤–∏–¥–Ω—ã—Ö –º–æ–Ω–µ—Ç
if side == 'LONG':
    entry_price = df['close'].iloc[i] * (1 + slippage)
else:
    entry_price = df['close'].iloc[i] * (1 - slippage)
```

**–¢–µ—Å—Ç H1.4: –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞**
```python
# –î–ª—è LONG: –ª–∏–º–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ low –∏–ª–∏ –Ω–∏–∂–µ
if side == 'LONG':
    entry_price = df['low'].iloc[i] * 0.999  # –ù–∞ 0.1% –Ω–∏–∂–µ low
else:
    entry_price = df['high'].iloc[i] * 1.001  # –ù–∞ 0.1% –≤—ã—à–µ high
```

### **–≠–¢–ê–ü 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑ –ø–æ –≤—ã—Ö–æ–¥—É (TP)**

**–¢–µ—Å—Ç H2.1: –£—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è**
```python
# –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–∏–µ —É—Ä–æ–≤–Ω–∏
resistance_levels = find_resistance_levels(df, i, lookback=50)
support_levels = find_support_levels(df, i, lookback=50)

if side == 'LONG':
    tp1 = min(resistance_levels[0], entry_price * 1.02)  # –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∏–ª–∏ 2%
    tp2 = min(resistance_levels[1], entry_price * 1.04)  # –°–ª–µ–¥—É—é—â–µ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∏–ª–∏ 4%
```

**–¢–µ—Å—Ç H2.3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏**
```python
volatility = calculate_volatility(df, i, period=20)
if volatility > 0.03:  # –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (>3%)
    tp1_mult = 2.0  # TP1 = ATR * 2.0
    tp2_mult = 4.0  # TP2 = ATR * 4.0
else:  # –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    tp1_mult = 1.2  # TP1 = ATR * 1.2
    tp2_mult = 2.4  # TP2 = ATR * 2.4
```

**–¢–µ—Å—Ç H2.4: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞**
```python
market_structure = detect_market_structure(df, i)  # 'trend' –∏–ª–∏ 'range'
if market_structure == 'trend':
    tp1_pct = 3.0  # –ë–æ–ª—å—à–∏–µ TP –≤ —Ç—Ä–µ–Ω–¥–µ
    tp2_pct = 6.0
else:  # range/flat
    tp1_pct = 1.5  # –ú–µ–Ω—å—à–∏–µ TP –≤–æ —Ñ–ª—ç—Ç–µ
    tp2_pct = 3.0
```

### **–≠–¢–ê–ü 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑ –ø–æ –≤—ã—Ö–æ–¥—É (SL)**

**–¢–µ—Å—Ç H3.1: –£—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –¥–ª—è SL**
```python
if side == 'LONG':
    nearest_support = find_nearest_support(df, i, entry_price)
    sl = max(nearest_support * 0.995, entry_price * 0.98)  # –ù–∏–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ 2%
else:
    nearest_resistance = find_nearest_resistance(df, i, entry_price)
    sl = min(nearest_resistance * 1.005, entry_price * 1.02)  # –í—ã—à–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∏–ª–∏ 2%
```

**–¢–µ—Å—Ç H3.2: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π SL –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏**
```python
volatility = calculate_volatility(df, i, period=20)
if volatility > 0.03:  # –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    sl_pct = 3.5  # –ë–æ–ª—å—à–∏–π SL
else:
    sl_pct = 1.5  # –ú–µ–Ω—å—à–∏–π SL
```

### **–≠–¢–ê–ü 5: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–¢–µ—Å—Ç H4.1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–∞ + –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP**
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ —ç—Ç–∞–ø–æ–≤ 2 –∏ 3

**–¢–µ—Å—Ç H4.2: –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π

### **–≠–¢–ê–ü 6: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –º–æ–Ω–µ—Ç–∞—Ö**

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞:**
1. –í—ã—Å–æ–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã–µ –º–æ–Ω–µ—Ç—ã (BTC, ETH, SOL)
2. –°—Ä–µ–¥–Ω–µ–ª–∏–∫–≤–∏–¥–Ω—ã–µ –º–æ–Ω–µ—Ç—ã (LINK, AVAX, DOGE)
3. –ù–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã–µ –º–æ–Ω–µ—Ç—ã (–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è)

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –º–æ–Ω–µ—Ç–µ
- –û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- Win Rate: +2-3%
- Profit Factor: +0.1-0.2
- Total PnL: +5-10%
- Sharpe Ratio: +0.1-0.2

### **–¶–µ–ª–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- Win Rate: +5-7%
- Profit Factor: +0.3-0.5
- Total PnL: +15-25%
- Sharpe Ratio: +0.3-0.5

## üìä –°–¢–†–£–ö–¢–£–†–ê –¢–ï–°–¢–û–í

### **–§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
```json
{
  "hypothesis": "H1.1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ high/low –¥–ª—è –≤—Ö–æ–¥–∞",
  "symbol": "SOLUSDT",
  "period": "2023-11-14 to 2024-11-14",
  "metrics": {
    "win_rate": 58.5,
    "profit_factor": 1.85,
    "total_pnl_pct": 62.3,
    "sharpe_ratio": 1.42,
    "sortino_ratio": 2.15,
    "max_drawdown": 12.5,
    "avg_win": 2.8,
    "avg_loss": -1.5
  },
  "comparison": {
    "win_rate_delta": +2.1,
    "profit_factor_delta": +0.15,
    "total_pnl_delta": +8.5
  }
}
```

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∏–ø–æ—Ç–µ–∑
2. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤—ã–π –±–µ–∫—Ç–µ—Å—Ç –Ω–∞ –≤—Å–µ—Ö –º–æ–Ω–µ—Ç–∞—Ö
3. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ—Ç–¥–µ–ª—å–Ω–æ
4. ‚è≥ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. ‚è≥ –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
6. ‚è≥ –í–Ω–µ–¥—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –≤ production
