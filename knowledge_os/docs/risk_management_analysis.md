# üõ°Ô∏è –ê–ù–ê–õ–ò–ó –°–ò–°–¢–ï–ú–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –†–ò–°–ö–ê–ú–ò

## ‚úÖ **–î–ê! –°–ò–°–¢–ï–ú–ê –£–ß–ò–¢–´–í–ê–ï–¢ –†–ò–°–ö–ò –ò –°–í–û–ë–û–î–ù–´–ô –ë–ê–õ–ê–ù–°**

### üìä **–ö–ê–ö –°–ò–°–¢–ï–ú–ê –£–ß–ò–¢–´–í–ê–ï–¢ –û–¢–ö–†–´–¢–´–ï/–ó–ê–ö–†–´–¢–´–ï –ü–û–ó–ò–¶–ò–ò:**

#### **1. –†–ê–°–ß–ï–¢ –î–û–°–¢–£–ü–ù–´–• –°–†–ï–î–°–¢–í** (`get_available_funds`)

```python
def get_available_funds(user_data: dict, trade_mode: str = "spot") -> float:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ —Å —É—á–µ—Ç–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π.
    """
    deposit = float(user_data.get("deposit", 0))
    if deposit <= 0:
        return 0.0

    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞
    total_used = 0.0
    positions = user_data.get("positions", []) + user_data.get("open_positions", [])

    for position in positions:
        if position.get("status") == "open":
            if trade_mode == "futures":
                # –î–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤ - –º–∞—Ä–∂–∞ (–∑–∞–ª–æ–≥–æ–≤—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞)
                total_used += position.get("margin", 0)
            else:
                # –î–ª—è —Å–ø–æ—Ç–∞ - –ø–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏
                total_used += position.get("qty", 0) * position.get("entry_price", 0)

    # –†–µ–∑–µ—Ä–≤ –∫–∞–ø–∏—Ç–∞–ª–∞
    reserve_pct = 0.15 if trade_mode == "spot" else 0.10
    reserve = deposit * reserve_pct

    available = deposit - total_used - reserve
    return max(0.0, available)
```

#### **2. –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–´–• –°–†–ï–î–°–¢–í –ü–ï–†–ï–î –ù–û–í–´–ú–ò –°–ò–ì–ù–ê–õ–ê–ú–ò**

```python
def get_available_funds_for_signal(user_data: dict, trade_mode: str = "spot") -> float:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Å —É—á–µ—Ç–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π.
    """
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞, –Ω–æ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
    available_funds = get_available_funds(user_data, trade_mode)

    # –ú–∏–Ω–∏–º—É–º 5% –¥–µ–ø–æ–∑–∏—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–º
    min_required = deposit * 0.05
    if available_funds < min_required:
        return 0.0

    return available_funds
```

### üéØ **–ó–ê–©–ò–¢–ù–´–ï –ú–ï–•–ê–ù–ò–ó–ú–´:**

#### **1. –†–ï–ó–ï–†–í–´ –ö–ê–ü–ò–¢–ê–õ–ê:**
- **–°–ø–æ—Ç**: 15% –¥–µ–ø–æ–∑–∏—Ç–∞ –≤—Å–µ–≥–¥–∞ —Å–≤–æ–±–æ–¥–Ω–æ
- **–§—å—é—á–µ—Ä—Å—ã**: 10% –¥–µ–ø–æ–∑–∏—Ç–∞ –≤—Å–µ–≥–¥–∞ —Å–≤–æ–±–æ–¥–Ω–æ

#### **2. –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ü–û –î–û–°–¢–£–ü–ù–´–ú –°–†–ï–î–°–¢–í–ê–ú:**
- **–ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã**: –ú–∞–∫—Å–∏–º—É–º 80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
- **DCA**: –ú–∞–∫—Å–∏–º—É–º 80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
- **–ú–∏–Ω–∏–º—É–º**: 5% –¥–µ–ø–æ–∑–∏—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–º

#### **3. –ü–†–û–í–ï–†–ö–ê –ú–ê–†–ñ–ò (–§–¨–Æ–ß–ï–†–°–´):**
```python
# –î–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–∞—Ä–∂–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞
min_margin_required = available_funds * 0.1  # –ú–∏–Ω–∏–º—É–º 10% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∫–∞–∫ –º–∞—Ä–∂–∞
if final_leverage > 1:
    effective_margin = available_funds / final_leverage
    if effective_margin < min_margin_required:
        final_leverage = max(1, int(available_funds / min_margin_required))
```

### üìà **–ê–î–ê–ü–¢–ò–í–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ò–°–ö–ê–ú–ò:**

#### **1. –ü–û –¢–ò–†–£ –î–ï–ü–û–ó–ò–¢–ê:**
- **$100-500**: –í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏ (8-15%), –Ω–æ —Å –∑–∞—â–∏—Ç–æ–π
- **$1000-5000**: –°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏ (2-10%)
- **$10000+**: –ù–∏–∑–∫–∏–µ —Ä–∏—Å–∫–∏ (2-6%)

#### **2. –ü–û –†–ï–ñ–ò–ú–£ –†–´–ù–ö–ê:**
- **Bull market**: +10% –∫ –ø–ª–µ—á—É, +5% –∫ —Ä–∞–∑–º–µ—Ä—É –≤—Ö–æ–¥–∞
- **Bear market**: -20% –∫ –ø–ª–µ—á—É, -30% –∫ —Ä–∞–∑–º–µ—Ä—É –≤—Ö–æ–¥–∞
- **Neutral**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

#### **3. –ü–û –í–û–õ–ê–¢–ò–õ–¨–ù–û–°–¢–ò:**
- **–í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å**: –°–Ω–∏–∂–µ–Ω–∏–µ –ø–ª–µ—á–∞ –∏ —Ä–∏—Å–∫–∞
- **–ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–ª–µ—á–∞ –∏ —Ä–∏—Å–∫–∞

### üõ°Ô∏è **–ü–†–ò–ú–ï–†–´ –†–ê–ë–û–¢–´ –°–ò–°–¢–ï–ú–´:**

#### **–ü–†–ò–ú–ï–† 1: –ú–ê–õ–´–ô –î–ï–ü–û–ó–ò–¢ ($500)**
```python
user_data = {
    "deposit": 500,
    "positions": [
        {"status": "open", "qty": 0.1, "entry_price": 50000, "margin": 0}
    ],
    "open_positions": []
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞: 425.0 (500 - 50 - 25 —Ä–µ–∑–µ—Ä–≤)
# –†–∏—Å–∫: 8.0% (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏)
# –ü–ª–µ—á–æ: 1x (—Å–ø–æ—Ç)
# –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 40.0 USD
```

#### **–ü–†–ò–ú–ï–† 2: –°–†–ï–î–ù–ò–ô –î–ï–ü–û–ó–ò–¢ ($5000)**
```python
user_data = {
    "deposit": 5000,
    "positions": [
        {"status": "open", "qty": 0.5, "entry_price": 3000, "margin": 150},
        {"status": "open", "qty": 1.0, "entry_price": 2500, "margin": 200}
    ],
    "open_positions": []
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞: 4150.0 (5000 - 350 - 500 —Ä–µ–∑–µ—Ä–≤)
# –†–∏—Å–∫: 4.0% (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π)
# –ü–ª–µ—á–æ: 6x (—Ñ—å—é—á–µ—Ä—Å—ã)
# –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 200.0 USD
```

### üéØ **–ö–õ–Æ–ß–ï–í–´–ï –ü–†–ò–ù–¶–ò–ü–´:**

#### **1. –ó–ê–©–ò–¢–ê –ö–ê–ü–ò–¢–ê–õ–ê:**
- ‚úÖ –†–µ–∑–µ—Ä–≤—ã –∫–∞–ø–∏—Ç–∞–ª–∞ (10-15%)
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º —Å—Ä–µ–¥—Å—Ç–≤–∞–º
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–≤–æ–±–æ–¥–Ω—ã–º —Å—Ä–µ–¥—Å—Ç–≤–∞–º

#### **2. –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨:**
- ‚úÖ –£—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–µ–ø–æ–∑–∏—Ç–∞
- ‚úÖ –£—á–µ—Ç —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞
- ‚úÖ –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –£—á–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π

#### **3. –ö–û–ù–¢–†–û–õ–¨ –†–ò–°–ö–û–í:**
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–ª–µ—á–∞
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã —Ä–∏—Å–∫–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–æ–π

## ‚úÖ **–í–´–í–û–î: –°–ò–°–¢–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –£–ß–ò–¢–´–í–ê–ï–¢ –†–ò–°–ö–ò!**

**–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
1. **–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞** —Å —É—á–µ—Ç–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
2. **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫** –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏
3. **–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤—ã –∫–∞–ø–∏—Ç–∞–ª–∞** –¥–ª—è –∑–∞—â–∏—Ç—ã
4. **–ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –ø–æ–¥ —É—Å–ª–æ–≤–∏—è —Ä—ã–Ω–∫–∞
5. **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ—Ç–æ—Ä–≥–æ–≤–ª—é** –∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ! üõ°Ô∏è**
