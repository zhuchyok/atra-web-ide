# –û–¢–ß–ï–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –° –ö–≠–®–ï–ú –û–¢–ö–†–´–¢–´–• –ü–û–ó–ò–¶–ò–ô

## ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –ò–°–ü–†–ê–í–õ–ï–ù–ê

**–ö—ç—à –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π –±–æ–ª—å—à–µ –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞!**

## üîß –í–ù–ï–°–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –£–±—Ä–∞–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–§–∞–π–ª**: `telegram_bot.py`
**–°—Ç—Ä–æ–∫–∞**: ~4370

```diff
async def run_telegram_bot():
    app = ApplicationBuilder().token(TOKEN).build()
    # –ó–∞–≥—Ä—É–∂–∞–µ–º user_data.json –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    load_user_data(app)
-   # –û—á–∏—â–∞–µ–º –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–¥ –∑–∞–ª–∏–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
-   await clear_open_positions_and_history(app)
+   # ‚úÖ –£–ë–†–ê–ù–û: –û—á–∏—Å—Ç–∫–∞ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ - —Ç–µ–ø–µ—Ä—å –ø–æ–∑–∏—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
+   # await clear_open_positions_and_history(app)
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏

**–§–∞–π–ª**: `telegram_bot.py`
**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: `clear_positions_manual_cmd()`

```python
async def clear_positions_manual_cmd(update, context):
    """–†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ–∑–∏—Ü–∏–π –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)"""
    user_id = update.effective_user.id
    user_data = context.application.user_data.get(user_id, {})

    old_count = len(user_data.get("open_positions", []))
    old_signals_count = len(user_data.get("accepted_signals", []))

    # –û—á–∏—â–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏ –∏ —Å–∏–≥–Ω–∞–ª—ã
    user_data["open_positions"] = []
    user_data["accepted_signals"] = []

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    save_user_data_to_file(user_id, user_data)

    await update.message.reply_text(
        f"‚úÖ –û—á–∏—â–µ–Ω–æ:\n"
        f"‚Ä¢ {old_count} –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π\n"
        f"‚Ä¢ {old_signals_count} –ø—Ä–∏–Ω—è—Ç—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤\n\n"
        f"–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª."
    )
```

### 3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞

**–§–∞–π–ª**: `telegram_bot.py`
**–°—Ç—Ä–æ–∫–∞**: ~4420

```python
# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø–æ–∑–∏—Ü–∏–π
app.add_handler(CommandHandler("clear_positions_manual", clear_positions_manual_cmd))
```

## üìä –ö–ê–ö –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢ –°–ò–°–¢–ï–ú–ê

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞:
1. ‚úÖ –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ `user_data.json`
2. ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
3. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ:
1. ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
2. ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏
3. ‚úÖ DCA –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤ —Ç–æ—á–µ–Ω

### –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞:
- **–ö–æ–º–∞–Ω–¥–∞**: `/clear_positions_manual`
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—á–∏—â–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∏ —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### ‚úÖ –†–µ—à–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:
- **–ü–æ—Ç–µ—Ä—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π** –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- **–ù–µ—Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤** –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–∑–∏—Ü–∏—è—Ö
- **–ü—Ä–æ–±–ª–µ–º—ã —Å DCA** –ª–æ–≥–∏–∫–æ–π
- **–ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤**

### ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è:
- **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** —Å–∏—Å—Ç–µ–º—ã –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
- **–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç** —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –¥–µ–ø–æ–∑–∏—Ç–∞
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** —Ä–∏—Å–∫–∞–º–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏**

## üîç –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏**:
   ```
   /accept BTCUSDT 50000 1 long 2.0
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏**:
   ```
   /myreport
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   python3 main.py
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**:
   ```
   /myreport
   ```

5. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—á–∏—Å—Ç–∏—Ç–µ**:
   ```
   /clear_positions_manual
   ```

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ **–ü–æ–∑–∏—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
- ‚úÖ **–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤** –∏ –±–∞–ª–∞–Ω—Å–∞
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ DCA**
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤**
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã**

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º:
- üîÑ **–£–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞** —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–∑–∏—Ü–∏–π
- üîÑ **–í–∞–ª–∏–¥–∞—Ü–∏—è** –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- üîÑ **–ë—ç–∫–∞–ø—ã** –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîÑ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–∑–∏—Ü–∏—è–º–∏

## üõ†Ô∏è –ö–û–ú–ê–ù–î–´ –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `/myreport` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π –∏ –±–∞–ª–∞–Ω—Å–∞
- `/positions` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∑–∏—Ü–∏—è—Ö
- `/clear_positions_manual` - —Ä—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ–∑–∏—Ü–∏–π
- `/clear_positions` - –æ—á–∏—Å—Ç–∫–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- `/status` - —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- `/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- `/last_signal` - –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–≥–Ω–∞–ª

## üìÅ –§–ê–ô–õ–´ –î–ê–ù–ù–´–•

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `user_data.json` - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–∑–∏—Ü–∏–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- `user_data_backups/` - —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- `logs/` - –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
```json
{
  "user_id": {
    "deposit": 1000.0,
    "open_positions": [...],
    "accepted_signals": [...],
    "trade_mode": "spot",
    "filter_mode": "enhanced_bollinger"
  }
}
```

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–î–∞—Ç–∞**: $(date)
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: ‚è±Ô∏è 10 –º–∏–Ω—É—Ç
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
