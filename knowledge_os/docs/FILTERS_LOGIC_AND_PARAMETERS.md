# üìä –õ–û–ì–ò–ö–ê –ò –ü–ê–†–ê–ú–ï–¢–†–´ –§–ò–õ–¨–¢–†–û–í RSI/MACD/Volume/BTC/EMA/BB

## üéØ –û–ë–ó–û–†

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ATRA –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ (–∏–Ω—Ç—Ä–∞–¥–µ–π).

---

## 1. üìà RSI –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

RSI (Relative Strength Index) —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –∞–∫—Ç–∏–≤ –≤ –∑–æ–Ω–µ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏, –∞ —Ç–∞–∫–∂–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞.

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ `src/core/config.py`):**
```python
INDICATOR_SETTINGS = {
    "rsi": {
        "period": 14,                    # –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ RSI
        "overbought": 72,                # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 70) - —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–≤—ã—à–µ–Ω–Ω—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
        "oversold": 28,                  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 30) - –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
        "divergence_lookback": 8,        # –ü–µ—Ä–∏–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
        "volatility_threshold": 8,       # –ü–æ—Ä–æ–≥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ RSI (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
        "use_adaptive_levels": True      # üÜï –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    }
}
```

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ enhanced_filters.py:**
```python
rsi_period = kwargs.get('rsi_period', 14)                    # –ü–µ—Ä–∏–æ–¥ RSI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 14)
rsi_oversold = kwargs.get('rsi_oversold', 28)               # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 30
rsi_overbought = kwargs.get('rsi_overbought', 72)            # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 70
divergence_lookback = kwargs.get('divergence_lookback', 8)   # –ü–µ—Ä–∏–æ–¥ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
volatility_threshold = kwargs.get('volatility_threshold', 8)  # –ü–æ—Ä–æ–≥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
use_adaptive_rsi = kwargs.get('use_adaptive_rsi', True)      # üÜï –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
```

#### **üÜï –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ RSI —É—Ä–æ–≤–Ω–∏ (–∏–∑ `src/filters/adaptive_rsi.py`):**

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —É—Ä–æ–≤–Ω–∏ RSI –ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞:

**–î–ª—è BTC/ETH (–º–µ–Ω–µ–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã):**
- –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (>8%): 75/25, –ø–µ—Ä–∏–æ–¥ 12
- –°—Ä–µ–¥–Ω—è—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (4-8%): 72/28, –ø–µ—Ä–∏–æ–¥ 14
- –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (<4%): 70/30, –ø–µ—Ä–∏–æ–¥ 16

**–î–ª—è –∞–ª—å—Ç–∫–æ–∏–Ω–æ–≤ (–±–æ–ª–µ–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã):**
- –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (>10%): 75/25, –ø–µ—Ä–∏–æ–¥ 12
- –°—Ä–µ–¥–Ω—è—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (5-10%): 72/28, –ø–µ—Ä–∏–æ–¥ 14
- –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (<5%): 70/30, –ø–µ—Ä–∏–æ–¥ 16

**–í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ (–∏–∑ `config.py`):**
```python
USE_ADAPTIVE_RSI_LEVELS = True  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
```

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ (–∏–∑ `config.py`):**

**–°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º (ENHANCED_BLOCKS_CONFIG):**
- `rsi_overbought_max`: 78  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 80)
- `rsi_oversold_min`: 22    # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 20)

**–ú—è–≥–∫–∏–π —Ä–µ–∂–∏–º (ENHANCED_STRATEGY_CONFIG):**
- `rsi_window`: 14
- `rsi_overbought`: 90       # –£–õ–¨–¢–†–ê-–ú–Ø–ì–ö–ò–ô (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –±—ç–∫—Ç–µ—Å—Ç–æ–≤)
- `rsi_oversold`: 10         # –£–õ–¨–¢–†–ê-–ú–Ø–ì–ö–ò–ô (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –±—ç–∫—Ç–µ—Å—Ç–æ–≤)
- `rsi_neutral_high`: 85     # –î–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- `rsi_neutral_low`: 15      # –î–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ä–µ–∂–∏–º–∞

### **üÜï –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:**

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —É—Ä–æ–≤–Ω–∏ RSI –ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ —É—Ä–æ–≤–Ω–∏ –¥–ª—è BTC/ETH (–º–µ–Ω–µ–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö –∞–ª—å—Ç–∫–æ–∏–Ω–æ–≤
- ‚úÖ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–µ–π —Ä—ã–Ω–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:**
- BTC —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é 3% ‚Üí —É—Ä–æ–≤–Ω–∏ 70/30, –ø–µ—Ä–∏–æ–¥ 16 (—Å—Ç—Ä–æ–≥–∏–µ)
- –ê–ª—å—Ç–∫–æ–∏–Ω —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é 12% ‚Üí —É—Ä–æ–≤–Ω–∏ 75/25, –ø–µ—Ä–∏–æ–¥ 12 (–º—è–≥–∫–∏–µ)

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

```185:281:src/filters/enhanced_filters.py
@track_filter_metrics(FilterType.RSI_FILTER)
def enhanced_rsi_filter(df, i: int, **kwargs) -> Tuple[bool, Optional[str]]:
    """
    –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä RSI —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
    
    Args:
        df: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏
        i: –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    
    Returns:
        Tuple[bool, Optional[str]]: (–ø—Ä–æ—à–µ–ª_—Ñ–∏–ª—å—Ç—Ä, –ø—Ä–∏—á–∏–Ω–∞_–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
    """
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if i < 14 or i >= len(df):
            return False, "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è RSI —Ñ–∏–ª—å—Ç—Ä–∞"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        rsi_period = kwargs.get('rsi_period', 14)
        rsi_oversold = kwargs.get('rsi_oversold', 30)
        rsi_overbought = kwargs.get('rsi_overbought', 70)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–ª–æ–Ω–∫–∏ RSI
        if 'rsi' not in df.columns:
            return False, "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ RSI"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è RSI
        current_rsi = df.iloc[i]['rsi']
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN
        if pd.isna(current_rsi):
            return False, "NaN –∑–Ω–∞—á–µ–Ω–∏–µ –≤ RSI"
        
        # –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        if current_rsi < rsi_oversold:
            return False, f"RSI –≤ –∑–æ–Ω–µ –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏: {current_rsi:.2f}"
        
        if current_rsi > rsi_overbought:
            return False, f"RSI –≤ –∑–æ–Ω–µ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏: {current_rsi:.2f}"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é
        divergence_lookback = kwargs.get('divergence_lookback', 8)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 5)
        if i > divergence_lookback:
            # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é
            recent_rsi = df.iloc[i-divergence_lookback:i+1]['rsi'].values
            recent_close = df.iloc[i-divergence_lookback:i+1]['close'].values
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–æ—Å—Ö–æ–¥—è—â—É—é –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é
            if (recent_close[-1] < recent_close[0] and recent_rsi[-1] > recent_rsi[0]):
                return False, "–í–æ—Å—Ö–æ–¥—è—â–∞—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è RSI"
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∏—Å—Ö–æ–¥—è—â—É—é –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é
            if (recent_close[-1] > recent_close[0] and recent_rsi[-1] < recent_rsi[0]):
                return False, "–ù–∏—Å—Ö–æ–¥—è—â–∞—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è RSI"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å RSI
        volatility_threshold = kwargs.get('volatility_threshold', 8)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 10)
        if i > 3:
            rsi_std = df.iloc[i-3:i+1]['rsi'].std()
            if rsi_std > volatility_threshold:  # –°–ª–∏—à–∫–æ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π RSI
                return False, f"–°–ª–∏—à–∫–æ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π RSI: std={rsi_std:.2f}"
        
        return True, None
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ RSI —Ñ–∏–ª—å—Ç—Ä–µ: {e}")
        return False, f"Exception: {str(e)}"
```

### **–£—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

1. **–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
   - RSI < `rsi_oversold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - RSI > `rsi_overbought` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 70) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

2. **–î–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è:**
   - –í–æ—Å—Ö–æ–¥—è—â–∞—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è (—Ü–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç, RSI —Ä–∞—Å—Ç–µ—Ç) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - –ù–∏—Å—Ö–æ–¥—è—â–∞—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è (—Ü–µ–Ω–∞ —Ä–∞—Å—Ç–µ—Ç, RSI –ø–∞–¥–∞–µ—Ç) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

3. **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å RSI:**
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ RSI –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Å–≤–µ—á–∏ > 10 ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–∞—Ö:**

–í `scripts/run_advanced_backtest.py`:
- **LONG:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥ –≤ –∑–æ–Ω—É –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏ (RSI < 30 –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π RSI >= 30)
- **SHORT:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥ –≤ –∑–æ–Ω—É –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏ (RSI > 70 –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π RSI <= 70)

---

## 2. üìä MACD –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

MACD —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –∏ —Å–∏–ª—É —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É MACD –ª–∏–Ω–∏–µ–π –∏ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π.

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ `src/core/config.py`):**
```python
INDICATOR_SETTINGS = {
    "macd": {
        "fast_period": 12,      # –ë—ã—Å—Ç—Ä–∞—è EMA
        "slow_period": 26,      # –ú–µ–¥–ª–µ–Ω–Ω–∞—è EMA
        "signal_period": 9     # –ü–µ—Ä–∏–æ–¥ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
    }
}
```

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

#### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π MACD —Ñ–∏–ª—å—Ç—Ä (–≤ `src/filters/enhanced_filters.py`):**

```263:345:src/filters/enhanced_filters.py
@track_filter_metrics(FilterType.MACD_FILTER)
def enhanced_macd_filter(df, i: int, **kwargs) -> Tuple[bool, Optional[str]]:
    """
    –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô MACD —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–µ–π –∫—Ä–∏–ø—Ç–æ
    
    Args:
        df: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏
        i: –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    
    Returns:
        Tuple[bool, Optional[str]]: (–ø—Ä–æ—à–µ–ª_—Ñ–∏–ª—å—Ç—Ä, –ø—Ä–∏—á–∏–Ω–∞_–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
    """
    try:
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        fast_period = kwargs.get('macd_fast_period', 8)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 12
        slow_period = kwargs.get('macd_slow_period', 21)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 26
        signal_period = kwargs.get('macd_signal_period', 5)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 9
        min_strength = kwargs.get('macd_min_strength', 0.003)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 0.005
        histogram_min = kwargs.get('macd_histogram_min', 0.001)  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
        trend_confirmation = kwargs.get('macd_trend_confirmation', 2)  # –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
        
        # üÜï –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –ü–†–û–í–ï–†–ö–ò:
        
        # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å–∏–ª—ã –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
        if abs(current_hist) < histogram_min:
            return False, f"–°–ª–∞–±–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ MACD: {current_hist:.4f}"
        
        # 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å–∏–ª—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è
        macd_strength = abs(current_hist) / (abs(current_macd) + 1e-9)
        if macd_strength < min_strength:
            return False, f"–°–ª–∞–±–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ MACD: {macd_strength:.4f}"
        
        # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
        if i >= trend_confirmation:
            # –¢—Ä–µ–±—É–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2 —Å–≤–µ—á–∏)
            prev_macd = df.iloc[i-1]['macd']
            prev_signal = df.iloc[i-1]['macd_signal']
            
            if (current_macd > current_signal and prev_macd <= prev_signal) or \
               (current_macd < current_signal and prev_macd >= prev_signal):
                return False, "MACD —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–µ—Ä–µ—Å–µ–∫ —Å–∏–≥–Ω–∞–ª - –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ"
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è)
        if i > 7:
            # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
            ...
```

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:**

**–î–ª—è LONG (–±—ã—á–∏–π —Å–∏–≥–Ω–∞–ª):**
- `macd > macd_signal` (MACD –≤—ã—à–µ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏)
- `macd_hist > 0` (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)
- `macd_strength > 0.003` (üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 0.005) - —Å–∏–ª–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è > 0.3%
- `abs(macd_hist) >= 0.001` (üÜï –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (üÜï 2 —Å–≤–µ—á–∏ –±–µ–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è)

**–î–ª—è SHORT (–º–µ–¥–≤–µ–∂–∏–π —Å–∏–≥–Ω–∞–ª):**
- `macd < macd_signal` (MACD –Ω–∏–∂–µ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏)
- `macd_hist < 0` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)
- `macd_strength > 0.003` (üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 0.005) - —Å–∏–ª–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è > 0.3%
- `abs(macd_hist) >= 0.001` (üÜï –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (üÜï 2 —Å–≤–µ—á–∏ –±–µ–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è)

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å–∏–ª—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è:**

```python
macd_strength = abs(current_hist) / (abs(current_macd) + 1e-9)
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü–æ—Ä–æ–≥ —Å–Ω–∏–∂–µ–Ω —Å 0.005 –¥–æ 0.003 (–º–µ–Ω—å—à–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å–∏–ª—ã –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2 —Å–≤–µ—á–∏)

---

## 3. üìä VOLUME –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

Volume —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –æ–±—ä–µ–º–∞ —Ç–æ—Ä–≥–æ–≤ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞ –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –æ–±—ä–µ–º—ã.

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ `src/core/config.py`):**
```python
INDICATOR_SETTINGS = {
    "volume_ratio": {
        "lookback": 15,          # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–µ–π (–±—ã–ª–æ 20)
        "threshold": 1.2,        # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ (–±—ã–ª–æ 1.5) - –º–µ–Ω—å—à–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
        "min_volume": 500,       # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –º–µ–ª–∫–∏—Ö –ø–∞—Ä (–±—ã–ª–æ 1000)
        "max_ratio": 8,          # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ (–±—ã–ª–æ 10) - –º–µ–Ω—å—à–µ –∞–Ω–æ–º–∞–ª–∏–π
        "spike_threshold": 5.0,  # üÜï –ü–æ—Ä–æ–≥ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Å–ø–ª–µ—Å–∫–æ–≤ –æ–±—ä–µ–º–∞
        "min_volume_usd": 10000  # üÜï –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –≤ USD –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
    }
}
```

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ enhanced_filters.py:**
```python
volume_ratio_threshold = kwargs.get('volume_ratio_threshold', 1.2)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 1.5
min_volume = kwargs.get('min_volume', 500)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 1000
max_ratio = kwargs.get('max_ratio', 8)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 10
spike_threshold = kwargs.get('spike_threshold', 5.0)  # üÜï –ü–æ—Ä–æ–≥ –≤—Å–ø–ª–µ—Å–∫–æ–≤
min_volume_usd = kwargs.get('min_volume_usd', 10000)  # üÜï –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –≤ USD
```

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

```246:309:src/filters/enhanced_filters.py
@track_filter_metrics(FilterType.VOLUME_FILTER)
def enhanced_volume_filter(df, i: int, **kwargs) -> Tuple[bool, Optional[str]]:
    """
    –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –æ–±—ä–µ–º–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
    
    Args:
        df: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏
        i: –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    
    Returns:
        Tuple[bool, Optional[str]]: (–ø—Ä–æ—à–µ–ª_—Ñ–∏–ª—å—Ç—Ä, –ø—Ä–∏—á–∏–Ω–∞_–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
    """
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if i < 20 or i >= len(df):
            return False, "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Volume —Ñ–∏–ª—å—Ç—Ä–∞"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        volume_ratio_threshold = kwargs.get('volume_ratio_threshold', 1.5)
        min_volume = kwargs.get('min_volume', 1000)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–ª–æ–Ω–æ–∫ –æ–±—ä–µ–º–∞
        if 'volume' not in df.columns:
            return False, "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ volume"
        
        if 'volume_ratio' not in df.columns:
            return False, "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ volume_ratio"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        current_volume = df.iloc[i]['volume']
        volume_ratio = df.iloc[i]['volume_ratio']
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN
        if pd.isna(current_volume) or pd.isna(volume_ratio):
            return False, "NaN –∑–Ω–∞—á–µ–Ω–∏—è –≤ Volume –¥–∞–Ω–Ω—ã—Ö"
        
        # –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–º–∞
        if current_volume < min_volume:
            return False, f"–°–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–π –æ–±—ä–µ–º: {current_volume:.0f}"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –æ–±—ä–µ–º–∞
        if volume_ratio < volume_ratio_threshold:
            return False, f"–ù–∏–∑–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—ä–µ–º–∞: {volume_ratio:.2f}"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º
        if volume_ratio > 10:  # –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º
            return False, f"–ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º: {volume_ratio:.2f}"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—ä–µ–º–∞
        if i > 5:
            recent_volumes = df.iloc[i-5:i+1]['volume'].values
            volume_std = np.std(recent_volumes)
            volume_mean = np.mean(recent_volumes)
            
            if volume_std > volume_mean * 2:  # –°–ª–∏—à–∫–æ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π –æ–±—ä–µ–º
                return False, f"–°–ª–∏—à–∫–æ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π –æ–±—ä–µ–º: std={volume_std:.0f}"
        
        return True, None
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ Volume —Ñ–∏–ª—å—Ç—Ä–µ: {e}")
        return False, f"Exception: {str(e)}"
```

### **–£—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

1. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º:**
   - `current_volume < min_volume` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

2. **–ù–∏–∑–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—ä–µ–º–∞:**
   - `volume_ratio < volume_ratio_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.5) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

3. **–ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º:**
   - `volume_ratio > 10` ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏)

4. **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—ä–µ–º–∞:**
   - `std(volume) > mean(volume) * 2` –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 —Å–≤–µ—á–µ–π ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–∞—Ö:**

–í `scripts/run_advanced_backtest.py`:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π `volume_ratio`: 1.5 (–∂–µ—Å—Ç–∫–∏–π —Ä–µ–∂–∏–º)
- –ï—Å–ª–∏ `volume_ratio < 0.8` ‚Üí –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- –ï—Å–ª–∏ `0.8 <= volume_ratio < 1.5` ‚Üí —Å–Ω–∏–∂–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏

---

## 4. üü¢üî¥ BTC TREND –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

BTC Trend —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Ç—Ä–µ–Ω–¥—É Bitcoin. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∞–ª—å—Ç–∫–æ–∏–Ω–æ–≤ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å BTC, –ø–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–¥–∞ BTC.

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ò–∑ `config.py`:**
```python
# BTC trend filter tuning
BTC_TREND_EMA_SOFT = 50        # EMA –¥–ª—è –º—è–≥–∫–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
BTC_TREND_EMA_STRICT = 200     # EMA –¥–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
BTC_TREND_LOOKBACK = 50        # –ü–µ—Ä–∏–æ–¥ lookback
BTC_TREND_MAX_DROP_PCT = 8.0   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
BTC_TREND_USE_MULTITF = True   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º
USE_BTC_TREND_FILTER = True    # –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
BTC_TREND_FILTER_SOFT = True   # –ú—è–≥–∫–∏–π –∏–ª–∏ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
```

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

#### **–ú—è–≥–∫–∏–π —Ñ–∏–ª—å—Ç—Ä (BTC_TREND_FILTER_SOFT = True):**
```python
def btc_trend_filter_soft(df_btc):
    """–ú—è–≥–∫–∏–π —Ñ–∏–ª—å—Ç—Ä —Ç—Ä–µ–Ω–¥–∞ –±–∏—Ç–∫–æ–∏–Ω–∞: —Ç–æ–ª—å–∫–æ —Ü–µ–Ω–∞ > EMA200"""
    df_btc["ema200"] = ta.trend.EMAIndicator(df_btc["close"], window=200).ema_indicator()
    df_btc["trend"] = df_btc["close"] > df_btc["ema200"]
    return df_btc["trend"]
```

#### **–°—Ç—Ä–æ–≥–∏–π —Ñ–∏–ª—å—Ç—Ä (BTC_TREND_FILTER_SOFT = False):**
```python
def btc_trend_filter(df_btc):
    """–°—Ç—Ä–æ–≥–∏–π —Ñ–∏–ª—å—Ç—Ä —Ç—Ä–µ–Ω–¥–∞ –±–∏—Ç–∫–æ–∏–Ω–∞: —Ü–µ–Ω–∞ > EMA200 –ò EMA25 —Ä–∞—Å—Ç—ë—Ç"""
    df_btc["ema200"] = ta.trend.EMAIndicator(df_btc["close"], window=200).ema_indicator()
    df_btc["ema25"] = ta.trend.EMAIndicator(df_btc["close"], window=25).ema_indicator()
    df_btc["trend"] = (df_btc["close"] > df_btc["ema200"]) & (df_btc["ema25"].diff() > 0)
    return df_btc["trend"]
```

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**

```23:108:src/signals/filters.py
async def check_btc_alignment(symbol: str, signal_type: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Ç—Ä–µ–Ω–¥—É BTC
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª
        signal_type: –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ (BUY/SELL)
        
    Returns:
        True –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–Ω–¥—É BTC, False –µ—Å–ª–∏ –Ω–µ—Ç
    """
    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ BTC —á–µ—Ä–µ–∑ –≥–∏–±—Ä–∏–¥–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
        btc_df = await HYBRID_DATA_MANAGER.get_smart_data("BTCUSDT", "ohlc")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
        if btc_df is None:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö BTC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (None)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –ï—Å–ª–∏ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ DataFrame
        if isinstance(btc_df, list):
            if len(btc_df) == 0:
                logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ BTC - –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ç—Ä–µ–Ω–¥–∞", symbol)
                return True

            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –≤ DataFrame
            try:
                btc_df = pd.DataFrame(btc_df)
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º timestamp –≤ datetime –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if 'timestamp' in btc_df.columns:
                    btc_df['timestamp'] = pd.to_datetime(btc_df['timestamp'], unit='ms', errors='coerce')
                    btc_df.set_index('timestamp', inplace=True)
                logger.debug("‚úÖ [%s] –î–∞–Ω–Ω—ã–µ BTC –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ DataFrame (%d —Å—Ç—Ä–æ–∫)", symbol, len(btc_df))
            except Exception as e:
                logger.warning("‚ö†Ô∏è [%s] –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ BTC –≤ DataFrame: %s", symbol, e)
                return True

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ DataFrame –∏ –æ–Ω –Ω–µ –ø—É—Å—Ç–æ–π
        if not isinstance(btc_df, pd.DataFrame):
            logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ BTC –Ω–µ —è–≤–ª—è—é—Ç—Å—è DataFrame (—Ç–∏–ø: %s), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º", symbol, type(btc_df))
            return True

        if btc_df.empty or len(btc_df) < 50:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö BTC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (–ø—É—Å—Ç–æ –∏–ª–∏ < 50 —Å—Ç—Ä–æ–∫)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥ BTC –ø–æ EMA
        btc_ema_fast = btc_df['ema_fast'].iloc[-1] if 'ema_fast' in btc_df.columns else btc_df['close'].ewm(span=12).mean().iloc[-1]
        btc_ema_slow = btc_df['ema_slow'].iloc[-1] if 'ema_slow' in btc_df.columns else btc_df['close'].ewm(span=26).mean().iloc[-1]
        btc_trend = "BUY" if btc_ema_fast > btc_ema_slow else "SELL"

        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ BTC
        if signal_type == "BUY" and btc_trend == "SELL":
            logger.warning("üö´ [BTC FILTER] %s: LONG –ø—Ä–æ—Ç–∏–≤ BTC —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, btc_trend)
            return False

        if signal_type == "SELL" and btc_trend == "BUY":
            logger.warning("üö´ [BTC FILTER] %s: SHORT –ø—Ä–æ—Ç–∏–≤ BTC —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, btc_trend)
            return False

        logger.debug("‚úÖ [BTC FILTER] %s: —Ç—Ä–µ–Ω–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å BTC (%s)", symbol, btc_trend)
        return True
    except Exception as e:
        logger.debug("‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ BTC —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è %s: %s (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º)", symbol, e)
        return True
```

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

1. **LONG —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ BTC –≤ —Å–∏–ª—å–Ω–æ–º –º–µ–¥–≤–µ–∂—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`btc_trend == "SELL"` –∏ `trend_strength > 0.01`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - –ï—Å–ª–∏ BTC –≤ —Å–ª–∞–±–æ–º –º–µ–¥–≤–µ–∂—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`trend_strength < 0.01`) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º (–±–æ–∫–æ–≤–æ–π —Ä—ã–Ω–æ–∫)

2. **SHORT —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ BTC –≤ —Å–∏–ª—å–Ω–æ–º –±—ã—á—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`btc_trend == "BUY"` –∏ `trend_strength > 0.01`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - –ï—Å–ª–∏ BTC –≤ —Å–ª–∞–±–æ–º –±—ã—á—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`trend_strength < 0.01`) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º (–±–æ–∫–æ–≤–æ–π —Ä—ã–Ω–æ–∫)

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞:**

- **–ë—ã—á–∏–π —Ç—Ä–µ–Ω–¥:** `ema_fast > ema_slow` (üÜï EMA10 > EMA22, –±—ã–ª–æ EMA12 > EMA26)
- **–ú–µ–¥–≤–µ–∂–∏–π —Ç—Ä–µ–Ω–¥:** `ema_fast < ema_slow` (üÜï EMA10 < EMA22, –±—ã–ª–æ EMA12 < EMA26)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞:** `abs(ema_fast - ema_slow) / ema_slow >= 0.002` (üÜï –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã—Ö –ø—Ä–æ—Ç–∏–≤–æ—Ç—Ä–µ–Ω–¥–æ–≤:** –ï—Å–ª–∏ —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ > 1%, –±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ—Ç–∏–≤–æ—Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ –±–æ–∫–æ–≤–∏–∫–µ:** –ï—Å–ª–∏ —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ < 0.2%, —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ—Ä–≥–æ–≤–ª—é (–±–æ–∫–æ–≤–æ–π —Ä—ã–Ω–æ–∫)

---

## 5. üìà EMA –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

EMA —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –ø–æ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —Å–∫–æ–ª—å–∑—è—â–∏–º —Å—Ä–µ–¥–Ω–∏–º –∏ –ø–æ–∑–∏—Ü–∏—é —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∏—Ö.

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ `src/core/config.py`):**
```python
INDICATOR_SETTINGS = {
    "ema": {
        "fast": 6,               # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–µ–π (–±—ã–ª–æ 7) - –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π
        "medium": 14,            # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–µ–π (–±—ã–ª–æ 25) - –Ω–æ–≤–∞—è —Å—Ä–µ–¥–Ω—è—è EMA
        "slow": 22,              # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–µ–π (–±—ã–ª–æ 25) - –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç
        "trend": 200,            # –û—Å—Ç–∞–≤–∏—Ç—å
        "min_distance": 0.008,   # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ (–±—ã–ª–æ 0.01) - –º–µ–Ω—å—à–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ
        "trend_strength": 0.003  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞
    }
}
```

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ enhanced_filters.py:**
```python
ema_fast = kwargs.get('ema_fast', 6)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 7
ema_medium = kwargs.get('ema_medium', 14)  # üÜï –ù–æ–≤–∞—è —Å—Ä–µ–¥–Ω—è—è EMA
ema_slow = kwargs.get('ema_slow', 22)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 25
min_distance = kwargs.get('ema_min_distance', 0.008)  # üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –±—ã–ª–æ 0.01
trend_strength = kwargs.get('ema_trend_strength', 0.003)  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞
```

### **üÜï –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

```172:260:src/filters/enhanced_filters.py
@track_filter_metrics(FilterType.EMA_FILTER)
def enhanced_ema_filter(df, i: int, **kwargs) -> Tuple[bool, Optional[str]]:
    """
    –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä EMA —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
    
    Args:
        df: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏
        i: –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    
    Returns:
        Tuple[bool, Optional[str]]: (–ø—Ä–æ—à–µ–ª_—Ñ–∏–ª—å—Ç—Ä, –ø—Ä–∏—á–∏–Ω–∞_–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
    """
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if i < 25 or i >= len(df):
            return False, "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è EMA —Ñ–∏–ª—å—Ç—Ä–∞"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        ema_short = kwargs.get('ema_short', 7)
        ema_long = kwargs.get('ema_long', 25)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–ª–æ–Ω–æ–∫ EMA
        required_columns = ['ema7', 'ema25']
        if not all(col in df.columns for col in required_columns):
            return False, "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏ EMA"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        current_close = df.iloc[i]['close']
        ema7 = df.iloc[i]['ema7']
        ema25 = df.iloc[i]['ema25']
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN
        if pd.isna(current_close) or pd.isna(ema7) or pd.isna(ema25):
            return False, "NaN –∑–Ω–∞—á–µ–Ω–∏—è –≤ EMA –¥–∞–Ω–Ω—ã—Ö"
        
        # –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è EMA
        if i > 0:
            prev_ema7 = df.iloc[i-1]['ema7']
            prev_ema25 = df.iloc[i-1]['ema25']
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
            if (ema7 > ema25 and prev_ema7 <= prev_ema25) or (ema7 < ema25 and prev_ema7 >= prev_ema25):
                return False, "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ EMA - –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É EMA
        ema_distance = abs(ema7 - ema25) / ema25
        if ema_distance < 0.01:  # –°–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ
            return False, "EMA —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞
        if ema7 > ema25:
            # –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥
            if current_close < ema7 * 0.98:  # –¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç EMA7
                return False, "–¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç EMA7 –≤ –≤–æ—Å—Ö–æ–¥—è—â–µ–º —Ç—Ä–µ–Ω–¥–µ"
        else:
            # –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥
            if current_close > ema7 * 1.02:  # –¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç EMA7
                return False, "–¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç EMA7 –≤ –Ω–∏—Å—Ö–æ–¥—è—â–µ–º —Ç—Ä–µ–Ω–¥–µ"
        
        return True, None
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ EMA —Ñ–∏–ª—å—Ç—Ä–µ: {e}")
        return False, f"Exception: {str(e)}"
```

### **–£—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

1. **–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ EMA:**
   - –ï—Å–ª–∏ EMA7 –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç EMA25 –≤ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª)

2. **–°–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ:**
   - `abs(ema7 - ema25) / ema25 < 0.01` (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ < 1%) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

3. **–¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç EMA:**
   - –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥: `close < ema7 * 0.98` (—Ü–µ–Ω–∞ –Ω–∏–∂–µ EMA7 –Ω–∞ > 2%) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥: `close > ema7 * 1.02` (—Ü–µ–Ω–∞ –≤—ã—à–µ EMA7 –Ω–∞ > 2%) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–∞—Ö:**

–í `scripts/run_advanced_backtest.py`:
- **LONG:** `ema_fast > ema_slow` ‚Üí —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å +15
- **SHORT:** `ema_fast < ema_slow` ‚Üí —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å +15

---

## 6. üìä BOLLINGER BANDS –§–ò–õ–¨–¢–†

### **–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞:**

Bollinger Bands —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞ –∏ —à–∏—Ä–∏–Ω—É –ø–æ–ª–æ—Å (–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å).

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ `src/core/config.py`):**
```python
INDICATOR_SETTINGS = {
    "bollinger_bands": {
        "period": 20,      # –ü–µ—Ä–∏–æ–¥ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ SMA
        "std_dev": 2       # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π
    }
}
```

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ enhanced_filters.py:**
```python
bb_window = kwargs.get('bb_window', 20)      # –ü–µ—Ä–∏–æ–¥ BB
bb_std = kwargs.get('bb_std', 2.0)          # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
bb_epsilon = kwargs.get('bb_epsilon', 0.02)  # –î–æ–ø—É—Å–∫ –¥–ª—è –≥—Ä–∞–Ω–∏—Ü (2%)
```

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

```44:106:src/filters/enhanced_filters.py
@track_filter_metrics(FilterType.BB_FILTER)
def enhanced_bb_filter(df, i: int, **kwargs) -> Tuple[bool, Optional[str]]:
    """
    –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä Bollinger Bands —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
    
    Args:
        df: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏
        i: –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    
    Returns:
        Tuple[bool, Optional[str]]: (–ø—Ä–æ—à–µ–ª_—Ñ–∏–ª—å—Ç—Ä, –ø—Ä–∏—á–∏–Ω–∞_–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
    """
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if i < 20 or i >= len(df):
            return False, "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è BB —Ñ–∏–ª—å—Ç—Ä–∞"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        bb_window = kwargs.get('bb_window', 20)
        bb_std = kwargs.get('bb_std', 2.0)
        bb_epsilon = kwargs.get('bb_epsilon', 0.02)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–ª–æ–Ω–æ–∫ BB
        required_columns = ['bb_upper', 'bb_lower', 'bb_mid']
        if not all(col in df.columns for col in required_columns):
            return False, "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏ Bollinger Bands"
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        current_close = df.iloc[i]['close']
        bb_upper = df.iloc[i]['bb_upper']
        bb_lower = df.iloc[i]['bb_lower']
        bb_mid = df.iloc[i]['bb_mid']
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN
        if pd.isna(current_close) or pd.isna(bb_upper) or pd.isna(bb_lower) or pd.isna(bb_mid):
            return False, "NaN –∑–Ω–∞—á–µ–Ω–∏—è –≤ BB –¥–∞–Ω–Ω—ã—Ö"
        
        # –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        bb_width = (bb_upper - bb_lower) / bb_mid
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ä–∏–Ω—ã –ø–æ–ª–æ—Å
        if bb_width < 0.02:  # –°–ª–∏—à–∫–æ–º —É–∑–∫–∏–µ –ø–æ–ª–æ—Å—ã
            return False, "–°–ª–∏—à–∫–æ–º —É–∑–∫–∏–µ –ø–æ–ª–æ—Å—ã –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å
        if current_close > bb_upper * (1 + bb_epsilon):
            return False, "–¶–µ–Ω–∞ –≤—ã—à–µ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ—Å—ã BB"
        
        if current_close < bb_lower * (1 - bb_epsilon):
            return False, "–¶–µ–Ω–∞ –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã BB"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞
        if i > 0:
            prev_close = df.iloc[i-1]['close']
            if abs(current_close - prev_close) / prev_close > 0.05:  # –°–ª–∏—à–∫–æ–º —Ä–µ–∑–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
                return False, "–°–ª–∏—à–∫–æ–º —Ä–µ–∑–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã"
        
        return True, None
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ BB —Ñ–∏–ª—å—Ç—Ä–µ: {e}")
        return False, f"Exception: {str(e)}"
```

### **–£—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

1. **–°–ª–∏—à–∫–æ–º —É–∑–∫–∏–µ –ø–æ–ª–æ—Å—ã:**
   - `bb_width < 0.02` (—à–∏—Ä–∏–Ω–∞ < 2% –æ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–Ω–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)

2. **–¶–µ–Ω–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ø–æ–ª–æ—Å:**
   - `close > bb_upper * 1.02` ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
   - `close < bb_lower * 0.98` ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

3. **–†–µ–∑–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã:**
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã > 5% –∑–∞ –æ–¥–Ω—É —Å–≤–µ—á—É ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–∞—Ö:**

–í `scripts/run_advanced_backtest.py`:

```588:611:scripts/run_advanced_backtest.py
            # 6. üÜï –£–õ–£–ß–®–ï–ù–ù–´–ô Bollinger Bands —Ñ–∏–ª—å—Ç—Ä (–±–ª–æ–∫–∏—Ä—É—é—â–∏–π, –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ)
            bb_position = (row["close"] - row["bb_lower"]) / (row["bb_upper"] - row["bb_lower"])
            bb_width = (row["bb_upper"] - row["bb_lower"]) / row.get("bb_middle", row["close"])
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ä–∏–Ω—ã –ø–æ–ª–æ—Å (—Å–ª–∏—à–∫–æ–º —É–∑–∫–∏–µ = –ø–ª–æ—Ö–æ)
            if bb_width < 0.02:
                logger.debug("üö´ [BB] %s: —Å–ª–∏—à–∫–æ–º —É–∑–∫–∏–µ –ø–æ–ª–æ—Å—ã (%.4f%%), –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, bb_width * 100)
                return None
            
            # –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∏–ª—å—Ç—Ä –¥–ª—è LONG: —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –Ω–∏–∂–Ω–∏—Ö 20% BB
            if direction == "LONG":
                if bb_position > 0.2:  # –ù–µ –≤ –Ω–∏–∂–Ω–∏—Ö 20%
                    logger.debug("üö´ [BB] %s LONG: —Ü–µ–Ω–∞ –Ω–µ –≤ –Ω–∏–∂–Ω–∏—Ö 20%% BB (–ø–æ–∑–∏—Ü–∏—è=%.2f), –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, bb_position)
                    return None
                confidence += 15  # –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 10
                filters_passed.append("bb_oversold")
            
            # –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∏–ª—å—Ç—Ä –¥–ª—è SHORT: —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –≤–µ—Ä—Ö–Ω–∏—Ö 20% BB
            elif direction == "SHORT":
                if bb_position < 0.8:  # –ù–µ –≤ –≤–µ—Ä—Ö–Ω–∏—Ö 20%
                    logger.debug("üö´ [BB] %s SHORT: —Ü–µ–Ω–∞ –Ω–µ –≤ –≤–µ—Ä—Ö–Ω–∏—Ö 20%% BB (–ø–æ–∑–∏—Ü–∏—è=%.2f), –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, bb_position)
                    return None
                confidence += 15  # –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 10
                filters_passed.append("bb_overbought")
```

**–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è:**
- **LONG:** –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –Ω–∏–∂–Ω–∏—Ö 20% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ BB (`bb_position <= 0.2`)
- **SHORT:** –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –≤–µ—Ä—Ö–Ω–∏—Ö 20% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ BB (`bb_position >= 0.8`)

---

## üìã –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–ê–†–ê–ú–ï–¢–†–û–í

| –§–∏–ª—å—Ç—Ä | –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –î–∏–∞–ø–∞–∑–æ–Ω |
|--------|----------|----------------------|----------|
| **RSI** | period | 14 | 10-20 |
| | oversold | 28 | 10-30 |
| | overbought | 72 | 70-90 |
| | divergence_lookback | 8 | 5-12 |
| | volatility_threshold | 8 | 5-12 |
| | use_adaptive_levels | True | - |
| **MACD** | fast_period | 8 | 8-15 |
| | slow_period | 21 | 20-30 |
| | signal_period | 5 | 5-12 |
| | min_strength | 0.003 (0.3%) | 0.002-0.01 |
| | histogram_min | 0.001 | 0.0005-0.002 |
| | trend_confirmation | 2 | 1-3 |
| **Volume** | ratio_threshold | 1.2 | 1.0-2.0 |
| | min_volume | 500 | 500-5000 |
| | max_ratio | 8 | 5-20 |
| | lookback | 15 | 10-25 |
| | spike_threshold | 5.0 | 3.0-10.0 |
| | min_volume_usd | 10000 | 5000-50000 |
| **BTC Trend** | ema_fast | 10 | 8-15 |
| | ema_slow | 22 | 20-30 |
| | min_trend_strength | 0.002 | 0.001-0.005 |
| | enabled | True | - |
| **ETH Trend** | ema_fast | 10 | 8-15 |
| | ema_slow | 22 | 20-30 |
| | min_trend_strength | 0.002 | 0.001-0.005 |
| | enabled | True | - |
| **SOL Trend** | ema_fast | 10 | 8-15 |
| | ema_slow | 22 | 20-30 |
| | min_trend_strength | 0.002 | 0.001-0.005 |
| | enabled | True | - |
| **EMA** | fast | 6 | 5-10 |
| | medium | 14 | 10-20 |
| | slow | 22 | 20-30 |
| | min_distance | 0.008 (0.8%) | 0.005-0.02 |
| | trend_strength | 0.003 | 0.001-0.005 |
| **BB** | period | 18 | 15-25 |
| | std_dev | 1.8 | 1.5-2.5 |
| | min_width | 0.015 (1.5%) | 0.01-0.05 |
| | position_long | ‚â§ 0.15 (15%) | 0.1-0.3 |
| | position_short | ‚â• 0.85 (85%) | 0.7-0.9 |
| | squeeze_threshold | 0.012 | 0.01-0.02 |

---

## üîÑ –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ï –§–ò–õ–¨–¢–†–û–í

### **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**

1. **RSI Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
2. **MACD Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞
3. **Volume Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–º–∞
4. **BTC Trend Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–Ω–¥—É BTC (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)
5. **ETH Trend Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–Ω–¥—É ETH (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)
6. **SOL Trend Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–Ω–¥—É SOL (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)
7. **EMA Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞ –∞–∫—Ç–∏–≤–∞
8. **BB Filter** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

–í `scripts/run_advanced_backtest.py` —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º **3 –∏–∑ 6 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
- RSI (oversold/overbought)
- MACD (bullish/bearish)
- Volume (high_volume)
- BTC (btc_aligned)
- ETH (eth_aligned) - –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã
- SOL (sol_aligned) - –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã

---

## 7. üîµüü£ ETH –ò SOL –¢–†–ï–ù–î –§–ò–õ–¨–¢–†–´

### **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**

‚úÖ **–§–∏–ª—å—Ç—Ä—ã ETH –∏ SOL —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω—ã!** (–∫–∞–∫ BTC —Ñ–∏–ª—å—Ç—Ä)

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### **–ò–∑ `config.py`:**
```python
# ETH trend filter tuning
USE_ETH_TREND_FILTER = True    # –í—Å–µ–≥–¥–∞ True (—Ñ–∏–ª—å—Ç—Ä –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)
ETH_TREND_FILTER_SOFT = True   # –ú—è–≥–∫–∏–π –∏–ª–∏ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
ETH_TREND_EMA_SOFT = 50        # EMA –¥–ª—è –º—è–≥–∫–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
ETH_TREND_EMA_STRICT = 200     # EMA –¥–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞

# SOL trend filter tuning
USE_SOL_TREND_FILTER = True    # –í—Å–µ–≥–¥–∞ True (—Ñ–∏–ª—å—Ç—Ä –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)
SOL_TREND_FILTER_SOFT = True   # –ú—è–≥–∫–∏–π –∏–ª–∏ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
SOL_TREND_EMA_SOFT = 50        # EMA –¥–ª—è –º—è–≥–∫–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
SOL_TREND_EMA_STRICT = 200     # EMA –¥–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä—ã ETH –∏ SOL —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω—ã (–∫–∞–∫ BTC), –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `USE_ETH_TREND_FILTER` –∏ `USE_SOL_TREND_FILTER` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

–§–∏–ª—å—Ç—Ä—ã ETH –∏ SOL —Ä–∞–±–æ—Ç–∞—é—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ BTC —Ñ–∏–ª—å—Ç—Ä—É:

```91:156:src/signals/filters.py
async def check_eth_alignment(symbol: str, signal_type: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Ç—Ä–µ–Ω–¥—É ETH
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª
        signal_type: –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ (BUY/SELL)
        
    Returns:
        True –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–Ω–¥—É ETH, False –µ—Å–ª–∏ –Ω–µ—Ç
    """
    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ ETH —á–µ—Ä–µ–∑ –≥–∏–±—Ä–∏–¥–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
        eth_df = await HYBRID_DATA_MANAGER.get_smart_data("ETHUSDT", "ohlc")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
        if eth_df is None:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ETH –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (None)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –ï—Å–ª–∏ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ DataFrame
        if isinstance(eth_df, list):
            if len(eth_df) == 0:
                logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ ETH - –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ç—Ä–µ–Ω–¥–∞", symbol)
                return True

            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –≤ DataFrame
            try:
                eth_df = pd.DataFrame(eth_df)
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º timestamp –≤ datetime –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if 'timestamp' in eth_df.columns:
                    eth_df['timestamp'] = pd.to_datetime(eth_df['timestamp'], unit='ms', errors='coerce')
                    eth_df.set_index('timestamp', inplace=True)
                logger.debug("‚úÖ [%s] –î–∞–Ω–Ω—ã–µ ETH –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ DataFrame (%d —Å—Ç—Ä–æ–∫)", symbol, len(eth_df))
            except Exception as e:
                logger.warning("‚ö†Ô∏è [%s] –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ ETH –≤ DataFrame: %s", symbol, e)
                return True

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ DataFrame –∏ –æ–Ω –Ω–µ –ø—É—Å—Ç–æ–π
        if not isinstance(eth_df, pd.DataFrame):
            logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ ETH –Ω–µ —è–≤–ª—è—é—Ç—Å—è DataFrame (—Ç–∏–ø: %s), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º", symbol, type(eth_df))
            return True

        if eth_df.empty or len(eth_df) < 50:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ETH –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (–ø—É—Å—Ç–æ –∏–ª–∏ < 50 —Å—Ç—Ä–æ–∫)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥ ETH –ø–æ EMA
        eth_ema_fast = eth_df['ema_fast'].iloc[-1] if 'ema_fast' in eth_df.columns else eth_df['close'].ewm(span=12).mean().iloc[-1]
        eth_ema_slow = eth_df['ema_slow'].iloc[-1] if 'ema_slow' in eth_df.columns else eth_df['close'].ewm(span=26).mean().iloc[-1]
        eth_trend = "BUY" if eth_ema_fast > eth_ema_slow else "SELL"

        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ ETH
        if signal_type == "BUY" and eth_trend == "SELL":
            logger.warning("üö´ [ETH FILTER] %s: LONG –ø—Ä–æ—Ç–∏–≤ ETH —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, eth_trend)
            return False

        if signal_type == "SELL" and eth_trend == "BUY":
            logger.warning("üö´ [ETH FILTER] %s: SHORT –ø—Ä–æ—Ç–∏–≤ ETH —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, eth_trend)
            return False

        logger.debug("‚úÖ [ETH FILTER] %s: —Ç—Ä–µ–Ω–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ETH (%s)", symbol, eth_trend)
        return True
    except Exception as e:
        logger.debug("‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ ETH —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è %s: %s (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º)", symbol, e)
        return True
```

```159:224:src/signals/filters.py
async def check_sol_alignment(symbol: str, signal_type: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Ç—Ä–µ–Ω–¥—É SOL
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª
        signal_type: –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ (BUY/SELL)
        
    Returns:
        True –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–Ω–¥—É SOL, False –µ—Å–ª–∏ –Ω–µ—Ç
    """
    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ SOL —á–µ—Ä–µ–∑ –≥–∏–±—Ä–∏–¥–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
        sol_df = await HYBRID_DATA_MANAGER.get_smart_data("SOLUSDT", "ohlc")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
        if sol_df is None:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö SOL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (None)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –ï—Å–ª–∏ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ DataFrame
        if isinstance(sol_df, list):
            if len(sol_df) == 0:
                logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ SOL - –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ç—Ä–µ–Ω–¥–∞", symbol)
                return True

            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –≤ DataFrame
            try:
                sol_df = pd.DataFrame(sol_df)
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º timestamp –≤ datetime –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if 'timestamp' in sol_df.columns:
                    sol_df['timestamp'] = pd.to_datetime(sol_df['timestamp'], unit='ms', errors='coerce')
                    sol_df.set_index('timestamp', inplace=True)
                logger.debug("‚úÖ [%s] –î–∞–Ω–Ω—ã–µ SOL –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ DataFrame (%d —Å—Ç—Ä–æ–∫)", symbol, len(sol_df))
            except Exception as e:
                logger.warning("‚ö†Ô∏è [%s] –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ SOL –≤ DataFrame: %s", symbol, e)
                return True

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ DataFrame –∏ –æ–Ω –Ω–µ –ø—É—Å—Ç–æ–π
        if not isinstance(sol_df, pd.DataFrame):
            logger.debug("‚ö†Ô∏è [%s] –î–∞–Ω–Ω—ã–µ SOL –Ω–µ —è–≤–ª—è—é—Ç—Å—è DataFrame (—Ç–∏–ø: %s), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º", symbol, type(sol_df))
            return True

        if sol_df.empty or len(sol_df) < 50:
            logger.debug("‚ö†Ô∏è [%s] –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö SOL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–∞ (–ø—É—Å—Ç–æ –∏–ª–∏ < 50 —Å—Ç—Ä–æ–∫)", symbol)
            return True  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥ SOL –ø–æ EMA
        sol_ema_fast = sol_df['ema_fast'].iloc[-1] if 'ema_fast' in sol_df.columns else sol_df['close'].ewm(span=12).mean().iloc[-1]
        sol_ema_slow = sol_df['ema_slow'].iloc[-1] if 'ema_slow' in sol_df.columns else sol_df['close'].ewm(span=26).mean().iloc[-1]
        sol_trend = "BUY" if sol_ema_fast > sol_ema_slow else "SELL"

        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ SOL
        if signal_type == "BUY" and sol_trend == "SELL":
            logger.warning("üö´ [SOL FILTER] %s: LONG –ø—Ä–æ—Ç–∏–≤ SOL —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, sol_trend)
            return False

        if signal_type == "SELL" and sol_trend == "BUY":
            logger.warning("üö´ [SOL FILTER] %s: SHORT –ø—Ä–æ—Ç–∏–≤ SOL —Ç—Ä–µ–Ω–¥–∞ (%s) - –±–ª–æ–∫–∏—Ä—É–µ–º", symbol, sol_trend)
            return False

        logger.debug("‚úÖ [SOL FILTER] %s: —Ç—Ä–µ–Ω–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å SOL (%s)", symbol, sol_trend)
        return True
    except Exception as e:
        logger.debug("‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ SOL —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è %s: %s (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º)", symbol, e)
        return True
```

### **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ signal_live.py:**

–í `signal_live.py` —Å–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `check_all_trend_alignments()`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Ç—Ä–∏ —Ç—Ä–µ–Ω–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:

```3940:3957:signal_live.py
async def check_all_trend_alignments(symbol: str, signal_type: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Ç—Ä–µ–Ω–¥–∞–º BTC, ETH –∏ SOL
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª
        signal_type: –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ (BUY/SELL)
        
    Returns:
        True –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–Ω–¥–∞–º, False –µ—Å–ª–∏ –Ω–µ—Ç
    """
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ BTC (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞)
    if not await check_btc_alignment(symbol, signal_type):
        return False
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ ETH (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞)
    if not await check_eth_alignment(symbol, signal_type):
        return False
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ SOL (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞)
    if not await check_sol_alignment(symbol, signal_type):
        return False
    
    return True
```

### **–£—Å–ª–æ–≤–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

**–î–ª—è ETH:**
1. **LONG —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ ETH –≤ –º–µ–¥–≤–µ–∂—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`eth_trend == "SELL"`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

2. **SHORT —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ ETH –≤ –±—ã—á—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`eth_trend == "BUY"`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

**–î–ª—è SOL:**
1. **LONG —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ SOL –≤ –º–µ–¥–≤–µ–∂—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`sol_trend == "SELL"`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

2. **SHORT —Å–∏–≥–Ω–∞–ª:**
   - –ï—Å–ª–∏ SOL –≤ –±—ã—á—å–µ–º —Ç—Ä–µ–Ω–¥–µ (`sol_trend == "BUY"`) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞:**

- **–ë—ã—á–∏–π —Ç—Ä–µ–Ω–¥:** `ema_fast > ema_slow` (EMA12 > EMA26)
- **–ú–µ–¥–≤–µ–∂–∏–π —Ç—Ä–µ–Ω–¥:** `ema_fast < ema_slow` (EMA12 < EMA26)

### **–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

- **ETH –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è:** DeFi —Ç–æ–∫–µ–Ω—ã (UNI, AAVE, COMP) –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å ETH (0.5-0.8)
- **SOL –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è:** Solana —Ç–æ–∫–µ–Ω—ã (RAY, SRM, FIDA) –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å SOL (0.6-0.85)
- **–£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ —Å–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–∞—Ö:**

–í `scripts/run_advanced_backtest.py` –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ ETH –∏ SOL —Ç—Ä–µ–Ω–¥–æ–≤:

```619:641:scripts/run_advanced_backtest.py
            # üÜï 4.1. ETH —Ç—Ä–µ–Ω–¥ —Ñ–∏–ª—å—Ç—Ä (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã)
            eth_df = getattr(self, 'eth_df', None)
            if eth_df is not None and not eth_df.empty:
                eth_trend = self.check_eth_trend(eth_df, row.name)
                if eth_trend is not None:
                    if (direction == "LONG" and eth_trend) or (direction == "SHORT" and not eth_trend):
                        confidence += 10
                        filters_passed.append("eth_aligned")
                    else:
                        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ ETH
                        return None
            
            # üÜï 4.2. SOL —Ç—Ä–µ–Ω–¥ —Ñ–∏–ª—å—Ç—Ä (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã)
            sol_df = getattr(self, 'sol_df', None)
            if sol_df is not None and not sol_df.empty:
                sol_trend = self.check_sol_trend(sol_df, row.name)
                if sol_trend is not None:
                    if (direction == "LONG" and sol_trend) or (direction == "SHORT" and not sol_trend):
                        confidence += 10
                        filters_passed.append("sol_aligned")
                    else:
                        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ SOL
                        return None
```

üìÑ **–ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** `docs/ETH_SOL_FILTERS_ANALYSIS.md`

---

## üìù –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **RSI —Ñ–∏–ª—å—Ç—Ä** - —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä (75.96% –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ)
2. **MACD —Ñ–∏–ª—å—Ç—Ä** - —Ç—Ä–µ–±—É–µ—Ç —Å–∏–ª—å–Ω–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ (> 0.5%) –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
3. **Volume —Ñ–∏–ª—å—Ç—Ä** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–∞–∫ –Ω–∏–∑–∫–∏–µ, —Ç–∞–∫ –∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –æ–±—ä–µ–º—ã
4. **BTC Trend —Ñ–∏–ª—å—Ç—Ä** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –∞–ª—å—Ç–∫–æ–∏–Ω–æ–≤ ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù**
5. **ETH Trend —Ñ–∏–ª—å—Ç—Ä** - –≤–∞–∂–µ–Ω –¥–ª—è DeFi —Ç–æ–∫–µ–Ω–æ–≤ ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù**
6. **SOL Trend —Ñ–∏–ª—å—Ç—Ä** - –≤–∞–∂–µ–Ω –¥–ª—è Solana —Ç–æ–∫–µ–Ω–æ–≤ ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù**
7. **EMA —Ñ–∏–ª—å—Ç—Ä** - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ EMA
8. **BB —Ñ–∏–ª—å—Ç—Ä** - —Ç—Ä–µ–±—É–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Ü–µ–Ω—ã (–Ω–∏–∂–Ω–∏–µ/–≤–µ—Ä—Ö–Ω–∏–µ 20%)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-XX  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è:** 2.4  
**–ê–≤—Ç–æ—Ä:** ATRA Trading System

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´

- üìÑ **–ê–Ω–∞–ª–∏–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ RSI:** `docs/RSI_OPTIMIZATION_ANALYSIS.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ RSI –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –∫—Ä–∏–ø—Ç–æ—Ä—ã–Ω–∫–µ

---

## üìù –ò–°–¢–û–†–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –í–µ—Ä—Å–∏—è 2.4 (2025-01-XX)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–æ–π –∫—Ä–∏–ø—Ç–æ-—Ç–æ—Ä–≥–æ–≤–ª–∏
- ‚úÖ MACD —Ñ–∏–ª—å—Ç—Ä: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã 12/26/9 ‚Üí 8/21/5, min_strength 0.005 ‚Üí 0.003
- ‚úÖ –°–æ–∑–¥–∞–Ω `enhanced_macd_filter` —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞, –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
- ‚úÖ EMA —Ñ–∏–ª—å—Ç—Ä: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã 7/25 ‚Üí 6/14/22, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ Volume —Ñ–∏–ª—å—Ç—Ä: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (1.2/500/8), –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä–µ–º–∞ –≤ USD
- ‚úÖ BB —Ñ–∏–ª—å—Ç—Ä: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (18/1.8/0.015), –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∂–∞—Ç–∏—è
- ‚úÖ Trend —Ñ–∏–ª—å—Ç—Ä—ã (BTC/ETH/SOL): –ø–∞—Ä–∞–º–µ—Ç—Ä—ã 12/26 ‚Üí 10/22, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã—Ö –ø—Ä–æ—Ç–∏–≤–æ—Ç—Ä–µ–Ω–¥–æ–≤ (strength > 1%), —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ –±–æ–∫–æ–≤–∏–∫–µ

### –í–µ—Ä—Å–∏—è 2.3 (2025-01-XX)
- ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ RSI —É—Ä–æ–≤–Ω–∏ –ø–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `src/filters/adaptive_rsi.py` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –≤ `enhanced_rsi_filter`
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RSI: 70/30 ‚Üí 72/28 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∫—Ä–∏–ø—Ç–æ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `USE_ADAPTIVE_RSI_LEVELS` –≤ `config.py`

### –í–µ—Ä—Å–∏—è 2.2 (2025-01-XX)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RSI –¥–ª—è –∫—Ä–∏–ø—Ç–æ—Ä—ã–Ω–∫–∞
- ‚úÖ –î–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ lookback: 5 ‚Üí 8 (–ª—É—á—à–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π)
- ‚úÖ Volatility threshold: 10 ‚Üí 8 (–º–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)
- ‚úÖ –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º: 80/20 ‚Üí 78/22 (–±–æ–ª–µ–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `INDICATOR_SETTINGS`

### –í–µ—Ä—Å–∏—è 2.1 (2025-01-XX)
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã ETH –∏ SOL —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω—ã (–∫–∞–∫ BTC —Ñ–∏–ª—å—Ç—Ä)
- ‚úÖ –£–±—Ä–∞–Ω—ã —É—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ `USE_ETH_TREND_FILTER` –∏ `USE_SOL_TREND_FILTER` –∏–∑ –ª–æ–≥–∏–∫–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `check_all_trend_alignments()` - –≤—Å–µ —Ç—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤—Å–µ–≥–¥–∞

### –í–µ—Ä—Å–∏—è 2.0 (2025-01-XX)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã ETH –∏ SOL —Ç—Ä–µ–Ω–¥–æ–≤
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `check_eth_alignment()` –∏ `check_sol_alignment()`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `signal_live.py` —á–µ—Ä–µ–∑ `check_all_trend_alignments()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±—ç–∫—Ç–µ—Å—Ç—ã (`scripts/run_advanced_backtest.py`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –í–µ—Ä—Å–∏—è 1.1 (2025-01-XX)
- üìù –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ ETH –∏ SOL —Ç—Ä–µ–Ω–¥–∞—Ö (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å)

### –í–µ—Ä—Å–∏—è 1.0 (2025-01-XX)
- üìù –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

