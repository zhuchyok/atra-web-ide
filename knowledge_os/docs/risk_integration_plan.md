# –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏

## üéØ **–¶–ï–õ–¨**
–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–∏—Å—Ç–µ–º—É —Ä–∞—Å—á–µ—Ç–∞ –ø–ª–µ—á –∏ —Ä–∏—Å–∫–æ–≤ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é, –æ—Å–Ω–æ–≤–∞–Ω–Ω—É—é –Ω–∞ —Ä–∞–∑–º–µ—Ä–µ –¥–µ–ø–æ–∑–∏—Ç–∞ –∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞.

## üìä **–¢–ï–ö–£–©–ò–ï –ü–†–û–ë–õ–ï–ú–´**

### 1. **–ü–ª–µ—á–∏ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ**
- –¢–µ–∫—É—â–µ–µ: –¥–æ 20x –¥–ª—è –≤—Å–µ—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- –ü—Ä–æ–±–ª–µ–º–∞: $100 —Å –ø–ª–µ—á–æ–º 20x = $2000 –ø–æ–∑–∏—Ü–∏—è (2000% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞!)
- –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –¥–µ–ø–æ–∑–∏—Ç–∞–º

### 2. **–ù–µ—Ç —É—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –¥–µ–ø–æ–∑–∏—Ç–∞**
- –¢–µ–∫—É—â–µ–µ: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–ª–µ—á–∏ –¥–ª—è $100 –∏ $10000
- –ü—Ä–æ–±–ª–µ–º–∞: –º–∞–ª—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏
- –†–µ—à–µ–Ω–∏–µ: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ —Ç–∏—Ä–∞–º –¥–µ–ø–æ–∑–∏—Ç–æ–≤

### 3. **–°–ø–æ—Ç vs –§—å—é—á–µ—Ä—Å—ã**
- –¢–µ–∫—É—â–µ–µ: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
- –ü—Ä–æ–±–ª–µ–º–∞: —Å–ø–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–µ—á–∏
- –†–µ—à–µ–Ω–∏–µ: –†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤

## üîß **–ü–õ–ê–ù –ò–ù–¢–ï–ì–†–ê–¶–ò–ò**

### **–≠—Ç–∞–ø 1: –ó–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞ –ø–ª–µ—á**

#### 1.1 –ó–∞–º–µ–Ω–∏—Ç—å `get_dynamic_leverage()` –≤ `signal_live.py`
```python
# –°–¢–ê–†–û–ï (—Å—Ç—Ä–æ–∫–∏ 3853-3920):
def get_dynamic_leverage(df, i, base_leverage=1):
    # –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ —É—á–µ—Ç–∞ –¥–µ–ø–æ–∑–∏—Ç–∞
    return max(1, int(round(dynamic_leverage)))

# –ù–û–í–û–ï:
def get_improved_dynamic_leverage(deposit, trade_mode, volatility, trend_strength, market_regime="neutral"):
    from risk_management_improvements import get_improved_dynamic_leverage
    return get_improved_dynamic_leverage(deposit, trade_mode, volatility, trend_strength, market_regime)
```

#### 1.2 –ó–∞–º–µ–Ω–∏—Ç—å `get_dynamic_risk_pct()` –≤ `signal_live.py`
```python
# –°–¢–ê–†–û–ï (—Å—Ç—Ä–æ–∫–∏ 7904-7934):
def get_dynamic_risk_pct(df, i):
    # –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ —É—á–µ—Ç–∞ –¥–µ–ø–æ–∑–∏—Ç–∞
    return max(1.0, min(dynamic_risk, 5.0))

# –ù–û–í–û–ï:
def get_improved_dynamic_risk_pct(deposit, trade_mode, volatility, trend_strength, market_regime="neutral"):
    from risk_management_improvements import get_improved_dynamic_risk_pct
    return get_improved_dynamic_risk_pct(deposit, trade_mode, volatility, trend_strength, market_regime)
```

### **–≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π**

#### 2.1 –í `check_and_send_signals()` (—Å—Ç—Ä–æ–∫–∏ 4729, 5406, 6558)
```python
# –°–¢–ê–†–û–ï:
risk_pct = get_dynamic_risk_pct(df, current_index)

# –ù–û–í–û–ï:
deposit = float(user_data.get("deposit", START_BALANCE))
trade_mode = user_data.get("trade_mode", "spot")
volatility = df["volatility"].iloc[current_index] if "volatility" in df.columns else 0.02
trend_strength = calculate_trend_strength(df, current_index)
market_regime = get_market_regime_from_cache() or "neutral"

risk_pct = get_improved_dynamic_risk_pct(deposit, trade_mode, volatility, trend_strength, market_regime)
```

#### 2.2 –í —Ä–∞—Å—á–µ—Ç–µ –ø–ª–µ—á (—Å—Ç—Ä–æ–∫–∏ 4795, 4883)
```python
# –°–¢–ê–†–û–ï:
dyn_market = get_dynamic_leverage(df, current_index, 5)

# –ù–û–í–û–ï:
deposit = float(user_data.get("deposit", START_BALANCE))
trade_mode = user_data.get("trade_mode", "spot")
volatility = df["volatility"].iloc[current_index] if "volatility" in df.columns else 0.02
trend_strength = calculate_trend_strength(df, current_index)
market_regime = get_market_regime_from_cache() or "neutral"

dyn_market = get_improved_dynamic_leverage(deposit, trade_mode, volatility, trend_strength, market_regime)
```

### **–≠—Ç–∞–ø 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∏—Å–∫–æ–≤**

#### 3.1 –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `signal_live.py`
```python
def validate_position_risk(deposit, position_size_usd, leverage, trade_mode):
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏ –ø–æ–∑–∏—Ü–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –ª–∏–º–∏—Ç—ã —Ä–∏—Å–∫–∞."""
    from risk_management_improvements import validate_position_risk
    return validate_position_risk(deposit, position_size_usd, leverage, trade_mode)
```

#### 3.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ DCA –ª–æ–≥–∏–∫—É
```python
# –í —Ñ—É–Ω–∫—Ü–∏—è—Ö DCA (—Å—Ç—Ä–æ–∫–∏ 4850, 4926):
if not validate_position_risk(deposit_val, base_new_risk_usd, leverage, trade_mode):
    logger.warning(f"Position risk too high for deposit {deposit_val}")
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç—É –ø–æ–∑–∏—Ü–∏—é
```

### **–≠—Ç–∞–ø 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π —Ä–∏—Å–∫–∞**

#### 4.1 –ó–∞–º–µ–Ω–∏—Ç—å `risk_profile_for_user()` –≤ `shared_utils.py`
```python
# –°–¢–ê–†–û–ï (—Å—Ç—Ä–æ–∫–∏ 278-353):
def risk_profile_for_user(deposit: float, trade_mode: str = "spot") -> dict:
    # –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

# –ù–û–í–û–ï:
def risk_profile_for_user(deposit: float, trade_mode: str = "spot") -> dict:
    from risk_management_improvements import get_improved_risk_profile
    return get_improved_risk_profile(deposit, trade_mode)
```

## üìà **–û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´**

### **–î–ª—è –º–∞–ª—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ ($100-500)**
- **–ë—ã–ª–æ**: –ü–ª–µ—á–æ –¥–æ 20x, —Ä–∏—Å–∫ 2-5%
- **–°—Ç–∞–ª–æ**: –ü–ª–µ—á–æ 1-3x, —Ä–∏—Å–∫ 0.5-1.5%
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–ª–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –¥–µ–ø–æ–∑–∏—Ç–∞

### **–î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ ($1000-5000)**
- **–ë—ã–ª–æ**: –ü–ª–µ—á–æ –¥–æ 20x, —Ä–∏—Å–∫ 2-5%
- **–°—Ç–∞–ª–æ**: –ü–ª–µ—á–æ 5-8x, —Ä–∏—Å–∫ 1-2.5%
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∏—Å–∫/–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å

### **–î–ª—è –±–æ–ª—å—à–∏—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ ($10000+)**
- **–ë—ã–ª–æ**: –ü–ª–µ—á–æ –¥–æ 20x, —Ä–∏—Å–∫ 2-5%
- **–°—Ç–∞–ª–æ**: –ü–ª–µ—á–æ 10-20x, —Ä–∏—Å–∫ 1.5-3%
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–º —Ä–∏—Å–∫–µ

## üöÄ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ô –°–ò–°–¢–ï–ú–´**

1. **–ó–∞—â–∏—Ç–∞ –º–∞–ª—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å –≤–µ—Å—å –¥–µ–ø–æ–∑–∏—Ç –∑–∞ –æ–¥–Ω—É —Å–¥–µ–ª–∫—É
2. **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ë–æ–ª—å—à–∏–µ –¥–µ–ø–æ–∑–∏—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–Ω–¥–∞ –∏ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞
4. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–π–¥–∏–Ω–≥–∞
5. **–ì–∏–±–∫–æ—Å—Ç—å**: –†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —Å–ø–æ—Ç –∏ —Ñ—å—é—á–µ—Ä—Å–æ–≤

## ‚ö†Ô∏è **–†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø**

### **–†–∏—Å–∫**: –°–Ω–∏–∂–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–ª—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –§–æ–∫—É—Å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏–≥–Ω–∞–ª–æ–≤, –∞ –Ω–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä–µ –ø–æ–∑–∏—Ü–∏–π

### **–†–∏—Å–∫**: –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü–æ—ç—Ç–∞–ø–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### **–†–∏—Å–∫**: –°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ

## üìã **–ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø**

1. **–ù–µ–¥–µ–ª—è 1**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
2. **–ù–µ–¥–µ–ª—è 2**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
3. **–ù–µ–¥–µ–ª—è 3**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ù–µ–¥–µ–ª—è 4**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–ù–µ–¥–µ–ª—è 5**: –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

## üéØ **–ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê**

- –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –Ω–∞ 80%
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ –æ–±—â–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
