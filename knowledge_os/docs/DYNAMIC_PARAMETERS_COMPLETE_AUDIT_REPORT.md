# üîç –ü–û–õ–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–• –ü–ê–†–ê–ú–ï–¢–†–û–í –í –°–ò–ì–ù–ê–õ–ê–•

## **üìã –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø**

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 21.08.2025 20:15
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ä–∏—Å–∫–∏, –ø–ª–µ—á–∏, —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç—ã) –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê

---

## **üéØ –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø**

### **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–∏–ª:**
> "—Ç–µ–ø–µ—Ä—å –µ—â–µ —Ä–∞–∑ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä—å –¥–ª—è –º–µ–Ω—è –≤–∞–∂–Ω–æ —á—Ç–æ–±—ã —Ç–µ–∫–ø—Ä–æ—Ñ–∏—Ç—ã —Ä–∏—Å–∫–∏ –ø–ª–µ—á–∏ –±—ã–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤ –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —á—Ç–æ–±—ã —Ç–µ–∫–ø—Ä–æ—Ñ–∏—Ç—ã —Ä–∏—Å–∫–∏ –ø–ª–µ—á–∏ –±—ã–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤ –Ω–æ–≤—ã—Ö –¥—Ü–∞ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç —É—á–∏—Ç—ã–≤–∞—è –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—å –µ—â–µ —Ä–∞–∑ –≤—Å–µ –∏ –Ω–∞–∫–æ–ø–ª–µ–Ω—ã–µ –¥—Ü–∞ —Ç–æ–∂–µ –ø—Ä–æ–≤–µ—Ä—å"

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. **–ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
2. **–ù–æ–≤—ã–µ DCA** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
3. **–ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ DCA** - —Ç–æ–∂–µ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

---

## **‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–†–û–í–ï–†–ö–ò**

### **1. üÜï –ù–û–í–´–ï –°–ò–ì–ù–ê–õ–´ - –ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–ê–í–ò–õ–¨–ù–û**

#### **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `telegram_bot.py` (—Å—Ç—Ä–æ–∫–∏ 1375-1400)

#### **‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç–∏—è:**
```python
# –ü–æ–ª—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç–∏—è
from signal_live import get_dynamic_leverage, get_dynamic_risk_pct
from shared_utils import get_dynamic_tp_levels
from ohlc_utils import get_ohlc_binance_sync_async

try:
    ohlc_1m = await get_ohlc_binance_sync_async(symbol, interval="1m", limit=200)
    if not ohlc_1m or len(ohlc_1m) < 30:
        raise RuntimeError("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–µ—á–µ–π –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏")
    df_dyn = pd.DataFrame(ohlc_1m)[["open","high","low","close","volume"]]
    current_index = len(df_dyn) - 1

    # –†–∏—Å–∫ –∏ –ø–ª–µ—á–æ
    dynamic_risk_pct = float(get_dynamic_risk_pct(df_dyn, current_index))
    dynamic_leverage = int(get_dynamic_leverage(df_dyn, current_index, leverage)) if trade_mode == "futures" else 1
    # TP —É—Ä–æ–≤–Ω–∏
    dynamic_tp1_pct, dynamic_tp2_pct = get_dynamic_tp_levels(df_dyn, current_index, side)
    print(f"[BUTTON] –î–∏–Ω–∞–º–∏–∫–∞: —Ä–∏—Å–∫={dynamic_risk_pct}%, –ø–ª–µ—á–æ={dynamic_leverage}x, TP={dynamic_tp1_pct}%/{dynamic_tp2_pct}%")
except Exception as e:
    print(f"[BUTTON] –î–∏–Ω–∞–º–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, fallback –∫ –±–∞–∑–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º: {e}")
    dynamic_risk_pct = risk_pct
    dynamic_leverage = leverage if trade_mode == "futures" else 1
    dynamic_tp1_pct, dynamic_tp2_pct = 1.0, 2.0
```

#### **‚úÖ –°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –∏ —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É
total_positions = len(user_data.get("open_positions", []))
# –û—Ü–µ–Ω–∫–∞ –∑–∞–Ω—è—Ç–æ–≥–æ —Ä–∏—Å–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –±–µ–∑ risk_amount
def _estimate_risk_amount(p):
    if "risk_amount" in p:
        return p["risk_amount"]
    notional = p.get("qty", 0) * p.get("entry_price", 0)
    lev = p.get("leverage", 1) or 1
    return notional / max(1, lev)
total_risk = sum(_estimate_risk_amount(pos) for pos in user_data.get("open_positions", []))
free_deposit = max(deposit - total_risk, 0)
risk_amount = free_deposit * (dynamic_risk_pct / 100.0)
```

#### **‚úÖ –¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã:**
```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
if side == "long":
    tp1 = current_price * (1 + dynamic_tp1_pct / 100)
    tp2 = current_price * (1 + dynamic_tp2_pct / 100)
else:
    tp1 = current_price * (1 - dynamic_tp1_pct / 100)
    tp2 = current_price * (1 - dynamic_tp2_pct / 100)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–ê–í–ò–õ–¨–ù–û

---

### **2. üîÑ –ù–û–í–´–ï DCA –°–ò–ì–ù–ê–õ–´ - –ò–°–ü–†–ê–í–õ–ï–ù–û**

#### **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `telegram_bot.py` (—Å—Ç—Ä–æ–∫–∏ 3375-3400)

#### **‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç–∏—è:**
```python
# –ü–æ–ª—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è DCA –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç–∏—è
try:
    from ohlc_utils import get_ohlc_binance_sync_async
    from shared_utils import get_dynamic_tp_levels
    from signal_live import get_dynamic_leverage, get_dynamic_risk_pct
    ohlc_1m = await get_ohlc_binance_sync_async(symbol, interval="1m", limit=200)
    if not ohlc_1m or len(ohlc_1m) < 30:
        raise RuntimeError("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–µ—á–µ–π –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏")
    df_dyn = pd.DataFrame(ohlc_1m)[["open","high","low","close","volume"]]
    current_index = len(df_dyn) - 1
    dynamic_risk_pct = float(get_dynamic_risk_pct(df_dyn, current_index))
    dynamic_leverage = int(get_dynamic_leverage(df_dyn, current_index, leverage)) if trade_mode == "futures" else 1
    dynamic_tp1_pct, dynamic_tp2_pct = get_dynamic_tp_levels(df_dyn, current_index, side)
    print(f"[BUTTON] DCA –¥–∏–Ω–∞–º–∏–∫–∞: —Ä–∏—Å–∫={dynamic_risk_pct}%, –ø–ª–µ—á–æ={dynamic_leverage}x, TP={dynamic_tp1_pct}%/{dynamic_tp2_pct}%")
except Exception as e:
    print(f"[BUTTON] DCA –¥–∏–Ω–∞–º–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, fallback –∫ –±–∞–∑–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º: {e}")
    dynamic_risk_pct = risk_pct
    dynamic_leverage = leverage if trade_mode == "futures" else 1
    dynamic_tp1_pct, dynamic_tp2_pct = 1.0, 2.0
```

#### **‚úÖ –°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π (–ò–°–ü–†–ê–í–õ–ï–ù–û):**
```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –∏ —Ä–∏—Å–∫ –¥–ª—è DCA
def _estimate_risk_amount(p):
    if "risk_amount" in p:
        return p["risk_amount"]
    notional = p.get("qty", 0) * p.get("entry_price", 0)
    lev = p.get("leverage", 1) or 1
    return notional / max(1, lev)

total_risk = sum(_estimate_risk_amount(pos) for pos in open_positions)
free_deposit = max(deposit - total_risk, 0)
dca_risk_amount = free_deposit * (dynamic_risk_pct / 100.0)
```

#### **‚úÖ –§—É–Ω–∫—Ü–∏—è DCA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP:**
```python
new_qty, avg_price_new, tp1, tp2, limit_reached = dca_calculate_next_qty_and_tp(
    entry_prices, qtys, entry_price, dca_count, deposit, dynamic_risk_pct, dynamic_leverage, side, df=None, current_index=None
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

### **3. ‚è∞ –ù–ê–ö–û–ü–õ–ï–ù–ù–´–ï DCA –°–ò–ì–ù–ê–õ–´ - –ü–†–û–í–ï–†–ï–ù–û**

#### **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `telegram_bot.py` (—Å—Ç—Ä–æ–∫–∏ 2148-2200)

#### **‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/pending_dca` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:**
```python
async def pending_dca_cmd(update, context):
    """–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ DCA —Å–∏–≥–Ω–∞–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    # ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö ...

    pending_signals = user_data.get('pending_dca_signals', [])

    if not pending_signals:
        await update.message.reply_text(
            "‚è∞ –£ –≤–∞—Å –Ω–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö DCA —Å–∏–≥–Ω–∞–ª–æ–≤.\n\n"
            "DCA —Å–∏–≥–Ω–∞–ª—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –Ω–µ—Ç–æ—Ä–≥–æ–≤–æ–µ –≤—Ä–µ–º—è "
            "–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ —Å –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤."
        )
        return
```

#### **‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
```python
msg += (
    "üí° *–≠—Ç–∏ —Å–∏–≥–Ω–∞–ª—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –Ω–∞—á–∞–ª–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ "
    "—Å –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.*"
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ DCA –±—É–¥—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

---

## **üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç `dca_risk_amount` –≤ DCA —Å–∏–≥–Ω–∞–ª–∞—Ö:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `dca_risk_amount` –Ω–µ –±—ã–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ —Ä–∏—Å–∫–∞ –¥–ª—è DCA
- **–ö–æ–¥:** –î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ —Ä–∞—Å—á–µ—Ç–∞ `total_risk`, `free_deposit`, `dca_risk_amount`

### **2. –£–ª—É—á—à–µ–Ω —Ä–∞—Å—á–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_estimate_risk_amount()` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞
- **–ö–æ–¥:** –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ —Å –∏—Ö `risk_amount`

---

## **üìä –§–£–ù–ö–¶–ò–ò –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–• –ü–ê–†–ê–ú–ï–¢–†–û–í**

### **1. `get_dynamic_risk_pct()` - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫:**
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `signal_live.py`
- **–û—Å–Ω–æ–≤–∞:** –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä—ã–Ω–∫–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** ‚úÖ –í –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö –∏ DCA

### **2. `get_dynamic_leverage()` - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ:**
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `signal_live.py`
- **–û—Å–Ω–æ–≤–∞:** –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∏ –¥–µ–ø–æ–∑–∏—Ç
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** ‚úÖ –í –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö –∏ DCA

### **3. `get_dynamic_tp_levels()` - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP:**
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `shared_utils.py`
- **–û—Å–Ω–æ–≤–∞:** –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–Ω–¥
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** ‚úÖ –í –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö, DCA –∏ —Ñ—É–Ω–∫—Ü–∏–∏ `dca_calculate_next_qty_and_tp`

---

## **‚úÖ –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–°**

### **–í—Å–µ —Ç–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

1. **üÜï –ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–ê–í–ò–õ–¨–ù–û
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

2. **üîÑ –ù–æ–≤—ã–µ DCA:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

3. **‚è∞ –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ DCA:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
   - –ë—É–¥—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### **–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ **–°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏** - –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ** - –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –¥–µ–ø–æ–∑–∏—Ç–∞
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ TP** - –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ **–ú–æ–º–µ–Ω—Ç —Ä–∞—Å—á–µ—Ç–∞** - –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç–∏—è —Å–∏–≥–Ω–∞–ª–∞

---

## **üöÄ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

**–í—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!**

- ‚úÖ **–ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
- ‚úÖ **DCA —Å–∏–≥–Ω–∞–ª—ã** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
- ‚úÖ **–ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ DCA** - –±—É–¥—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- ‚úÖ **–°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—á–∏—Ç—ã–≤–∞—é—Ç –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å** - —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–∞—Ö

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏!** üéØ
