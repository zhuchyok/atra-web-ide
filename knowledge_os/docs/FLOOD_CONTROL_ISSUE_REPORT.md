# –û–¢–ß–ï–¢: –ü–†–û–ë–õ–ï–ú–ê –° FLOOD CONTROL TELEGRAM

## üîç –ü—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞:** `Flood control exceeded. Retry in 599 seconds`

**–ü—Ä–∏—á–∏–Ω–∞:** Telegram –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 958930260 –Ω–∞ 10 –º–∏–Ω—É—Ç –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã, —Ö–æ—Ç—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:
```
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 556251171: ‚úÖ –£–°–ü–ï–®–ù–û
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 958930260: ‚ùå FLOOD CONTROL
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- **–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 2
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 2
- **Futures –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 2
- **Soft —Ä–µ–∂–∏–º:** 2

## üõ†Ô∏è –†–µ—à–µ–Ω–∏—è

### 1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –º–µ—Ä—ã

#### A. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Flood Control
```python
async def notify_user_with_flood_control(user_id, message, max_retries=3):
    """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π Flood Control"""
    for attempt in range(max_retries):
        try:
            result = await notify_user(user_id, message)
            if result:
                return True
        except Exception as e:
            if "Flood control" in str(e):
                print(f"[FLOOD] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ 10 –º–∏–Ω—É—Ç")
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞
                FLOOD_CONTROL_CACHE[user_id] = time.time() + 600
                return False
            elif attempt < max_retries - 1:
                await asyncio.sleep(2 ** attempt)  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
    return False
```

#### B. –ö—ç—à –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```python
FLOOD_CONTROL_CACHE = {}

def is_user_flood_controlled(user_id):
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Flood Control"""
    if user_id in FLOOD_CONTROL_CACHE:
        if time.time() < FLOOD_CONTROL_CACHE[user_id]:
            return True
        else:
            del FLOOD_CONTROL_CACHE[user_id]
    return False
```

### 2. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã

#### A. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π
```python
MESSAGE_RATE_LIMIT = {
    'signals': 60,      # –ú–∞–∫—Å–∏–º—É–º 1 —Å–∏–≥–Ω–∞–ª –≤ –º–∏–Ω—É—Ç—É
    'notifications': 30, # –ú–∞–∫—Å–∏–º—É–º 2 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç—É
    'alerts': 120       # –ú–∞–∫—Å–∏–º—É–º 1 –∞–ª–µ—Ä—Ç –≤ 2 –º–∏–Ω—É—Ç—ã
}
```

#### B. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
```python
async def send_batched_signals(users, signals):
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤"""
    for user_id in users:
        if not is_user_flood_controlled(user_id):
            # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
            batched_message = create_batched_message(signals)
            await notify_user_with_flood_control(user_id, batched_message)
```

#### C. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
```python
SIGNAL_PRIORITY = {
    'high': ['BTCUSDT', 'ETHUSDT'],    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä—ã
    'medium': ['BNBUSDT', 'SOLUSDT'],  # –í–∞–∂–Ω—ã–µ –ø–∞—Ä—ã
    'low': ['*']                       # –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã
}
```

## üìç –ú–µ—Å—Ç–∞ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. `signal_live.py`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Flood Control –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 2. `telegram_bot.py`
- –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ Telegram API
- –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å fallback –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 3. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°–æ–∑–¥–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (email, webhook)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:
1. **–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Flood Control** –≤ `notify_user`
2. **–°–æ–∑–¥–∞—Ç—å –∫—ç—à –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è:
1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π
2. **–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤** –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
3. **–°–æ–∑–¥–∞—Ç—å web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:
1. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** (Telegram + Email + Web)
2. **–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏** —Å–∏–≥–Ω–∞–ª–æ–≤
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á–∞—Å—Ç–æ—Ç—ã

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 556251171:** ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 958930260:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω Flood Control
- **–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ü—Ä–æ–±–ª–µ–º–∞:** ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞** - –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞
2. üîÑ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Flood Control** - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
3. üìã **–î–æ–±–∞–≤–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã** - –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
4. üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

---

**–î–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:** 20.08.2025
**–°—Ç–∞—Ç—É—Å:** üîÑ –í –†–ê–ó–†–ê–ë–û–¢–ö–ï
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í–´–°–û–ö–ò–ô
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç —Å–∏–≥–Ω–∞–ª—ã
