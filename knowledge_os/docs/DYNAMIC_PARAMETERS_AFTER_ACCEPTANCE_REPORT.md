# üéØ –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ï –ü–ê–†–ê–ú–ï–¢–†–´ –ü–û–°–õ–ï –ü–†–ò–ù–Ø–¢–ò–Ø –°–ò–ì–ù–ê–õ–ê - –û–¢–ß–ï–¢

## üìã **–ü–†–û–ë–õ–ï–ú–ê**

–ü–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Å–∏–≥–Ω–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- ‚ùå –†–∏—Å–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª—Å—è –æ—Ç –æ–±—â–µ–≥–æ –¥–µ–ø–æ–∑–∏—Ç–∞
- ‚ùå –ù–µ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- ‚ùå –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞
- ‚ùå –ü–ª–µ—á–æ –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –∫ —Ç–µ–∫—É—â–µ–º—É –±–∞–ª–∞–Ω—Å—É

## ‚úÖ **–†–ï–®–ï–ù–ò–ï**

### **1. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞**

**–ë—ã–ª–æ:**
```python
risk_amount = deposit * risk_pct / 100
```

**–°—Ç–∞–ª–æ:**
```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —É—á–µ—Ç–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
balance_data = recalculate_balance_and_risks(user_data_from_file)

if balance_data:
    free_deposit = balance_data["free_deposit"]
    total_risk_amount = balance_data["total_risk_amount"]
    updated_deposit = balance_data["updated_deposit"]

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∏—Å–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
if free_deposit > 0:
    risk_amount = free_deposit * risk_pct / 100
    if trade_mode == "futures" and leverage > 1:
        risk_amount *= leverage
else:
    risk_amount = 0
```

### **2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è**

**–ë—ã–ª–æ:**
```
üìã –ü–ê–†–ê–ú–ï–¢–†–´ –í–•–û–î–ê:
‚Ä¢ ‚ö° –ü–ª–µ—á–æ: x5
‚Ä¢ ‚ö†Ô∏è –†–∏—Å–∫: 2.00%
‚Ä¢ üíµ –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 20.00 USDT

üìä –ë–ê–õ–ê–ù–°:
‚Ä¢ –î–µ–ø–æ–∑–∏—Ç: 1000.00 USDT
‚Ä¢ –û—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π: 2
```

**–°—Ç–∞–ª–æ:**
```
üìã *–î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ï –ü–ê–†–ê–ú–ï–¢–†–´:*
‚Ä¢ ‚ö° –ü–ª–µ—á–æ: x5
‚Ä¢ ‚ö†Ô∏è –†–∏—Å–∫: 2.00%
‚Ä¢ üíµ –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 85.00 USDT
‚Ä¢ üìä –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

üìä *–ê–ö–¢–£–ê–õ–¨–ù–´–ô –ë–ê–õ–ê–ù–°:*
‚Ä¢ üí∞ –û–±—â–∏–π –¥–µ–ø–æ–∑–∏—Ç: 1000.00 USDT
‚Ä¢ üîí –ó–∞–Ω—è—Ç–æ –ø–æ–∑–∏—Ü–∏—è–º–∏: 150.00 USDT
‚Ä¢ üí∏ –°–≤–æ–±–æ–¥–Ω–æ: 850.00 USDT
‚Ä¢ üìà –û—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π: 2
```

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **–¢–µ—Å—Ç 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏**
```
üí∞ –ò—Å—Ö–æ–¥–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç: 1000.00 USDT
‚ö†Ô∏è –†–∏—Å–∫: 2.00%
‚ö° –ü–ª–µ—á–æ: x5
üìà –û—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π: 2

üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –†–ê–°–ß–ï–¢–ê:
‚Ä¢ üí∞ –û–±—â–∏–π –¥–µ–ø–æ–∑–∏—Ç: 1000.00 USDT
‚Ä¢ üîí –ó–∞–Ω—è—Ç–æ –ø–æ–∑–∏—Ü–∏—è–º–∏: 150.00 USDT
‚Ä¢ üí∏ –°–≤–æ–±–æ–¥–Ω–æ: 850.00 USDT

üéØ –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ô –†–ò–°–ö –î–õ–Ø –ù–û–í–û–ô –ü–û–ó–ò–¶–ò–ò:
‚Ä¢ üíµ –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 85.00 USDT
‚Ä¢ üìä –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤: 850.00 USDT
‚Ä¢ ‚ö° –° —É—á–µ—Ç–æ–º –ø–ª–µ—á–∞: x5
```

### **–¢–µ—Å—Ç 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ –ø–æ–∑–∏—Ü–∏–π**
```
üí∞ –î–µ–ø–æ–∑–∏—Ç: 500.00 USDT
üí∏ –°–≤–æ–±–æ–¥–Ω–æ: 500.00 USDT
üíµ –°—É–º–º–∞ –≤—Ö–æ–¥–∞: 15.00 USDT
```

## üéØ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê**

### **1. –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞**
- ‚úÖ –†–∏—Å–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç **—Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**
- ‚úÖ –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è **–≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏**
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–∞–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å**

### **2. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç **—Å–∫–æ–ª—å–∫–æ –∑–∞–Ω—è—Ç–æ**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç **—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω–æ**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–Ω–∏–º–∞–µ—Ç **–æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è —Å—É–º–º–∞ –≤—Ö–æ–¥–∞**

### **3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- ‚úÖ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–≤—ã—Å–∏—Ç—å **–ª–∏–º–∏—Ç –¥–µ–ø–æ–∑–∏—Ç–∞**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç **–≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞**
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç **–ø–µ—Ä–µ—Ç–æ—Ä–≥–æ–≤–ª–∏**

## üìä **–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´**

### **1. –†–∞—Å—á–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤:**
```
–°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ = –û–±—â–∏–π –¥–µ–ø–æ–∑–∏—Ç - –°—É–º–º–∞ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
```

### **2. –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞ –¥–ª—è –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏:**
```
–†–∏—Å–∫ = –°–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ √ó –ü—Ä–æ—Ü–µ–Ω—Ç —Ä–∏—Å–∫–∞ / 100
```

### **3. –£—á–µ—Ç –ø–ª–µ—á–∞ (—Ñ—å—é—á–µ—Ä—Å—ã):**
```
–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ = –†–∏—Å–∫ √ó –ü–ª–µ—á–æ
```

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø**

### **–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `telegram_bot.py` - —Ñ—É–Ω–∫—Ü–∏—è `button_callback`

### **–§—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã:**
- `recalculate_balance_and_risks()` - —Ä–∞—Å—á–µ—Ç –±–∞–ª–∞–Ω—Å–∞
- `load_user_data_for_signals()` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `free_deposit > 0`
- ‚úÖ Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üöÄ **–†–ï–ó–£–õ–¨–¢–ê–¢**

–¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Å–∏–≥–Ω–∞–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç:

1. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –æ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
2. **–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å** - —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
3. **–ü—Ä–æ–∑—Ä–∞—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** - –æ —Ç–æ–º, –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è —Å—É–º–º–∞ –≤—Ö–æ–¥–∞
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã

**–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π!** ‚úÖ

---

**–î–∞—Ç–∞:** 2025-08-14
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ –ü–†–û–ô–î–ï–ù–û
