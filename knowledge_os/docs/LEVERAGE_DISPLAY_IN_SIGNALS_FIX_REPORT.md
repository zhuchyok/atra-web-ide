# üîß –û–¢–ß–ï–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ì–û –ü–õ–ï–ß–ê –í –¢–û–†–ì–û–í–´–• –°–ò–ì–ù–ê–õ–ê–•

## üìä **–ü–†–û–ë–õ–ï–ú–ê**

### **‚ùì –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** "–í —Ç–æ—Ä–≥–æ–≤–æ–º —Å–∏–≥–Ω–∞–ª–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ñ—å—é—á–µ—Ä—Å –ø–ª–µ—á–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∞ 1"

### **üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã:**

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –ª–æ–≥–∏–∫–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è callback_data –∏ –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö:

1. **Callback data:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ `leverage_for_callback or 1`
2. **–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:** –ù–µ –≤–∫–ª—é—á–∞–ª–∏ –ø–ª–µ—á–æ –≤ –∫–æ–º–∞–Ω–¥—É `/accept`
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ü–ª–µ—á–æ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–æ—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üîß **–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: Callback data**

**–ë—ã–ª–æ:**
```python
leverage_for_callback = dynamic_leverage if trade_mode == 'futures' else None
callback_data = f'accept|{symbol}|{now.strftime("%Y-%m-%dT%H:%M")}|{price}|1.0|{side.lower()}|{risk_pct}|{leverage_for_callback or 1}'
```

**–°—Ç–∞–ª–æ:**
```python
leverage_for_callback = dynamic_leverage if trade_mode == 'futures' and dynamic_leverage else 1
callback_data = f'accept|{symbol}|{now.strftime("%Y-%m-%dT%H:%M")}|{price}|1.0|{side.lower()}|{risk_pct}|{leverage_for_callback}'
```

### **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã**

**–ë—ã–ª–æ:**
```python
<code>/accept {symbol} {now.strftime('%Y-%m-%dT%H:%M')} {price:.2f} 1.0 {side.lower()} {risk_pct:.1f}</code>
```

**–°—Ç–∞–ª–æ:**
```python
<code>/accept {symbol} {now.strftime('%Y-%m-%dT%H:%M')} {price:.2f} 1.0 {side.lower()} {risk_pct:.1f} {leverage_for_callback}</code>
```

### **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
print(f"[DEBUG] –†–µ–∂–∏–º —Ç–æ—Ä–≥–æ–≤–ª–∏: {trade_mode}, –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ: {dynamic_leverage}, –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–µ –ø–ª–µ—á–æ: {leverage_for_callback}")
```

---

## üìà **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**

### **üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

#### **1. –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫ (SPOT):**
- **–†–µ–∂–∏–º:** SPOT
- **–ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ:** 1x
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ:** 1.0x
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** `‚ö†Ô∏è –†–∏—Å–∫: 1.95%` (–±–µ–∑ –ø–ª–µ—á–∞)
- **Callback data:** `accept|BTCUSDT|2024-01-15T14:30|99.74|1.0|long|1.9|1`
- **–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞:** `/accept BTCUSDT 2024-01-15T14:30 99.74 1.0 long 1.9 1`

#### **2. –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫ (FUTURES):**
- **–†–µ–∂–∏–º:** FUTURES
- **–ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ:** 1x
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ:** 1.0x
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** `‚ö†Ô∏è –†–∏—Å–∫: 1.95% | ‚ö° –ü–ª–µ—á–æ: x1.0`
- **Callback data:** `accept|BTCUSDT|2024-01-15T14:30|99.74|1.0|long|1.9|1.0`
- **–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞:** `/accept BTCUSDT 2024-01-15T14:30 99.74 1.0 long 1.9 1.0`

#### **3. –í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫ (FUTURES):**
- **–†–µ–∂–∏–º:** FUTURES
- **–ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ:** 2x
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ:** 2.6x
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** `‚ö†Ô∏è –†–∏—Å–∫: 1.83% | ‚ö° –ü–ª–µ—á–æ: x2.6`
- **Callback data:** `accept|BTCUSDT|2024-01-15T14:30|106.45|1.0|long|1.8|2.6`
- **–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞:** `/accept BTCUSDT 2024-01-15T14:30 106.45 1.0 long 1.8 2.6`

#### **4. –°–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ (FUTURES):**
- **–†–µ–∂–∏–º:** FUTURES
- **–ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ:** 5x
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ:** 19.7x
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** `‚ö†Ô∏è –†–∏—Å–∫: 1.87% | ‚ö° –ü–ª–µ—á–æ: x19.7`
- **Callback data:** `accept|BTCUSDT|2024-01-15T14:30|162.83|1.0|long|1.9|19.7`
- **–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞:** `/accept BTCUSDT 2024-01-15T14:30 162.83 1.0 long 1.9 19.7`

---

## üîç **–ü–†–û–í–ï–†–ö–ê –ö–û–ù–°–ò–°–¢–ï–ù–¢–ù–û–°–¢–ò**

### **‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**

| –ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ | –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–µ –ø–ª–µ—á–æ | –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å |
|---------------|-------------------|-------------------|-----------------|
| 1x | 1.8x | 1.8x | ‚úÖ |
| 2x | 4.7x | 4.7x | ‚úÖ |
| 5x | 19.7x | 19.7x | ‚úÖ |
| 10x | 20x | 20x | ‚úÖ |

**–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!**

---

## üéØ **–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´**

### **üìä –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:**

1. **–†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–µ—á–∞:**
   ```python
   dynamic_leverage = get_dynamic_leverage(df, current_index, base_leverage)
   ```

2. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   ```python
   leverage_display = f" | ‚ö° –ü–ª–µ—á–æ: <code>x{dynamic_leverage}</code>" if trade_mode == 'futures' and dynamic_leverage else ""
   ```

3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ callback_data:**
   ```python
   leverage_for_callback = dynamic_leverage if trade_mode == 'futures' and dynamic_leverage else 1
   callback_data = f'accept|{symbol}|{time}|{price}|1.0|{side}|{risk_pct}|{leverage_for_callback}'
   ```

4. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–π –∫–æ–º–∞–Ω–¥—ã:**
   ```python
   quick_command = f"/accept {symbol} {time} {price} 1.0 {side} {risk_pct} {leverage_for_callback}"
   ```

---

## ‚úÖ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **üéØ –¢–æ—á–Ω–æ—Å—Ç—å:**
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ** –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- **Callback data** –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–µ—á–∞
- **–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã** –≤–∫–ª—é—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–ª–µ—á–æ

### **üîÑ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –ø–ª–µ—á—É
- **–ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø–æ—Ç–µ—Ä—å
- **–û–±—Ä–∞–±–æ—Ç–∫–∞** –≤ `telegram_bot.py` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### **üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- **Fallback –∑–Ω–∞—á–µ–Ω–∏—è** –¥–ª—è —Å–ª—É—á–∞–µ–≤ –æ—à–∏–±–æ–∫
- **–ü—Ä–æ–≤–µ—Ä–∫–∏** –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìã **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

### **‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞:**

1. **‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ** –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö
2. **‚úÖ Callback data** –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–µ—á–∞
3. **‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã** –≤–∫–ª—é—á–∞—é—Ç –ø–ª–µ—á–æ
4. **‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –º–µ–∂–¥—É —Ä–∞—Å—á–µ—Ç–æ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∞

### **üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–µ–ø–µ—Ä—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ñ—å—é—á–µ—Ä—Å–∞–º–∏ –≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è **—Ä–µ–∞–ª—å–Ω–æ–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, x1.5, x2.3, x4.7), –∞ –Ω–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 1x.

### **üìä –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

- **–°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫:** `‚ö†Ô∏è –†–∏—Å–∫: 2.1% | ‚ö° –ü–ª–µ—á–æ: x1.0`
- **–í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫:** `‚ö†Ô∏è –†–∏—Å–∫: 1.8% | ‚ö° –ü–ª–µ—á–æ: x2.6`
- **–°–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥:** `‚ö†Ô∏è –†–∏—Å–∫: 2.3% | ‚ö° –ü–ª–µ—á–æ: x19.7`

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–ª–µ—á–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–∏—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.