#!/usr/bin/expect -f

set timeout 60
set server "185.177.216.15"
set user "root"
set password "u44Ww9NmtQj,XG"

spawn ssh ${user}@${server}

expect {
    "password:" {
        send "${password}\r"
    }
    "yes/no" {
        send "yes\r"
        expect "password:"
        send "${password}\r"
    }
}

expect "# "
send "cd /root/atra\r"
expect "# "

send "echo '=== –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–õ–û–ö–ò–†–û–í–û–ö –ü–û –§–ò–õ–¨–¢–†–ê–ú ==='\r"
expect "# "
send "grep -E 'BLOCK|üö´|–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è' bot_startup.log 2>/dev/null | tail -50 | grep -oE '(BLOCK|üö´|–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è).*' | sort | uniq -c | sort -rn | head -20\r"
expect "# "

send "echo '=== –ü–†–ò–ú–ï–†–´ –ë–õ–û–ö–ò–†–û–í–û–ö –õ–ò–ö–í–ò–î–ù–û–°–¢–ò ==='\r"
expect "# "
send "grep '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å' bot_startup.log 2>/dev/null | tail -20\r"
expect "# "

send "echo '=== –ü–†–ò–ú–ï–†–´ –ë–õ–û–ö–ò–†–û–í–û–ö QUALITY SCORE ==='\r"
expect "# "
send "grep -E 'QUALITY.*BLOCK|quality.*block' bot_startup.log 2>/dev/null | tail -20\r"
expect "# "

send "echo '=== –ü–†–ò–ú–ï–†–´ –ë–õ–û–ö–ò–†–û–í–û–ö MTF ==='\r"
expect "# "
send "grep -E 'MTF.*BLOCK|mtf.*block' bot_startup.log 2>/dev/null | tail -20\r"
expect "# "

send "echo '=== –ü–†–ò–ú–ï–†–´ –ü–†–û–•–û–ñ–î–ï–ù–ò–Ø –§–ò–õ–¨–¢–†–û–í ==='\r"
expect "# "
send "grep -E 'PASS|‚úÖ.*PASS' bot_startup.log 2>/dev/null | tail -20\r"
expect "# "

send "echo '=== –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–ò–ì–ù–ê–õ–û–í ==='\r"
expect "# "
send "grep -E 'SIGNAL|—Å–∏–≥–Ω–∞–ª|LONG|SHORT' bot_startup.log 2>/dev/null | grep -v 'BLOCK' | tail -20\r"
expect "# "

send "echo '=== –ü–û–°–õ–ï–î–ù–ò–ï 50 –°–¢–†–û–ö –õ–û–ì–ê ==='\r"
expect "# "
send "tail -50 bot_startup.log\r"
expect "# "

send "exit\r"
expect eof

