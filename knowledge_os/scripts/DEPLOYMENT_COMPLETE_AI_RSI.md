# ‚úÖ –î–ï–ü–õ–û–ô –ó–ê–í–ï–†–®–ï–ù: –í–°–ï –ù–ê SMART RSI (AI)

**–î–∞—Ç–∞:** 2025-11-20  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–ê–î–ï–ü–õ–û–ï–ù–û**

---

## üöÄ –í–ù–ï–î–†–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –í–°–ï —Å–∏–º–≤–æ–ª—ã ‚Üí Smart RSI Filter (AI) ü§ñ

**–§–∞–π–ª:** `signal_live.py` —Å—Ç—Ä–æ–∫–∞ 1807

**–ë—ã–ª–æ:**
```python
def get_rsi_experiment_group(symbol: str, timestamp: Optional[datetime]) -> str:
    # 50% —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –≥—Ä—É–ø–ø–∞ A (Smart RSI)
    # 50% —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –≥—Ä—É–ø–ø–∞ B (Legacy)
    group_hash = _deterministic_hash(unique_key) % 100
    return "A" if group_hash < 50 else "B"
```

**–°—Ç–∞–ª–æ:**
```python
def get_rsi_experiment_group(symbol: str, timestamp: Optional[datetime]) -> str:
    # 100% —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –≥—Ä—É–ø–ø–∞ A (Smart RSI —Å AI)
    return "A"  # ü§ñ AI —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- **–ë—ã–ª–æ:** 50% Smart RSI + 50% Legacy (65/35)
- **–°—Ç–∞–ª–æ:** 100% Smart RSI (AI)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫:** 48.2% ‚Üí **~5-10%** (–æ–∂–∏–¥–∞–µ—Ç—Å—è)

---

### 2. ETH Trend –ø–æ—Ä–æ–≥ –ø–æ–≤—ã—à–µ–Ω –¥–æ 2%

**–§–∞–π–ª:** `src/signals/filters.py` —Å—Ç—Ä–æ–∫–∏ 213, 232

**–ë—ã–ª–æ:**
```python
if trend_strength > 0.01:  # 1% - –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –ø—Ä–∏ ETH 1.446%
    # –ë–ª–æ–∫–∏—Ä—É–µ–º
```

**–°—Ç–∞–ª–æ:**
```python
if trend_strength > 0.02:  # 2% - —Ä–∞–∑—Ä–µ—à–∏—Ç –ø—Ä–∏ ETH 1.446%
    # –ë–ª–æ–∫–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- **–ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫:** 6.1% ‚Üí **~1-2%** (–æ–∂–∏–¥–∞–µ—Ç—Å—è)

---

### 3. Legacy RSI –ø–æ—Ä–æ–≥–∏ (–¥–ª—è fallback)

**–§–∞–π–ª:** `signal_live.py` —Å—Ç—Ä–æ–∫–∏ 5794, 5802

**–ë—ã–ª–æ:**
```python
if signal_type == "BUY" and rsi_value > 65:  # –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ
if signal_type == "SELL" and rsi_value < 35:  # –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ
```

**–°—Ç–∞–ª–æ:**
```python
if signal_type == "BUY" and rsi_value > 70:  # –°—Ç–∞–Ω–¥–∞—Ä—Ç
if signal_type == "SELL" and rsi_value < 30:  # –°—Ç–∞–Ω–¥–∞—Ä—Ç
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- Legacy –≥—Ä—É–ø–ø–∞ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–≤—Å–µ –Ω–∞ –≥—Ä—É–ø–ø–µ A)
- –ù–æ –ø–æ—Ä–æ–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–ª—è fallback

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:
- **RSI Warning:** 2,694 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (48.2%)
  - Legacy –≥—Ä—É–ø–ø–∞ (B): 65/35 –ø–æ—Ä–æ–≥–∏
  - Smart RSI –≥—Ä—É–ø–ø–∞ (A): AI —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞
- **ETH Trend:** 394 –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (6.1%)
- **–°–∏–≥–Ω–∞–ª–æ–≤:** 0 –∑–∞ –¥–µ–Ω—å

### –ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (–æ–∂–∏–¥–∞–µ—Ç—Å—è):
- **RSI Warning:** ~300-600 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (~5-10%)
  - –í–°–ï –Ω–∞ Smart RSI (AI) ‚úÖ
  - AI –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç RSI —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- **ETH Trend:** ~50-100 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (~1-2%)
- **–°–∏–≥–Ω–∞–ª–æ–≤:** ~100-200 –∑–∞ –¥–µ–Ω—å

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤—á–µ—Ä–∞:
- **–í—á–µ—Ä–∞:** 286 —Å–∏–≥–Ω–∞–ª–æ–≤
- **–°–µ–≥–æ–¥–Ω—è (–æ–∂–∏–¥–∞–µ—Ç—Å—è):** ~100-200 —Å–∏–≥–Ω–∞–ª–æ–≤
- **–†–∞–∑–Ω–∏—Ü–∞:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ~50-70% –æ—Ç –≤—á–µ—Ä–∞

---

## ü§ñ SMART RSI FILTER (AI)

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

**–£—á–∏—Ç—ã–≤–∞–µ–º—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
1. **RSI –∑–Ω–∞—á–µ–Ω–∏–µ** (–±–∞–∑–æ–≤—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å)
2. **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞** (trend_strength > 0.7 ‚Üí +2.0 –±–∞–ª–ª–∞)
3. **–û–±—ä–µ–º** (volume_ratio > 1.5 ‚Üí +1.5 –±–∞–ª–ª–∞)
4. **AI —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å** (ai_confidence > 0.8 ‚Üí +1.0 –±–∞–ª–ª)
5. **BTC alignment** (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å BTC ‚Üí +1.0 –±–∞–ª–ª)

**–õ–æ–≥–∏–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:**
- RSI > 85 –∏–ª–∏ RSI < 15 ‚Üí **–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å** (—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –∑–æ–Ω–∞)
- RSI –≤ –∑–æ–Ω–µ 70-85 –∏–ª–∏ 15-30:
  - AI —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å < 0.6 ‚Üí **–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å**
  - –°—É–º–º–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ >= 3.0 ‚Üí **—Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π TP/SL**
  - –°—É–º–º–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ < 3.0 ‚Üí **–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å**
- RSI –≤–Ω–µ –∑–æ–Ω ‚Üí **—Ä–∞–∑—Ä–µ—à–∏—Ç—å**

**–ü—Ä–∏–º–µ—Ä—ã:**
```
‚úÖ RSI 72 + —Ç—Ä–µ–Ω–¥ 0.8 + –æ–±—ä–µ–º 1.8 + AI 0.9 + BTC ‚úì ‚Üí –†–ê–ó–†–ï–®–ò–¢–¨ (score=5.5)
‚ùå RSI 72 + —Ç—Ä–µ–Ω–¥ 0.3 + –æ–±—ä–µ–º 1.0 + AI 0.4 + BTC ‚úó ‚Üí –ë–õ–û–ö–ò–†–û–í–ê–¢–¨ (score=0)
‚ùå RSI 88 ‚Üí –ë–õ–û–ö–ò–†–û–í–ê–¢–¨ (—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –∑–æ–Ω–∞)
```

---

## üöÄ –î–ï–ü–õ–û–ô

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —à–∞–≥–∏:

1. ‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã:**
   - `signal_live.py`: –≥—Ä—É–ø–ø–∞ A –¥–ª—è –≤—Å–µ—Ö + Legacy –ø–æ—Ä–æ–≥–∏ 70/30
   - `src/signals/filters.py`: ETH –ø–æ—Ä–æ–≥ 2%

2. ‚úÖ **Git –∫–æ–º–º–∏—Ç:**
   ```bash
   git add signal_live.py src/signals/filters.py
   git commit -m "üîß URGENT FIX: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤—Å–µ –Ω–∞ Smart RSI (AI)"
   git push
   ```

3. ‚úÖ **–î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   cd /root/atra
   git pull
   pkill -f "python.*signal_live"
   nohup python signal_live.py > /dev/null 2>&1 &
   ```

4. ‚úÖ **–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω:**
   - –ü—Ä–æ—Ü–µ—Å—Å signal_live.py –∑–∞–ø—É—â–µ–Ω
   - –ü—Ä–æ—Ü–µ—Å—Å start_telegram_polling.py —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìà –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á–µ—Ä–µ–∑ 1 —á–∞—Å:

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ RSI Warning:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ~5-10% (–±—ã–ª–æ 48.2%)
   - –í—Å–µ —Å–∏–º–≤–æ–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Smart RSI (AI)

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ETH Trend:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ~1-2% (–±—ã–ª–æ 6.1%)
   - –ü–æ—Ä–æ–≥ 2% —Ä–∞–∑—Ä–µ—à–∏—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã

3. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ~5-10 —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ —á–∞—Å
   - –í—á–µ—Ä–∞ –±—ã–ª–æ: ~12 —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ —á–∞—Å (286/24)

### SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```sql
-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
SELECT filter_type, 
       SUM(CASE WHEN passed = 0 THEN 1 ELSE 0 END) as blocked,
       COUNT(*) as total,
       ROUND(SUM(CASE WHEN passed = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) as block_pct
FROM filter_checks 
WHERE created_at >= datetime('now', '-1 hour')
GROUP BY filter_type
ORDER BY blocked DESC;

-- –°–∏–≥–Ω–∞–ª—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
SELECT COUNT(*) as signals
FROM signals_log
WHERE created_at >= datetime('now', '-1 hour');
```

---

## ‚úÖ –°–¢–ê–¢–£–°

**–î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!** üéâ

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. ‚úÖ –í—Å–µ —Å–∏–º–≤–æ–ª—ã ‚Üí Smart RSI (AI)
2. ‚úÖ ETH Trend –ø–æ—Ä–æ–≥ ‚Üí 2%
3. ‚úÖ Legacy RSI ‚Üí 70/30 (fallback)
4. ‚úÖ Git push –≤—ã–ø–æ–ª–Ω–µ–Ω
5. ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω
6. ‚úÖ –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–∏–≥–Ω–∞–ª–æ–≤: 0 ‚Üí ~5-10 –≤ —á–∞—Å (~100-200 –≤ –¥–µ–Ω—å)
- –ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫ RSI: 48.2% ‚Üí ~5-10%
- –ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫ ETH: 6.1% ‚Üí ~1-2%

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑:** 1 —á–∞—Å

---

*–î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω 2025-11-20*

