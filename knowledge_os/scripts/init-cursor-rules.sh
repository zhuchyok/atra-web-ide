#!/bin/bash

# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ .cursorrules Ð´Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
# Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ: ./init-cursor-rules.sh [project-path]
# Ð˜Ð»Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð² .bashrc/.zshrc Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ°

set -e

PROJECT_PATH="${1:-$(pwd)}"
UNIVERSAL_RULES_PATH="$HOME/.cursor/universal-rules.md"
TEMPLATE_PATH="$HOME/.cursor/templates/project-template-rules.md"
CURSOR_RULES_FILE="$PROJECT_PATH/.cursorrules"

# Ð¦Ð²ÐµÑ‚Ð°
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
RED='\033[0;31m'
NC='\033[0m'

echo -e "${BLUE}ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Cursor Ð¿Ñ€Ð°Ð²Ð¸Ð»...${NC}"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð»Ð¸ ÑƒÐ¶Ðµ .cursorrules
if [ -f "$CURSOR_RULES_FILE" ]; then
    echo -e "${YELLOW}â„¹ï¸  Ð¤Ð°Ð¹Ð» .cursorrules ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚${NC}"
    echo -e "${YELLOW}   ÐŸÑƒÑ‚ÑŒ: $CURSOR_RULES_FILE${NC}"
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð»Ð¸ Ñ„Ð°Ð¹Ð» ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°
    if grep -q "ÐšÐžÐœÐÐÐ”Ð Ð­ÐšÐ¡ÐŸÐ•Ð Ð¢ÐžÐ’\|ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð²\|ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð²" "$CURSOR_RULES_FILE" 2>/dev/null; then
        echo -e "${GREEN}âœ… Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° ÑƒÐ¶Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ñ‹${NC}"
        
        # Ð•ÑÐ»Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð² Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ (Ð½ÐµÐ¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾), Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð²Ñ‹Ñ…Ð¾Ð´Ð¸Ð¼
        if [ -t 0 ] && [ -t 1 ]; then
            # Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ - ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÐ¼
            read -p "ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°? (y/N): " -n 1 -r
            echo
            if [[ ! $REPLY =~ ^[Yy]$ ]]; then
                exit 0
            fi
        else
            # ÐÐµÐ¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ - Ð½Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ñ„Ð°Ð¹Ð»
            exit 0
        fi
    else
        echo -e "${YELLOW}âš ï¸  Ð¤Ð°Ð¹Ð» ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚, Ð½Ð¾ Ð½Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»${NC}"
        
        # Ð’ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð±ÐµÐ· Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°
        if [ ! -t 0 ] || [ ! -t 1 ]; then
            echo -e "${BLUE}ðŸ“ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°...${NC}"
        else
            read -p "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°? (Y/n): " -n 1 -r
            echo
            if [[ $REPLY =~ ^[Nn]$ ]]; then
                exit 0
            fi
        fi
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½ÑƒÑŽ ÐºÐ¾Ð¿Ð¸ÑŽ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ñ„Ð°Ð¹Ð»Ð°
        BACKUP_FILE="${CURSOR_RULES_FILE}.backup.$(date +%Y%m%d_%H%M%S)"
        cp "$CURSOR_RULES_FILE" "$BACKUP_FILE"
        echo -e "${BLUE}ðŸ’¾ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð° Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð°Ñ ÐºÐ¾Ð¿Ð¸Ñ: $BACKUP_FILE${NC}"
    fi
fi

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ ÐµÑÐ»Ð¸ Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‚
mkdir -p "$HOME/.cursor/templates"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»
if [ ! -f "$UNIVERSAL_RULES_PATH" ]; then
    echo -e "${YELLOW}âš ï¸  Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹ Ð² $UNIVERSAL_RULES_PATH${NC}"
    echo -e "${BLUE}ðŸ“¥ ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»...${NC}"
    
    # Ð˜Ñ‰ÐµÐ¼ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ ATRA
    SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
    ATRA_EXAMPLES="$SCRIPT_DIR/../docs/examples/universal-cursor-rules.md"
    
    if [ -f "$ATRA_EXAMPLES" ]; then
        cp "$ATRA_EXAMPLES" "$UNIVERSAL_RULES_PATH"
        echo -e "${GREEN}âœ… Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹${NC}"
    else
        echo -e "${RED}âŒ ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°${NC}"
        echo -e "${YELLOW}   Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð»: $UNIVERSAL_RULES_PATH${NC}"
        exit 1
    fi
fi

# ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ñ‚Ð¸Ð¿ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
detect_project_type() {
    local path="$1"
    if [ -f "$path/package.json" ]; then
        echo "javascript/typescript"
    elif [ -f "$path/requirements.txt" ] || [ -f "$path/pyproject.toml" ]; then
        echo "python"
    elif [ -f "$path/Cargo.toml" ]; then
        echo "rust"
    elif [ -f "$path/go.mod" ]; then
        echo "go"
    elif [ -f "$path/pom.xml" ] || [ -f "$path/build.gradle" ]; then
        echo "java"
    else
        echo "generic"
    fi
}

PROJECT_NAME=$(basename "$PROJECT_PATH")
PROJECT_TYPE=$(detect_project_type "$PROJECT_PATH")

echo -e "${GREEN}ðŸ“¦ ÐŸÑ€Ð¾ÐµÐºÑ‚: $PROJECT_NAME${NC}"
echo -e "${GREEN}ðŸ“¦ Ð¢Ð¸Ð¿: $PROJECT_TYPE${NC}"

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ .cursorrules
echo -e "${BLUE}ðŸ“ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ .cursorrules...${NC}"

cat > "$CURSOR_RULES_FILE" << EOF
---
description: "Rules for $PROJECT_NAME project"
alwaysApply: true
---

# ÐŸÐ ÐÐ’Ð˜Ð›Ð ÐŸÐ ÐžÐ•ÐšÐ¢Ð: $PROJECT_NAME

## ðŸŒ Ð£ÐÐ˜Ð’Ð•Ð Ð¡ÐÐ›Ð¬ÐÐ«Ð• ÐŸÐ ÐÐ’Ð˜Ð›Ð

> **âš ï¸ Ð’ÐÐ–ÐÐž:** Ð­Ñ‚Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¸Ð· ÐµÐ´Ð¸Ð½Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ \`~/.cursor/universal-rules.md\`
> Ð”Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¾ Ð²ÑÐµÑ… Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ñ… Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ: \`./scripts/sync-cursor-rules.sh\`

EOF

# Ð’ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»
if [ -f "$UNIVERSAL_RULES_PATH" ]; then
    # ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼ frontmatter (ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð¼ÐµÐ¶Ð´Ñƒ ---)
    cat "$UNIVERSAL_RULES_PATH" | sed '/^---$/,/^---$/d' >> "$CURSOR_RULES_FILE"
else
    # Ð•ÑÐ»Ð¸ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹, Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐºÑ€Ð°Ñ‚ÐºÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ
    cat >> "$CURSOR_RULES_FILE" << 'UNIVERSAL_EOF'

### ðŸ‘¥ ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð²
ÐŸÑ€Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ð½Ð°Ð´ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð¼ **Ð’Ð¡Ð•Ð“Ð”Ð** Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ "ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¸Ð· 13 ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð²":
- **Ð’Ð¸ÐºÑ‚Ð¾Ñ€ (Team Lead)** - ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ†Ð¸Ñ Ð¸ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°
- **Ð˜Ð³Ð¾Ñ€ÑŒ (Backend Developer)** - Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð¸ Ñ‚ÐµÑÑ‚Ñ‹
- **ÐÐ½Ð½Ð° (QA Engineer)** - Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ > 80%)
- **ÐœÐ°ÐºÑÐ¸Ð¼ (Data Analyst)** - Ð°Ð½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
- **Ð•Ð»ÐµÐ½Ð° (Monitor)** - Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸
- **ÐÐ»ÐµÐºÑÐµÐ¹ (Security Engineer)** - Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ
- **Ð¡ÐµÑ€Ð³ÐµÐ¹ (DevOps)** - Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð¸ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°
- Ð˜ Ð´Ñ€ÑƒÐ³Ð¸Ðµ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ñ‹ (ÑÐ¼. ~/.cursor/universal-rules.md)

### ðŸŽ¯ ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ð¾Ð²
âŒ **ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž:** "Ð§Ñ‚Ð¾ Ñ‚Ñ‹ Ð´ÑƒÐ¼Ð°ÐµÑˆÑŒ Ð¾Ð± ÑÑ‚Ð¾Ð¼?"
âœ… **ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž:** "ÐšÐ°ÐºÐ¸Ðµ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ñ‹ Ð¸Ð· ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ [Ñ‚ÐµÐ¼Ð°]? Ð§Ñ‚Ð¾ Ð±Ñ‹ ÑÐºÐ°Ð·Ð°Ð»Ð¸ [Ð­ÐºÑÐ¿ÐµÑ€Ñ‚1], [Ð­ÐºÑÐ¿ÐµÑ€Ñ‚2] Ð¸ [Ð­ÐºÑÐ¿ÐµÑ€Ñ‚3]?"

### ðŸ“‹ ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹
- Code Quality: type hints, Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ, Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%
- Security: Ð½Ðµ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¸Ñ‚ÑŒ ÑÐµÐºÑ€ÐµÑ‚Ñ‹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ env variables
- Performance: Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ latency, async/await Ð´Ð»Ñ I/O
- Stateless: Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ‚ÑŒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹
- UTC: Ð²ÑÐµÐ³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ UTC Ð´Ð»Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¼ÐµÑ‚Ð¾Ðº
- Retry: Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð°Ñ retry Ð»Ð¾Ð³Ð¸ÐºÐ° Ñ exponential backoff

> ðŸ’¡ **Ð”Ð»Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ñ… ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð» ÑÐ¼.:** \`~/.cursor/universal-rules.md\`

UNIVERSAL_EOF
fi

cat >> "$CURSOR_RULES_FILE" << 'EOF'

---

## ðŸŽ¯ Ð¡ÐŸÐ•Ð¦Ð˜Ð¤Ð˜Ð§ÐÐ«Ð• Ð”Ð›Ð¯ ÐŸÐ ÐžÐ•ÐšÐ¢Ð ÐŸÐ ÐÐ’Ð˜Ð›Ð

### Ð¢Ð¸Ð¿ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°: $PROJECT_TYPE

EOF

# Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¸Ð¿Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
case $PROJECT_TYPE in
    "python")
        cat >> "$CURSOR_RULES_FILE" << 'PYTHON_EOF'

### Python Code Style:
- PEP 8 compliance
- Black formatting (ÐµÑÐ»Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½)
- Type hints Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹ Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
- Docstrings Ð´Ð»Ñ Ð²ÑÐµÑ… Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¸ ÐºÐ»Ð°ÑÑÐ¾Ð²

### Python Testing:
- pytest Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ fixtures Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
- Mock Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸

### Python Dependencies:
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ requirements.txt Ð¸Ð»Ð¸ pyproject.toml
- Ð—Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
- Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÑ‚ÑŒ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚Ð¸

PYTHON_EOF
        ;;
    "javascript/typescript")
        cat >> "$CURSOR_RULES_FILE" << 'JS_EOF'

### TypeScript/JavaScript Code Style:
- TypeScript strict mode (ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ TS)
- ESLint + Prettier
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ (ES6+)
- Ð˜Ð·Ð±ÐµÐ³Ð°Ñ‚ÑŒ any Ñ‚Ð¸Ð¿Ð¾Ð²

### Testing:
- Jest Ð¸Ð»Ð¸ Vitest Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
- React Testing Library (ÐµÑÐ»Ð¸ React Ð¿Ñ€Ð¾ÐµÐºÑ‚)
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%
- Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ, Ð½Ðµ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ

JS_EOF
        ;;
    "rust")
        cat >> "$CURSOR_RULES_FILE" << 'RUST_EOF'

### Rust Code Style:
- Ð¡Ð»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ rustfmt
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ clippy Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸
- ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ ÑÐ²Ð½Ð¾
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Result Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¾ÑˆÐ¸Ð±Ð¾Ðº

### Rust Testing:
- Unit Ñ‚ÐµÑÑ‚Ñ‹ Ð² Ð¼Ð¾Ð´ÑƒÐ»ÑÑ…
- Integration Ñ‚ÐµÑÑ‚Ñ‹ Ð² tests/
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%

RUST_EOF
        ;;
    "go")
        cat >> "$CURSOR_RULES_FILE" << 'GO_EOF'

### Go Code Style:
- Ð¡Ð»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ gofmt
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ golint Ð¸ go vet
- Ð˜Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ: ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ñ Ð·Ð°Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ Ð±ÑƒÐºÐ²Ñ‹
- ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ ÑÐ²Ð½Ð¾

### Go Testing:
- go test Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ table-driven tests

GO_EOF
        ;;
    *)
        cat >> "$CURSOR_RULES_FILE" << 'GENERIC_EOF'

### ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°:
- Ð¡Ð»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð°Ð¼ ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð»Ñ ÑÐ·Ñ‹ÐºÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ > 80%
- Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ API
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð»Ð¸Ð½Ñ‚ÐµÑ€Ñ‹ Ð¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‚ÐµÑ€Ñ‹

GENERIC_EOF
        ;;
esac

# Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐµÐºÑ†Ð¸ÑŽ Ð´Ð»Ñ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
cat >> "$CURSOR_RULES_FILE" << 'EOF'

---

## ðŸ“ Ð¡Ð¢Ð Ð£ÐšÐ¢Ð£Ð Ð ÐŸÐ ÐžÐ•ÐšÐ¢Ð

[ÐžÐ¿Ð¸ÑˆÐ¸Ñ‚Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð·Ð´ÐµÑÑŒ]

## ðŸ”§ Ð¢Ð•Ð¥ÐÐžÐ›ÐžÐ“Ð˜Ð˜

[ÐŸÐµÑ€ÐµÑ‡Ð¸ÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸ Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹]

## ðŸ§ª Ð¢Ð•Ð¡Ð¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð•

- Ð¤Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº: [ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²]
- ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ: > 80%
- ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð·Ð°Ð¿ÑƒÑÐºÐ°: [make test / npm test / pytest / etc]

## ðŸš€ Ð”Ð•ÐŸÐ›ÐžÐ™

[ÐžÐ¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ð´ÐµÐ¿Ð»Ð¾Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°]

---

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸:** $(date +"%Y-%m-%d %H:%M:%S")
**Ð’ÐµÑ€ÑÐ¸Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»:** 1.0
**Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°:** ~/.cursor/universal-rules.md
EOF

echo -e "${GREEN}âœ… Ð¤Ð°Ð¹Ð» .cursorrules ÑÐ¾Ð·Ð´Ð°Ð½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!${NC}"
echo -e "${GREEN}ðŸ“„ ÐŸÑƒÑ‚ÑŒ: $CURSOR_RULES_FILE${NC}"
echo -e "${YELLOW}ðŸ“ ÐÐµ Ð·Ð°Ð±ÑƒÐ´ÑŒÑ‚Ðµ Ð¾Ñ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð¸ Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°${NC}"

# ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÐ¼ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»
if command -v code &> /dev/null; then
    echo -e "${BLUE}ðŸ’¡ ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð² Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€Ðµ: code $CURSOR_RULES_FILE${NC}"
fi

