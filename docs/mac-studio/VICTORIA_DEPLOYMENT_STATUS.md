# üöÄ –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π Victoria

**–î–∞—Ç–∞:** 2026-01-25  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ö–û–î –†–ï–ê–õ–ò–ó–û–í–ê–ù, –ö–û–ù–¢–ï–ô–ù–ï–† –û–ë–ù–û–í–õ–ï–ù**

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞
- ‚úÖ –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `src/agents/bridge/victoria_server.py`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Knowledge OS
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —ç–∫—Å–ø–µ—Ä—Ç–æ–≤
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `docker-compose.yml` —Å env vars
- ‚úÖ `USE_KNOWLEDGE_OS=true`
- ‚úÖ `VICTORIA_USE_CACHE=true`

### 3. Docker –æ–±—Ä–∞–∑
- ‚úÖ –û–±—Ä–∞–∑ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
- ‚úÖ asyncpg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Dockerfile

---

## üîß –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ docker-compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd /Users/zhuchyok/Documents/atra-web-ide

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑
docker-compose -f knowledge_os/docker-compose.yml build victoria-agent

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ victoria-agent (–±–µ–∑ db, –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞)
docker-compose -f knowledge_os/docker-compose.yml up -d victoria-agent
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  --name victoria-agent \
  --network atra-network \
  -p 8010:8000 \
  -e PYTHONPATH=/app \
  -e DATABASE_URL=postgresql://admin:secret@knowledge_os_db:5432/knowledge_os \
  -e OLLAMA_BASE_URL=http://host.docker.internal:11434 \
  -e USE_KNOWLEDGE_OS=true \
  -e VICTORIA_USE_CACHE=true \
  -e USE_ELK=true \
  -e ELASTICSEARCH_URL=http://atra-elasticsearch:9200 \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/src:/app/src \
  knowledge_os-victoria-agent:latest \
  python -m src.agents.bridge.victoria_server
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
curl http://localhost:8010/status
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "status": "online",
  "agent": "–í–∏–∫—Ç–æ—Ä–∏—è",
  "knowledge_os_enabled": true,
  "experts_loaded": true,
  "experts_count": 58,
  "cache_enabled": true,
  "cache_size": 0
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ health

```bash
curl http://localhost:8010/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{"status":"ok","agent":"–í–∏–∫—Ç–æ—Ä–∏—è"}
```

### 3. –¢–µ—Å—Ç –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏

```bash
curl -X POST http://localhost:8010/run \
  -H "Content-Type: application/json" \
  -d '{"goal": "—Å–∫–∞–∂–∏ –ø—Ä–∏–≤–µ—Ç"}'
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
docker logs victoria-agent --tail 30
```

**–û–∂–∏–¥–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
- `‚úÖ Knowledge OS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞`
- `‚úÖ Knowledge OS Database pool —Å–æ–∑–¥–∞–Ω`
- `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ X —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –∏–∑ Knowledge OS`

---

## üîç –£–°–¢–†–ê–ù–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç 5432 –∑–∞–Ω—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç
docker ps | grep 5432

# –ï—Å–ª–∏ —ç—Ç–æ knowledge_os_db - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ
# –ï—Å–ª–∏ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ docker-compose.yml
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker logs victoria-agent

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å
docker network ls | grep atra-network

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–µ—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
docker network create atra-network
```

### –ü—Ä–æ–±–ª–µ–º–∞: Knowledge OS –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker exec victoria-agent python3 -c "
import asyncio
import asyncpg
import os

async def test():
    try:
        pool = await asyncpg.create_pool(os.getenv('DATABASE_URL'))
        print('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ')
        await pool.close()
    except Exception as e:
        print(f'‚ùå –û—à–∏–±–∫–∞: {e}')

asyncio.run(test())
"
```

---

## üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

- ‚úÖ **–ö–æ–¥:** –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ **–û–±—Ä–∞–∑:** –ü–µ—Ä–µ—Å–æ–±—Ä–∞–Ω —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** Env vars –¥–æ–±–∞–≤–ª–µ–Ω—ã
- üîÑ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä:** –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Victoria** —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å** —á–µ—Ä–µ–∑ `/status` endpoint
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤—ã–±–æ—Ä —ç–∫—Å–ø–µ—Ä—Ç–æ–≤)
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ 2026-01-25*
