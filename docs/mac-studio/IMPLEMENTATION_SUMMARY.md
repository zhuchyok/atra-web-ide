# üìä –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ELK —Å—Ç–µ–∫–∞ –∏ Grafana

**–î–∞—Ç–∞:** 2026-01-25  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê**

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### 1. Prometheus + Grafana

#### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- ‚úÖ `knowledge_os/docker-compose.yml` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã Prometheus –∏ Grafana
- ‚úÖ `infrastructure/monitoring/prometheus.yml` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `knowledge_os/app/main.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `/metrics` endpoint

#### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:
- Prometheus –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- Grafana –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –¥–∞—à–±–æ—Ä–¥–æ–º
- `/metrics` endpoint —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
- –í—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ç–∏ `atra-network`

---

### 2. ELK —Å—Ç–µ–∫ (Elasticsearch + Kibana)

#### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã/–∏–∑–º–µ–Ω–µ–Ω—ã:
- ‚úÖ `knowledge_os/app/elk_handler.py` ‚Äî –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π ELK handler
- ‚úÖ `knowledge_os/src/shared/utils/logger.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ELK
- ‚úÖ `knowledge_os/docker-compose.yml` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã Elasticsearch –∏ Kibana

#### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:
- Elasticsearch –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
- Kibana –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ELKHandler —Å –±–∞—Ç—á–∏–Ω–≥–æ–º –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## üìã –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### Docker Compose:

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `knowledge_os/docker-compose.yml`:
- `atra-prometheus` (–ø–æ—Ä—Ç 9090)
- `atra-grafana` (–ø–æ—Ä—Ç 3000)
- `atra-elasticsearch` (–ø–æ—Ä—Ç 9200)
- `atra-kibana` (–ø–æ—Ä—Ç 5601)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è ELK –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```yaml
environment:
  - USE_ELK=true
  - ELASTICSEARCH_URL=http://atra-elasticsearch:9200
```

---

## üöÄ –ó–ê–ü–£–°–ö

### –ö–æ–º–∞–Ω–¥—ã:

```bash
# –ó–∞–ø—É—Å–∫ Prometheus –∏ Grafana
docker-compose -f knowledge_os/docker-compose.yml up -d prometheus grafana

# –ó–∞–ø—É—Å–∫ ELK —Å—Ç–µ–∫–∞
docker-compose -f knowledge_os/docker-compose.yml up -d elasticsearch kibana

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker ps | grep -E "(prometheus|grafana|elastic|kibana)"
```

### –î–æ—Å—Ç—É–ø:

- **Prometheus:** http://localhost:9090
- **Grafana:** http://localhost:3000 (admin/atra2025)
- **Elasticsearch:** http://localhost:9200
- **Kibana:** http://localhost:5601

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** –∫–æ–º–∞–Ω–¥–∞–º–∏ –≤—ã—à–µ
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana:**
   - –î–æ–±–∞–≤–∏—Ç—å Prometheus datasource
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞—à–±–æ—Ä–¥
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Kibana:**
   - –°–æ–∑–¥–∞—Ç—å index pattern `atra-logs-*`
   - –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã
5. **–í–∫–ª—é—á–∏—Ç—å ELK –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –î–æ–±–∞–≤–∏—Ç—å `USE_ELK=true` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

---

## ‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

### –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- üìä **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫** —á–µ—Ä–µ–∑ Grafana
- üîç **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ª–æ–≥–æ–≤** —á–µ—Ä–µ–∑ Kibana
- üö® **–ê–ª–µ—Ä—Ç—ã** –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤
- üìà **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –∏ —Ç—Ä–µ–Ω–¥–æ–≤
- üéØ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–ª—è —Ä–æ—Å—Ç–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏

---

*–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –æ–±–¥—É–º–∞–Ω–Ω–æ –∏ –ø–æ—à–∞–≥–æ–≤–æ 2026-01-25*
