# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 429 –æ—à–∏–±–æ–∫ –Ω–∞ /api/tags

**–î–∞—Ç–∞:** 2026-01-27  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ß–∞—Å—Ç—ã–µ 429 –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ rate limiting –Ω–∞ `/api/tags`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

---

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–í –ª–æ–≥–∞—Ö MLX API Server —á–∞—Å—Ç—ã–µ 429 –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ `/api/tags`:
- `check_health()` –≤ `local_router.py` - –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- `_get_available_models()` –≤ `extended_thinking.py` - –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- `check_model_available()` –≤ `model_selector.py` - –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –î—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–∞–∫–∂–µ –¥–µ–ª–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –£–≤–µ–ª–∏—á–µ–Ω TTL –∫—ç—à–∞ –≤ `check_health()`

**–§–∞–π–ª:** `knowledge_os/app/local_router.py`

- ‚úÖ TTL —É–≤–µ–ª–∏—á–µ–Ω —Å **30 —Å–µ–∫—É–Ω–¥ –¥–æ 120 —Å–µ–∫—É–Ω–¥** (2 –º–∏–Ω—É—Ç—ã)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–µ–≥–∫–∏–π `/health` endpoint –≤–º–µ—Å—Ç–æ `/api/tags` –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ Fallback –Ω–∞ `/api/tags` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `/health` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### 2. –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MLX API Server

**–§–∞–π–ª:** `knowledge_os/app/mlx_api_server.py`

- ‚úÖ –ö—ç—à –¥–ª—è `/api/tags` –Ω–∞ **60 —Å–µ–∫—É–Ω–¥**
- ‚úÖ Rate limiting –¥–ª—è `/api/tags`: **60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É** (1 –∑–∞–ø—Ä–æ—Å/—Å–µ–∫)
- ‚úÖ –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `extended_thinking.py`

**–§–∞–π–ª:** `knowledge_os/app/extended_thinking.py`

- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à `_models_cache` —Å TTL **120 —Å–µ–∫—É–Ω–¥**
- ‚úÖ –û–±–∞ –º–µ—Ç–æ–¥–∞ `_get_available_models()` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à
- ‚úÖ Fallback –Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### 4. –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `model_selector.py`

**–§–∞–π–ª:** `knowledge_os/app/model_selector.py`

- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à `_models_cache` —Å TTL **120 —Å–µ–∫—É–Ω–¥**
- ‚úÖ `check_model_available()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
- ‚úÖ Fallback –Ω–∞ –∫—ç—à –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/tags` –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –∏–∑ `check_health()`
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –ù–µ—Ç rate limiting –¥–ª—è `/api/tags`
- ‚ùå 429 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/tags` –º–∞–∫—Å–∏–º—É–º —Ä–∞–∑ –≤ 60-120 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- ‚úÖ Rate limiting: 60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –¥–ª—è `/api/tags`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–µ–≥–∫–æ–≥–æ `/health` endpoint –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ Fallback –Ω–∞ –∫—ç—à –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üéØ –ò—Ç–æ–≥

**–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:**
- ‚úÖ `local_router.py` - —É–≤–µ–ª–∏—á–µ–Ω TTL, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/health`
- ‚úÖ `mlx_api_server.py` - –∫—ç—à + rate limiting –¥–ª—è `/api/tags`
- ‚úÖ `extended_thinking.py` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π
- ‚úÖ `model_selector.py` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥–µ–ª–µ–π

**429 –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å!** üéâ
