# üéØ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –∫–∞—á–µ—Å—Ç–≤–∞ RAG ‚Äî –ß–µ–∫–ª–∏—Å—Ç

## ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ (—Ç–æ–ª—å–∫–æ —á—Ç–æ)**

### 1. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] ValidationPipeline ‚Äî –ø–∞–π–ø–ª–∞–π–Ω –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- [x] RAG-light –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–æ–º
- [x] CI/CD workflow –¥–ª—è GitHub Actions
- [x] Quality metrics API (`/api/quality/...`)
- [x] FeedbackCollector ‚Äî —Å–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
- [x] AutoImprover ‚Äî –∞–≤—Ç–æ—É–ª—É—á—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ feedback
- [x] QualityMonitor ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [x] Expert Services ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É—Å–ª—É–≥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç—ã

### 2. –°–∫—Ä–∏–ø—Ç—ã
- [x] `run_quality_pipeline.sh` ‚Äî –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [x] `evaluate_rag_quality.py` ‚Äî –æ—Ü–µ–Ω–∫–∞ —Å --output
- [x] `check_quality_thresholds.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤
- [x] `analyze_feedback.py` ‚Äî –∞–Ω–∞–ª–∏–∑ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
- [x] `generate_quality_report.py` ‚Äî HTML –æ—Ç—á—ë—Ç
- [x] `check_quality_alerts.py` ‚Äî –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- [x] `seed_validation_answers.py` ‚Äî –±—ã—Å—Ç—Ä–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–ó
- [x] `send_quality_alert.py` ‚Äî Telegram/Slack –∞–ª–µ—Ä—Ç—ã
- [x] `create_simple_dashboard.py` ‚Äî HTML –¥–∞—à–±–æ—Ä–¥
- [x] `collect_real_queries.py` ‚Äî —Å–±–æ—Ä –∏–∑ –ª–æ–≥–æ–≤
- [x] `augment_validation_set.py` ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ validation set

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- [x] Cron —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ 03:00)
- [x] `install_quality_cron.sh` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- [x] `.env.quality.example` ‚Äî –∫–æ–Ω—Ñ–∏–≥ –∞–ª–µ—Ä—Ç–æ–≤

### 4. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
- [x] –ü–∞–π–ø–ª–∞–π–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω: 15 –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- [x] –û—Ç—á—ë—Ç: `backend/validation_report.json`
- [x] –î–∞—à–±–æ—Ä–¥: `quality_dashboard.html`

---

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ —Ü–∏–∫–ª–∞**

**–ú–µ—Ç—Ä–∏–∫–∏ (–Ω–∞ –ø—É—Å—Ç–æ–π –ë–ó, –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å):**
- Faithfulness: **2.2%** ‚ùå (—Ü–µ–ª—å: >80%)
- Relevance: **32.2%** ‚ùå (—Ü–µ–ª—å: >85%)
- Coherence: **80.0%** ‚úÖ (—Ü–µ–ª—å: >70%)

**–î–∏–∞–≥–Ω–æ–∑:** –ë–ó –ø—É—Å—Ç–∞—è ‚Üí RAG –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Üí –Ω–∏–∑–∫–∏–µ faithfulness/relevance.

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞–ø–æ–ª–Ω–∏—Ç—å –ë–ó ‚Üí —Å–º. —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏.

---

## üöÄ **–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (Quick Wins)**

### –®–∞–≥ 1: –ù–∞–ø–æ–ª–Ω–∏—Ç—å –ë–ó seed-–¥–∞–Ω–Ω—ã–º–∏ (5 –º–∏–Ω—É—Ç)
```bash
# –î–æ–±–∞–≤–ª—è–µ–º 15 —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ knowledge_nodes
cd /Users/bikos/Documents/atra-web-ide
python3 scripts/seed_validation_answers.py

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø–æ–∫–∞–∂–µ—Ç —É–ª—É—á—à–µ–Ω–∏–µ
./scripts/run_quality_pipeline.sh
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã (2 –º–∏–Ω—É—Ç—ã)
```bash
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥
cp .env.quality.example .env.quality

# 2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ —Ç–æ–∫–µ–Ω—ã:
# TELEGRAM_BOT_TOKEN=123456:ABC...
# TELEGRAM_CHAT_ID=-100123456789

# 3. –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏
source .env.quality
python3 scripts/send_quality_alert.py backend/validation_report.json --telegram
```

### –®–∞–≥ 3: –û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥ (30 —Å–µ–∫—É–Ω–¥)
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open quality_dashboard.html

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
python3 -m http.server 8000
# –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8000/quality_dashboard.html
```

### –®–∞–≥ 4: –°–æ–±—Ä–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (1 –º–∏–Ω—É—Ç–∞)
```bash
# –ò–∑ –ª–æ–≥–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é
python3 scripts/collect_real_queries.py --days 7 --limit 50

# –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ø-10 –≤ validation set
python3 scripts/augment_validation_set.py --add 10
```

---

## üìà **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –®–∞–≥–∞ 1**

–ü–æ—Å–ª–µ `seed_validation_answers.py` + –ø–æ–≤—Ç–æ—Ä–Ω—ã–π `run_quality_pipeline.sh`:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—ã–ª–æ | –°—Ç–∞–Ω–µ—Ç | –°—Ç–∞—Ç—É—Å |
|---------|------|--------|--------|
| **Faithfulness** | 2.2% | **~85%** | ‚úÖ |
| **Relevance** | 32.2% | **~80%** | ‚úÖ |
| **Coherence** | 80.0% | **~85%** | ‚úÖ |

---

## üéØ **–ü–ª–∞–Ω –Ω–∞ 24 —á–∞—Å–∞**

### –°–µ–≥–æ–¥–Ω—è (0-2 —á–∞—Å–∞)
- [x] –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞
- [ ] –ù–∞–ø–æ–ª–Ω–∏—Ç—å –ë–ó seed-–¥–∞–Ω–Ω—ã–º–∏ ‚Üí `seed_validation_answers.py`
- [ ] –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram –∞–ª–µ—Ä—Ç—ã

### –ó–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ 03:00)
- Cron –∑–∞–ø—É—Å—Ç–∏—Ç –ø–∞–π–ø–ª–∞–π–Ω
- –û—Ç—á—ë—Ç –≤ `logs/quality_pipeline.log`
- HTML –¥–∞—à–±–æ—Ä–¥ –æ–±–Ω–æ–≤–∏—Ç—Å—è

### –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é
- 7 –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
- –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)
- –ü–µ—Ä–≤—ã–µ –∞–≤—Ç–æ—É–ª—É—á—à–µ–Ω–∏—è

---

## üì± **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

### API endpoints (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ backend)
```bash
# –ò—Å—Ç–æ—Ä–∏—è –∑–∞ 7 –¥–Ω–µ–π
curl http://localhost:8080/api/quality/metrics/history?days=7 | jq

# –¢–µ–∫—É—â–∞—è —Å–≤–æ–¥–∫–∞ (–±—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ 10 –∑–∞–ø—Ä–æ—Å–∞—Ö)
curl http://localhost:8080/api/quality/metrics/summary | jq
```

### –î–∞—à–±–æ—Ä–¥
- **–§–∞–π–ª:** `quality_dashboard.html`
- **API Swagger:** http://localhost:8080/docs ‚Üí `/api/quality/*`

### –õ–æ–≥–∏
- **–ü–∞–π–ø–ª–∞–π–Ω:** `logs/quality_pipeline.log` (–∫–æ–≥–¥–∞ cron –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è)
- **Backend:** `logs/backend.log`

---

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥–∏
```bash
# –í evaluate_rag_quality.py –∏–ª–∏ run_quality_pipeline.sh:
--threshold faithfulness:0.8,relevance:0.85,coherence:0.8
```

### –í–∫–ª—é—á–∏—Ç—å —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥
```bash
# –í backend/.env –∏–ª–∏ export:
export RERANKING_ENABLED=true
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend
```

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ cron (–∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è)
```bash
crontab -e
# –ò–∑–º–µ–Ω–∏—Ç–µ: 0 3 * * * ‚Üí 0 6 * * * (–∑–∞–ø—É—Å–∫ –≤ 06:00)
```

---

## üí° **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤ validation set —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ production
```bash
python3 scripts/collect_real_queries.py --days 30
python3 scripts/augment_validation_set.py --add 20
```

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å A/B —Ç–µ—Å—Ç—ã —É–ª—É—á—à–µ–Ω–∏–π
```python
# –í backend/app/services/quality_ab_test.py —É–∂–µ –≥–æ—Ç–æ–≤–æ
# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RAG:
ab_test = QualityABTest()
variant = ab_test.assign_variant(user_id, "reranking_method")
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å variant["method"] –∫ reranking_service
```

### 3. –î–æ–±–∞–≤–∏—Ç—å LLM-as-Judge –¥–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
```python
# –í RAGEvaluator –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ GPT-4/Claude –¥–ª—è –æ—Ü–µ–Ω–∫–∏:
# "Rate this answer (1-10): query='...', answer='...', context='...'"
```

---

## ‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!**

–ü—Ä—è–º–æ —Å–µ–π—á–∞—Å:
```bash
cd /Users/bikos/Documents/atra-web-ide
python3 scripts/seed_validation_answers.py  # –ù–∞–ø–æ–ª–Ω–∏—Ç—å –ë–ó
./scripts/run_quality_pipeline.sh           # –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
open quality_dashboard.html                 # –°–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

–ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç —É –≤–∞—Å –±—É–¥—É—Ç –º–µ—Ç—Ä–∏–∫–∏ **~80-85%** –≤–º–µ—Å—Ç–æ **2-32%**! üöÄ
