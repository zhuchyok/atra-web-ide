# Выводы куратора 2026-02-10

**Последний отчёт:** [curator_2026-02-10_00-38-32.json](curator_2026-02-10_00-38-32.json) — полный прогон после обновления RAG (5 задач, все success).

---

## Сравнение с эталонами (отчёт 00-38-32)

| Задача | Эталон | Совпадений | Комментарий |
|--------|--------|------------|-------------|
| привет | greeting | **5/5** | Ответ по эталону |
| какой статус проекта? | status_project | **0/3** | Ответ по-прежнему галлюцинация («небольшиmi отчетами...»); нет «дашборд», «MASTER_REFERENCE». RAG узел обновлён — проверить подтягивание контекста в enhanced (запрос к БЗ по «статус проекта»). |
| покажи список файлов | list_files | 0/4 по фразам | Success по смыслу (вывод ls). |
| что ты умеешь? | what_can_you_do | **8/9** | Ответ по существу |
| одна строка кода (Python, дата) | one_line_code | — | В этом прогоне задача завершилась за 7.5 с; в превью ответа — «не могу подключиться к моделям» (возможен fallback в части запросов). |

---

## Что сделано 2026-02-10

1. **Два полных прогона** — 00-21-17 и 00-38-32; RAG узел status_project обновлён (`--update-status`).
2. **Сравнение со всеми эталонами** по отчёту 00-38-32.
3. **launchd:** включён ежедневный прогон куратора в 9:00 (`setup_curator_launchd.sh`); в plist добавлен `CURATOR_MAX_WAIT=900`. Логи: `~/Library/Logs/atra-curator.log`.
4. **Таймаут enhanced:** в Docker уже не менее 90 с; «одна строка кода» в последнем прогоне — 7.5 с (увеличение таймаута не требуется).

---

## Причина 0/3 по эталону «какой статус проекта?» (разбор с экспертами)

- **Backend (Игорь):** В методе **simple** в `victoria_enhanced.py` промпт собирался только из роли и запроса пользователя. **Запроса к knowledge_nodes (RAG) не было** — эталоны из домена `curator_standards` нигде не подмешивались в контекст LLM.
- **QA (Анна):** Сравнение с эталоном проверяет наличие ключевых фраз («дашборд», «MASTER_REFERENCE», формулировка из эталона). Модель получала только «Запрос: какой статус проекта?» и отвечала из своих весов → галлюцинация.
- **Итог:** RAG-узел status_project был обновлён (`--update-status`), но **enhanced при simple-методе его не запрашивал**.

## Внесённое решение (2026-02-10)

- В **victoria_enhanced.py** добавлен метод **`_get_curator_rag_context(goal)`**: по запросу (ключевые слова «статус», «дашборд», «что умеешь» и т.д.) выполняется запрос к `knowledge_nodes` в домене **curator_standards**; возвращается содержимое эталона (до 2000 символов).
- В ветке **simple** при сборке универсального промпта (не coding, не приветствие) перед «Запрос: {goal}» подмешивается блок «По базе знаний (эталон): …» с результатом `_get_curator_rag_context(goal)`, и в инструкции добавлен пункт: опираться на контекст из базы знаний, не придумывать сроки.
- После деплоя перезапустить victoria-agent и повторить прогон куратора; сравнение по эталону status_project должно дать 3/3 или близко.

## Рекомендации

- После перезапуска Victoria прогнать куратора и сравнение: `python3 scripts/curator_compare_to_standard.py --report docs/curator_reports/curator_*.json --standard status_project`.
- Регулярно смотреть отчёты после 9:00 (launchd).

---

*Связь: CURATOR_RUNBOOK, WHATS_NOT_DONE «Действия сейчас», VERIFICATION_2026-02-10.*

**Совместный разбор куратора и наставника** (причины неправильной работы с экспертами и мировыми практиками): [CURATOR_MENTOR_CAUSES.md](CURATOR_MENTOR_CAUSES.md).
