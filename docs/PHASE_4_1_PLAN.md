# –§–∞–∑–∞ 4.1: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** (31.01.2026)

## ‚úÖ –°–¥–µ–ª–∞–Ω–æ

### 1. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–°–∫—Ä–∏–ø—Ç:** `scripts/analyze_low_relevance.py`
- **–ó–∞–ø—É—Å–∫:** `python scripts/analyze_low_relevance.py [threshold]`
- **–í—ã—Ö–æ–¥:** `problematic_queries_analysis.json`

### 2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (—Ç–µ–∫—É—â–∏–µ)
- **–ü—Ä–æ–±–ª–µ–º–Ω—ã—Ö (relevance < 80%):** 4 –∏–∑ 15
- **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ (relevance = 0%):** "–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Victoria", "–º–µ—Ç—Ä–∏–∫–∏ Prometheus"
- **–ö–æ—Ä–æ—Ç–∫–∏–µ (rel 61‚Äì77%):** "—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ø–æ–¥–ø–∏—Å–∫–∞", "—Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é"

### 3. –£–ª—É—á—à–µ–Ω–∏—è query expansion
- –†–∞—Å—à–∏—Ä–µ–Ω—ã —Ç–µ—Ä–º–∏–Ω—ã –¥–ª—è "–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Victoria" –∏ "–º–µ—Ç—Ä–∏–∫–∏ Prometheus"
- –î–æ–±–∞–≤–ª–µ–Ω—ã fallback –¥–ª—è "victoria" –∏ "prometheus"

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–µ–Ω—å 1‚Äì2: –§–∏–∫—Å—ã
- [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å `analyze_low_relevance.py`
- [x] –£–ª—É—á—à–∏—Ç—å query expansion –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [x] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞–π–ø–ª–∞–π–Ω –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
- [x] `analyze_coherence_issues.py` ‚Äî –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞: –æ—Ç–≤–µ—Ç—ã –±–µ–∑ —Ç–æ—á–∫–∏
- [x] –§–∏–∫—Å: `_truncate_response` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ –æ—Ç–≤–µ—Ç–∞

### –î–µ–Ω—å 3‚Äì4: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ validation set
- [x] –°–æ–±—Ä–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã: `collect_real_queries.py` (—É–ª—É—á—à–µ–Ω: –ø–∞—Ä—Å–∏–Ω–≥ JSON, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî Data Engineer)
- [x] –°–æ–∑–¥–∞—Ç—å `generate_query_variations.py` (—Å–∏–Ω—Ç–µ—Ç–∏–∫–∞; QA: –ø–æ–∫—Ä—ã—Ç–∏–µ, Technical Writer: —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏)
- [x] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å: `merge_validation_sources.py` (Data Engineer: –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –∫–ª—é—á—É)

### –î–µ–Ω—å 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [x] AdvancedQualityMonitor —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π –∞–Ω–æ–º–∞–ª–∏–π (–ø–æ—Ä–æ–≥–∏ QA + z-score –ø–æ –∏—Å—Ç–æ—Ä–∏–∏; SRE: –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ validation_report)
- [x] –î–∞—à–±–æ—Ä–¥ v2: –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º, –±–ª–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤ (SRE: –¥–∞—à–±–æ—Ä–¥ –∫–∞–∫ –∫–æ–¥)

### –î–µ–Ω—å 6: Self-healing
- [x] –û—á–∏—Å—Ç–∫–∞ RAG –∫—ç—à–∞ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞: `RAGContextCache.clear_all()`, —Å–∫—Ä–∏–ø—Ç `quality_heal_rag_cache.py` (Backend)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø–∞–π–ø–ª–∞–π–Ω: –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –ø–æ—Ä–æ–≥–æ–≤ run_quality_pipeline –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å heal –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

---

## üéØ –¶–µ–ª–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –°–µ–π—á–∞—Å | 7 –¥–Ω–µ–π | 30 –¥–Ω–µ–π |
|---------|--------|--------|---------|
| Relevance | 80.1% | 85% | 90%+ |
| Faithfulness | 100% | 100% | 100% |
| Coherence | 93.3% | 95% | 97%+ |
| Validation set | 15 | 50+ | 150+ |

---

## –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ê–Ω–∞–ª–∏–∑
python scripts/analyze_low_relevance.py

# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ validation set (–î–µ–Ω—å 3‚Äì4)
python scripts/collect_real_queries.py --days 7 --limit 100
python scripts/generate_query_variations.py --max-per-query 2
python scripts/merge_validation_sources.py   # –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å

# –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–æ–≤)
./scripts/run_quality_pipeline.sh

# –î–µ–Ω—å 5‚Äì6: –¥–∞—à–±–æ—Ä–¥ v2, self-healing –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –ø–æ—Ä–æ–≥–æ–≤
python scripts/create_simple_dashboard.py
python scripts/quality_heal_rag_cache.py   # –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ‚Äî –æ—á–∏—Å—Ç–∫–∞ RAG –∫—ç—à–∞
```

## –£—á—Ç—ë–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

- **QA Engineer (–ê–Ω–Ω–∞):** —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤; –ø–æ—Ä–æ–≥–∏ faithfulness/relevance/coherence –≤ QualityMonitor.
- **Data Engineer:** –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –∫–ª—é—á—É –ø—Ä–∏ —Å–±–æ—Ä–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤; –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø–æ–ª–Ω–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö.
- **Technical Writer (–¢–∞—Ç—å—è–Ω–∞):** —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫ –≤ `generate_query_variations.py` (—Å–∏–Ω–æ–Ω–∏–º—ã, –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∫–∏).
- **SRE / Monitor (–ï–ª–µ–Ω–∞):** –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (validation_report, validation_results); –¥–∞—à–±–æ—Ä–¥ v2 —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º –∏ –∞–ª–µ—Ä—Ç–∞–º–∏; runbook –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –ø–æ—Ä–æ–≥–æ–≤ (–æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ + –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏).
- **Backend (–ò–≥–æ—Ä—å):** –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ RAG –∫—ç—à–∞ (`RAGContextCache.clear_all()`), —Å–∫—Ä–∏–ø—Ç `quality_heal_rag_cache.py` –¥–ª—è Self-healing –ø–∞–π–ø–ª–∞–π–Ω–∞ –∫–∞—á–µ—Å—Ç–≤–∞.

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–ø–æ—Å–ª–µ Phase 4.1)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ (27.01.2026):** –∏–º–ø–æ—Ä—Ç—ã `QualityMonitor`, `RAGContextCache` ‚Äî OK; —Å–∫—Ä–∏–ø—Ç—ã `quality_heal_rag_cache.py`, `create_simple_dashboard.py` ‚Äî –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.

**–î–∞–ª—å—à–µ –ø–æ –ø–ª–∞–Ω—É –§–∞–∑—ã 4** (`docs/PHASE4_PLAN.md`):

| –ù–µ–¥–µ–ª—è | –§–æ–∫—É—Å | –°—Ç–∞—Ç—É—Å |
|--------|--------|--------|
| **2** | –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ConversationContextManager, session_id, –æ–∫–Ω–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —á–∞—Ç (27.01.2026) |
| **3** | –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: RAGEvaluator.check_thresholds, –ø–æ—Ä–æ–≥–∏ QA 0.8/0.85/0.7, CI, record_human_preference (27.01.2026) |
| **4** | –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: MultimodalProcessor (Vision + –¥–æ–∫—É–º–µ–Ω—Ç—ã), API /api/multimodal, MULTIMODAL_SETUP.md (27.01.2026) |

**–§–∞–∑–∞ 4 (–ù–µ–¥–µ–ª–∏ 1‚Äì4) –∑–∞–≤–µ—Ä—à–µ–Ω–∞.** 

**31.01.2026 ‚Äî –ø–æ—Å—Ç-—Ñ–∞–∑–∞ 4:**
- Validation set: 29 ‚Üí 71 –∑–∞–ø—Ä–æ—Å–æ–≤ (merge synthetic + generate_query_variations + –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- QueryRewriter –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ RAG-light (_prepare_query_for_search: rewrite ‚Üí expand)
- –†–µ—Ä–∞–Ω–∫–∏–Ω–≥ –≤ evaluate_rag_quality –ø—Ä–∏ RERANKING_ENABLED=true (run_quality_pipeline –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ö–æ–Ω—Ñ–∏–≥: QUERY_REWRITER_ENABLED (default true), RERANKING_ENABLED (default false –≤ backend, true –≤ pipeline)

–î–∞–ª—å—à–µ ‚Äî —Ü–µ–ª–∏ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º (faithfulness >90%, relevance >95%, HPS ‚â•4.0) –ø—Ä–∏ —Å–≤–æ–±–æ–¥–Ω—ã—Ö Ollama/MLX –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ.

**–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (31.01.2026):**
- QueryRewriter: "–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Victoria" ‚Üí "–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ victoria –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å" ‚úÖ
- RAGEvaluator.check_thresholds: passed=True ‚úÖ
- quality_heal_rag_cache.py, create_simple_dashboard.py, check_quality_thresholds.py ‚Äî OK ‚úÖ
- CI: RERANKING_ENABLED=true, --timeout-per-query 5, query_expansion –≤ paths ‚úÖ

**–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ (31.01.2026):**
- Validation set: 50 ‚Üí 71 ‚Üí **100 –∑–∞–ø—Ä–æ—Å–æ–≤** (merge + 15 base queries; Data Engineer)
- analyze_low_relevance –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ run_quality_pipeline (—à–∞–≥ 5a, QA/CONTINUOUS_IMPROVEMENT)
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ docs/CONTINUOUS_IMPROVEMENT.md
- **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å 10+ —Ñ–æ—Ä–º–∞—Ç–æ–≤:** TXT, HTML, ODT, RTF –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ MultimodalProcessor (Backend)

---

## –ó–∞–∫—Ä—ã—Ç–∏–µ (31.01.2026)

**–§–∞–∑–∞ 4.1 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é.** –í—Å–µ –¥–Ω–∏ 1‚Äì6, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ validation set –¥–æ 100, analyze_low_relevance –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.
