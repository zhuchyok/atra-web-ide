# –£–¥–∞–ª–µ–Ω–∏–µ Ollama –∏–∑ —á–∞—Ç–∞

**–î–∞—Ç–∞:** 26.01.2026  
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** Ollama –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω –∏–∑ –ª–æ–≥–∏–∫–∏ —á–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Victoria + MLX

---

## ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –†–∞–Ω—å—à–µ:
1. Victoria (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
2. MLX API Server (fallback)
3. Ollama (fallback)

### –¢–µ–ø–µ—Ä—å:
1. **Victoria** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚úÖ
2. **MLX API Server** (fallback –µ—Å–ª–∏ Victoria –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞) ‚úÖ
3. Ollama **—É–¥–∞–ª–µ–Ω** ‚ùå

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. `backend/app/routers/chat.py`

**–£–±—Ä–∞–Ω–æ:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä `ollama: OllamaClient` –∏–∑ `sse_generator()`
- –ü–∞—Ä–∞–º–µ—Ç—Ä `ollama: OllamaClient` –∏–∑ `stream_message()`
- –í—Å—è –ª–æ–≥–∏–∫–∞ fallback –Ω–∞ Ollama
- –§—É–Ω–∫—Ü–∏—è `_get_available_model()` –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- –õ–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞: —Ç–æ–ª—å–∫–æ Victoria ‚Üí MLX
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/status`: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å Victoria –∏ MLX (–≤–º–µ—Å—Ç–æ Ollama)
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/models`: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π MLX (–≤–º–µ—Å—Ç–æ Ollama)

---

## üìä –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞

### –ï—Å–ª–∏ `use_victoria=True` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
1. **Victoria Agent** (–ø–æ—Ä—Ç 8010)
   - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

2. **MLX API Server** (fallback, –ø–æ—Ä—Ç 11435)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ Victoria –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
   - –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ï—Å–ª–∏ `use_victoria=False`:
1. **MLX API Server** (–ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ Victoria
   - –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞:**
   - –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - –ü—Ä–æ—â–µ –ª–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞
   - –õ–µ–≥—á–µ –æ—Ç–ª–∞–¥–∫–∞

2. **–§–æ–∫—É—Å –Ω–∞ Victoria:**
   - Victoria - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
   - MLX —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤
   - –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É Ollama –∏ Victoria

3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ú–µ–Ω—å—à–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
   - –ë—ã—Å—Ç—Ä–µ–µ –≤—ã–±–æ—Ä —Å–µ—Ä–≤–∏—Å–∞
   - –ú–µ–Ω—å—à–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üìù –û—Å—Ç–∞–≤—à–∏–µ—Å—è —É–ø–æ–º–∏–Ω–∞–Ω–∏—è Ollama

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∏–º–ø–æ—Ä—Ç—ã –æ—Å—Ç–∞–ª–∏—Å—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
- `_get_available_model()` - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞
- –ò–º–ø–æ—Ä—Ç `OllamaClient` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –¥—Ä—É–≥–∏—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö

–≠—Ç–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∂–µ, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ backend:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è Victoria (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞) –∏–ª–∏ MLX (fallback)
4. Ollama –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

---

*–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã: 26.01.2026*
